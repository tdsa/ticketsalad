{"metadata":{},"options":{"plugins":[{"key":"base$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"base$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$2","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$3","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$4","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"base$0$9","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$10","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin/semantic/src/definitions/modules/dropdown.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"semantic/src/definitions/modules/dropdown.js","filename":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin/semantic/src/definitions/modules/dropdown.js","passPerPreset":false,"envName":"development","cwd":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin","root":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin","presets":[],"generatorOpts":{"filename":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin/semantic/src/definitions/modules/dropdown.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"semantic/src/definitions/modules/dropdown.js"}},"code":"/*!\n * # Semantic UI - Dropdown\n * http://github.com/semantic-org/semantic-ui/\n *\n *\n * Released under the MIT license\n * http://opensource.org/licenses/MIT\n *\n */\n;\n\n(function ($, window, document, undefined) {\n  'use strict';\n\n  window = typeof window != 'undefined' && window.Math == Math ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\n\n  $.fn.dropdown = function (parameters) {\n    var $allModules = $(this),\n        $document = $(document),\n        moduleSelector = $allModules.selector || '',\n        hasTouch = 'ontouchstart' in document.documentElement,\n        time = new Date().getTime(),\n        performance = [],\n        query = arguments[0],\n        methodInvoked = typeof query == 'string',\n        queryArguments = [].slice.call(arguments, 1),\n        returnedValue;\n    $allModules.each(function (elementIndex) {\n      var settings = $.isPlainObject(parameters) ? $.extend(true, {}, $.fn.dropdown.settings, parameters) : $.extend({}, $.fn.dropdown.settings),\n          className = settings.className,\n          message = settings.message,\n          fields = settings.fields,\n          keys = settings.keys,\n          metadata = settings.metadata,\n          namespace = settings.namespace,\n          regExp = settings.regExp,\n          selector = settings.selector,\n          error = settings.error,\n          templates = settings.templates,\n          eventNamespace = '.' + namespace,\n          moduleNamespace = 'module-' + namespace,\n          $module = $(this),\n          $context = $(settings.context),\n          $text = $module.find(selector.text),\n          $search = $module.find(selector.search),\n          $sizer = $module.find(selector.sizer),\n          $input = $module.find(selector.input),\n          $icon = $module.find(selector.icon),\n          $combo = $module.prev().find(selector.text).length > 0 ? $module.prev().find(selector.text) : $module.prev(),\n          $menu = $module.children(selector.menu),\n          $item = $menu.find(selector.item),\n          activated = false,\n          itemActivated = false,\n          internalChange = false,\n          element = this,\n          instance = $module.data(moduleNamespace),\n          initialLoad,\n          pageLostFocus,\n          willRefocus,\n          elementNamespace,\n          id,\n          selectObserver,\n          menuObserver,\n          module;\n      module = {\n        initialize: function () {\n          module.debug('Initializing dropdown', settings);\n\n          if (module.is.alreadySetup()) {\n            module.setup.reference();\n          } else {\n            module.setup.layout();\n\n            if (settings.values) {\n              module.change.values(settings.values);\n            }\n\n            module.refreshData();\n            module.save.defaults();\n            module.restore.selected();\n            module.create.id();\n            module.bind.events();\n            module.observeChanges();\n            module.instantiate();\n          }\n        },\n        instantiate: function () {\n          module.verbose('Storing instance of dropdown', module);\n          instance = module;\n          $module.data(moduleNamespace, module);\n        },\n        destroy: function () {\n          module.verbose('Destroying previous dropdown', $module);\n          module.remove.tabbable();\n          $module.off(eventNamespace).removeData(moduleNamespace);\n          $menu.off(eventNamespace);\n          $document.off(elementNamespace);\n          module.disconnect.menuObserver();\n          module.disconnect.selectObserver();\n        },\n        observeChanges: function () {\n          if ('MutationObserver' in window) {\n            selectObserver = new MutationObserver(module.event.select.mutation);\n            menuObserver = new MutationObserver(module.event.menu.mutation);\n            module.debug('Setting up mutation observer', selectObserver, menuObserver);\n            module.observe.select();\n            module.observe.menu();\n          }\n        },\n        disconnect: {\n          menuObserver: function () {\n            if (menuObserver) {\n              menuObserver.disconnect();\n            }\n          },\n          selectObserver: function () {\n            if (selectObserver) {\n              selectObserver.disconnect();\n            }\n          }\n        },\n        observe: {\n          select: function () {\n            if (module.has.input()) {\n              selectObserver.observe($module[0], {\n                childList: true,\n                subtree: true\n              });\n            }\n          },\n          menu: function () {\n            if (module.has.menu()) {\n              menuObserver.observe($menu[0], {\n                childList: true,\n                subtree: true\n              });\n            }\n          }\n        },\n        create: {\n          id: function () {\n            id = (Math.random().toString(16) + '000000000').substr(2, 8);\n            elementNamespace = '.' + id;\n            module.verbose('Creating unique id for element', id);\n          },\n          userChoice: function (values) {\n            var $userChoices, $userChoice, isUserValue, html;\n            values = values || module.get.userValues();\n\n            if (!values) {\n              return false;\n            }\n\n            values = $.isArray(values) ? values : [values];\n            $.each(values, function (index, value) {\n              if (module.get.item(value) === false) {\n                html = settings.templates.addition(module.add.variables(message.addResult, value));\n                $userChoice = $('<div />').html(html).attr('data-' + metadata.value, value).attr('data-' + metadata.text, value).addClass(className.addition).addClass(className.item);\n\n                if (settings.hideAdditions) {\n                  $userChoice.addClass(className.hidden);\n                }\n\n                $userChoices = $userChoices === undefined ? $userChoice : $userChoices.add($userChoice);\n                module.verbose('Creating user choices for value', value, $userChoice);\n              }\n            });\n            return $userChoices;\n          },\n          userLabels: function (value) {\n            var userValues = module.get.userValues();\n\n            if (userValues) {\n              module.debug('Adding user labels', userValues);\n              $.each(userValues, function (index, value) {\n                module.verbose('Adding custom user value');\n                module.add.label(value, value);\n              });\n            }\n          },\n          menu: function () {\n            $menu = $('<div />').addClass(className.menu).appendTo($module);\n          },\n          sizer: function () {\n            $sizer = $('<span />').addClass(className.sizer).insertAfter($search);\n          }\n        },\n        search: function (query) {\n          query = query !== undefined ? query : module.get.query();\n          module.verbose('Searching for query', query);\n\n          if (module.has.minCharacters(query)) {\n            module.filter(query);\n          } else {\n            module.hide();\n          }\n        },\n        select: {\n          firstUnfiltered: function () {\n            module.verbose('Selecting first non-filtered element');\n            module.remove.selectedItem();\n            $item.not(selector.unselectable).not(selector.addition + selector.hidden).eq(0).addClass(className.selected);\n          },\n          nextAvailable: function ($selected) {\n            $selected = $selected.eq(0);\n            var $nextAvailable = $selected.nextAll(selector.item).not(selector.unselectable).eq(0),\n                $prevAvailable = $selected.prevAll(selector.item).not(selector.unselectable).eq(0),\n                hasNext = $nextAvailable.length > 0;\n\n            if (hasNext) {\n              module.verbose('Moving selection to', $nextAvailable);\n              $nextAvailable.addClass(className.selected);\n            } else {\n              module.verbose('Moving selection to', $prevAvailable);\n              $prevAvailable.addClass(className.selected);\n            }\n          }\n        },\n        setup: {\n          api: function () {\n            var apiSettings = {\n              debug: settings.debug,\n              urlData: {\n                value: module.get.value(),\n                query: module.get.query()\n              },\n              on: false\n            };\n            module.verbose('First request, initializing API');\n            $module.api(apiSettings);\n          },\n          layout: function () {\n            if ($module.is('select')) {\n              module.setup.select();\n              module.setup.returnedObject();\n            }\n\n            if (!module.has.menu()) {\n              module.create.menu();\n            }\n\n            if (module.is.search() && !module.has.search()) {\n              module.verbose('Adding search input');\n              $search = $('<input />').addClass(className.search).prop('autocomplete', 'off').insertBefore($text);\n            }\n\n            if (module.is.multiple() && module.is.searchSelection() && !module.has.sizer()) {\n              module.create.sizer();\n            }\n\n            if (settings.allowTab) {\n              module.set.tabbable();\n            }\n          },\n          select: function () {\n            var selectValues = module.get.selectValues();\n            module.debug('Dropdown initialized on a select', selectValues);\n\n            if ($module.is('select')) {\n              $input = $module;\n            } // see if select is placed correctly already\n\n\n            if ($input.parent(selector.dropdown).length > 0) {\n              module.debug('UI dropdown already exists. Creating dropdown menu only');\n              $module = $input.closest(selector.dropdown);\n\n              if (!module.has.menu()) {\n                module.create.menu();\n              }\n\n              $menu = $module.children(selector.menu);\n              module.setup.menu(selectValues);\n            } else {\n              module.debug('Creating entire dropdown from select');\n              $module = $('<div />').attr('class', $input.attr('class')).addClass(className.selection).addClass(className.dropdown).html(templates.dropdown(selectValues)).insertBefore($input);\n\n              if ($input.hasClass(className.multiple) && $input.prop('multiple') === false) {\n                module.error(error.missingMultiple);\n                $input.prop('multiple', true);\n              }\n\n              if ($input.is('[multiple]')) {\n                module.set.multiple();\n              }\n\n              if ($input.prop('disabled')) {\n                module.debug('Disabling dropdown');\n                $module.addClass(className.disabled);\n              }\n\n              $input.removeAttr('class').detach().prependTo($module);\n            }\n\n            module.refresh();\n          },\n          menu: function (values) {\n            $menu.html(templates.menu(values, fields));\n            $item = $menu.find(selector.item);\n          },\n          reference: function () {\n            module.debug('Dropdown behavior was called on select, replacing with closest dropdown'); // replace module reference\n\n            $module = $module.parent(selector.dropdown);\n            instance = $module.data(moduleNamespace);\n            element = $module.get(0);\n            module.refresh();\n            module.setup.returnedObject();\n          },\n          returnedObject: function () {\n            var $firstModules = $allModules.slice(0, elementIndex),\n                $lastModules = $allModules.slice(elementIndex + 1); // adjust all modules to use correct reference\n\n            $allModules = $firstModules.add($module).add($lastModules);\n          }\n        },\n        refresh: function () {\n          module.refreshSelectors();\n          module.refreshData();\n        },\n        refreshItems: function () {\n          $item = $menu.find(selector.item);\n        },\n        refreshSelectors: function () {\n          module.verbose('Refreshing selector cache');\n          $text = $module.find(selector.text);\n          $search = $module.find(selector.search);\n          $input = $module.find(selector.input);\n          $icon = $module.find(selector.icon);\n          $combo = $module.prev().find(selector.text).length > 0 ? $module.prev().find(selector.text) : $module.prev();\n          $menu = $module.children(selector.menu);\n          $item = $menu.find(selector.item);\n        },\n        refreshData: function () {\n          module.verbose('Refreshing cached metadata');\n          $item.removeData(metadata.text).removeData(metadata.value);\n        },\n        clearData: function () {\n          module.verbose('Clearing metadata');\n          $item.removeData(metadata.text).removeData(metadata.value);\n          $module.removeData(metadata.defaultText).removeData(metadata.defaultValue).removeData(metadata.placeholderText);\n        },\n        toggle: function () {\n          module.verbose('Toggling menu visibility');\n\n          if (!module.is.active()) {\n            module.show();\n          } else {\n            module.hide();\n          }\n        },\n        show: function (callback) {\n          callback = $.isFunction(callback) ? callback : function () {};\n\n          if (!module.can.show() && module.is.remote()) {\n            module.debug('No API results retrieved, searching before show');\n            module.queryRemote(module.get.query(), module.show);\n          }\n\n          if (module.can.show() && !module.is.active()) {\n            module.debug('Showing dropdown');\n\n            if (module.has.message() && !(module.has.maxSelections() || module.has.allResultsFiltered())) {\n              module.remove.message();\n            }\n\n            if (module.is.allFiltered()) {\n              return true;\n            }\n\n            if (settings.onShow.call(element) !== false) {\n              module.animate.show(function () {\n                if (module.can.click()) {\n                  module.bind.intent();\n                }\n\n                if (module.has.menuSearch()) {\n                  module.focusSearch();\n                }\n\n                module.set.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n        hide: function (callback) {\n          callback = $.isFunction(callback) ? callback : function () {};\n\n          if (module.is.active() && !module.is.animatingOutward()) {\n            module.debug('Hiding dropdown');\n\n            if (settings.onHide.call(element) !== false) {\n              module.animate.hide(function () {\n                module.remove.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n        hideOthers: function () {\n          module.verbose('Finding other dropdowns to hide');\n          $allModules.not($module).has(selector.menu + '.' + className.visible).dropdown('hide');\n        },\n        hideMenu: function () {\n          module.verbose('Hiding menu  instantaneously');\n          module.remove.active();\n          module.remove.visible();\n          $menu.transition('hide');\n        },\n        hideSubMenus: function () {\n          var $subMenus = $menu.children(selector.item).find(selector.menu);\n          module.verbose('Hiding sub menus', $subMenus);\n          $subMenus.transition('hide');\n        },\n        bind: {\n          events: function () {\n            if (hasTouch) {\n              module.bind.touchEvents();\n            }\n\n            module.bind.keyboardEvents();\n            module.bind.inputEvents();\n            module.bind.mouseEvents();\n          },\n          touchEvents: function () {\n            module.debug('Touch device detected binding additional touch events');\n\n            if (module.is.searchSelection()) {// do nothing special yet\n            } else if (module.is.single()) {\n              $module.on('touchstart' + eventNamespace, module.event.test.toggle);\n            }\n\n            $menu.on('touchstart' + eventNamespace, selector.item, module.event.item.mouseenter);\n          },\n          keyboardEvents: function () {\n            module.verbose('Binding keyboard events');\n            $module.on('keydown' + eventNamespace, module.event.keydown);\n\n            if (module.has.search()) {\n              $module.on(module.get.inputEvent() + eventNamespace, selector.search, module.event.input);\n            }\n\n            if (module.is.multiple()) {\n              $document.on('keydown' + elementNamespace, module.event.document.keydown);\n            }\n          },\n          inputEvents: function () {\n            module.verbose('Binding input change events');\n            $module.on('change' + eventNamespace, selector.input, module.event.change);\n          },\n          mouseEvents: function () {\n            module.verbose('Binding mouse events');\n\n            if (module.is.multiple()) {\n              $module.on('click' + eventNamespace, selector.label, module.event.label.click).on('click' + eventNamespace, selector.remove, module.event.remove.click);\n            }\n\n            if (module.is.searchSelection()) {\n              $module.on('mousedown' + eventNamespace, module.event.mousedown).on('mouseup' + eventNamespace, module.event.mouseup).on('mousedown' + eventNamespace, selector.menu, module.event.menu.mousedown).on('mouseup' + eventNamespace, selector.menu, module.event.menu.mouseup).on('click' + eventNamespace, selector.icon, module.event.icon.click).on('focus' + eventNamespace, selector.search, module.event.search.focus).on('click' + eventNamespace, selector.search, module.event.search.focus).on('blur' + eventNamespace, selector.search, module.event.search.blur).on('click' + eventNamespace, selector.text, module.event.text.focus);\n\n              if (module.is.multiple()) {\n                $module.on('click' + eventNamespace, module.event.click);\n              }\n            } else {\n              if (settings.on == 'click') {\n                $module.on('click' + eventNamespace, selector.icon, module.event.icon.click).on('click' + eventNamespace, module.event.test.toggle);\n              } else if (settings.on == 'hover') {\n                $module.on('mouseenter' + eventNamespace, module.delay.show).on('mouseleave' + eventNamespace, module.delay.hide);\n              } else {\n                $module.on(settings.on + eventNamespace, module.toggle);\n              }\n\n              $module.on('mousedown' + eventNamespace, module.event.mousedown).on('mouseup' + eventNamespace, module.event.mouseup).on('focus' + eventNamespace, module.event.focus);\n\n              if (module.has.menuSearch()) {\n                $module.on('blur' + eventNamespace, selector.search, module.event.search.blur);\n              } else {\n                $module.on('blur' + eventNamespace, module.event.blur);\n              }\n            }\n\n            $menu.on('mouseenter' + eventNamespace, selector.item, module.event.item.mouseenter).on('mouseleave' + eventNamespace, selector.item, module.event.item.mouseleave).on('click' + eventNamespace, selector.item, module.event.item.click);\n          },\n          intent: function () {\n            module.verbose('Binding hide intent event to document');\n\n            if (hasTouch) {\n              $document.on('touchstart' + elementNamespace, module.event.test.touch).on('touchmove' + elementNamespace, module.event.test.touch);\n            }\n\n            $document.on('click' + elementNamespace, module.event.test.hide);\n          }\n        },\n        unbind: {\n          intent: function () {\n            module.verbose('Removing hide intent event from document');\n\n            if (hasTouch) {\n              $document.off('touchstart' + elementNamespace).off('touchmove' + elementNamespace);\n            }\n\n            $document.off('click' + elementNamespace);\n          }\n        },\n        filter: function (query) {\n          var searchTerm = query !== undefined ? query : module.get.query(),\n              afterFiltered = function () {\n            if (module.is.multiple()) {\n              module.filterActive();\n            }\n\n            if (query || !query && module.get.activeItem().length == 0) {\n              module.select.firstUnfiltered();\n            }\n\n            if (module.has.allResultsFiltered()) {\n              if (settings.onNoResults.call(element, searchTerm)) {\n                if (settings.allowAdditions) {\n                  if (settings.hideAdditions) {\n                    module.verbose('User addition with no menu, setting empty style');\n                    module.set.empty();\n                    module.hideMenu();\n                  }\n                } else {\n                  module.verbose('All items filtered, showing message', searchTerm);\n                  module.add.message(message.noResults);\n                }\n              } else {\n                module.verbose('All items filtered, hiding dropdown', searchTerm);\n                module.hideMenu();\n              }\n            } else {\n              module.remove.empty();\n              module.remove.message();\n            }\n\n            if (settings.allowAdditions) {\n              module.add.userSuggestion(query);\n            }\n\n            if (module.is.searchSelection() && module.can.show() && module.is.focusedOnSearch()) {\n              module.show();\n            }\n          };\n\n          if (settings.useLabels && module.has.maxSelections()) {\n            return;\n          }\n\n          if (settings.apiSettings) {\n            if (module.can.useAPI()) {\n              module.queryRemote(searchTerm, function () {\n                if (settings.filterRemoteData) {\n                  module.filterItems(searchTerm);\n                }\n\n                afterFiltered();\n              });\n            } else {\n              module.error(error.noAPI);\n            }\n          } else {\n            module.filterItems(searchTerm);\n            afterFiltered();\n          }\n        },\n        queryRemote: function (query, callback) {\n          var apiSettings = {\n            errorDuration: false,\n            cache: 'local',\n            throttle: settings.throttle,\n            urlData: {\n              query: query\n            },\n            onError: function () {\n              module.add.message(message.serverError);\n              callback();\n            },\n            onFailure: function () {\n              module.add.message(message.serverError);\n              callback();\n            },\n            onSuccess: function (response) {\n              var values = response[fields.remoteValues],\n                  hasRemoteValues = $.isArray(values) && values.length > 0;\n\n              if (hasRemoteValues) {\n                module.remove.message();\n                module.setup.menu({\n                  values: response[fields.remoteValues]\n                });\n              } else {\n                module.add.message(message.noResults);\n              }\n\n              callback();\n            }\n          };\n\n          if (!$module.api('get request')) {\n            module.setup.api();\n          }\n\n          apiSettings = $.extend(true, {}, apiSettings, settings.apiSettings);\n          $module.api('setting', apiSettings).api('query');\n        },\n        filterItems: function (query) {\n          var searchTerm = query !== undefined ? query : module.get.query(),\n              results = null,\n              escapedTerm = module.escape.string(searchTerm),\n              beginsWithRegExp = new RegExp('^' + escapedTerm, 'igm'); // avoid loop if we're matching nothing\n\n          if (module.has.query()) {\n            results = [];\n            module.verbose('Searching for matching values', searchTerm);\n            $item.each(function () {\n              var $choice = $(this),\n                  text,\n                  value;\n\n              if (settings.match == 'both' || settings.match == 'text') {\n                text = String(module.get.choiceText($choice, false));\n\n                if (text.search(beginsWithRegExp) !== -1) {\n                  results.push(this);\n                  return true;\n                } else if (settings.fullTextSearch === 'exact' && module.exactSearch(searchTerm, text)) {\n                  results.push(this);\n                  return true;\n                } else if (settings.fullTextSearch === true && module.fuzzySearch(searchTerm, text)) {\n                  results.push(this);\n                  return true;\n                }\n              }\n\n              if (settings.match == 'both' || settings.match == 'value') {\n                value = String(module.get.choiceValue($choice, text));\n\n                if (value.search(beginsWithRegExp) !== -1) {\n                  results.push(this);\n                  return true;\n                } else if (settings.fullTextSearch === 'exact' && module.exactSearch(searchTerm, value)) {\n                  results.push(this);\n                  return true;\n                } else if (settings.fullTextSearch === true && module.fuzzySearch(searchTerm, value)) {\n                  results.push(this);\n                  return true;\n                }\n              }\n            });\n          }\n\n          module.debug('Showing only matched items', searchTerm);\n          module.remove.filteredItem();\n\n          if (results) {\n            $item.not(results).addClass(className.filtered);\n          }\n        },\n        fuzzySearch: function (query, term) {\n          var termLength = term.length,\n              queryLength = query.length;\n          query = query.toLowerCase();\n          term = term.toLowerCase();\n\n          if (queryLength > termLength) {\n            return false;\n          }\n\n          if (queryLength === termLength) {\n            return query === term;\n          }\n\n          search: for (var characterIndex = 0, nextCharacterIndex = 0; characterIndex < queryLength; characterIndex++) {\n            var queryCharacter = query.charCodeAt(characterIndex);\n\n            while (nextCharacterIndex < termLength) {\n              if (term.charCodeAt(nextCharacterIndex++) === queryCharacter) {\n                continue search;\n              }\n            }\n\n            return false;\n          }\n\n          return true;\n        },\n        exactSearch: function (query, term) {\n          query = query.toLowerCase();\n          term = term.toLowerCase();\n\n          if (term.indexOf(query) > -1) {\n            return true;\n          }\n\n          return false;\n        },\n        filterActive: function () {\n          if (settings.useLabels) {\n            $item.filter('.' + className.active).addClass(className.filtered);\n          }\n        },\n        focusSearch: function (skipHandler) {\n          if (module.has.search() && !module.is.focusedOnSearch()) {\n            if (skipHandler) {\n              $module.off('focus' + eventNamespace, selector.search);\n              $search.focus();\n              $module.on('focus' + eventNamespace, selector.search, module.event.search.focus);\n            } else {\n              $search.focus();\n            }\n          }\n        },\n        forceSelection: function () {\n          var $currentlySelected = $item.not(className.filtered).filter('.' + className.selected).eq(0),\n              $activeItem = $item.not(className.filtered).filter('.' + className.active).eq(0),\n              $selectedItem = $currentlySelected.length > 0 ? $currentlySelected : $activeItem,\n              hasSelected = $selectedItem.length > 0;\n\n          if (hasSelected && !module.is.multiple()) {\n            module.debug('Forcing partial selection to selected item', $selectedItem);\n            module.event.item.click.call($selectedItem, {}, true);\n            return;\n          } else {\n            if (settings.allowAdditions) {\n              module.set.selected(module.get.query());\n              module.remove.searchTerm();\n            } else {\n              module.remove.searchTerm();\n            }\n          }\n        },\n        change: {\n          values: function (values) {\n            if (!settings.allowAdditions) {\n              module.clear();\n            }\n\n            module.debug('Creating dropdown with specified values', values);\n            module.setup.menu({\n              values: values\n            });\n            $.each(values, function (index, item) {\n              if (item.selected == true) {\n                module.debug('Setting initial selection to', item.value);\n                module.set.selected(item.value);\n                return true;\n              }\n            });\n          }\n        },\n        event: {\n          change: function () {\n            if (!internalChange) {\n              module.debug('Input changed, updating selection');\n              module.set.selected();\n            }\n          },\n          focus: function () {\n            if (settings.showOnFocus && !activated && module.is.hidden() && !pageLostFocus) {\n              module.show();\n            }\n          },\n          blur: function (event) {\n            pageLostFocus = document.activeElement === this;\n\n            if (!activated && !pageLostFocus) {\n              module.remove.activeLabel();\n              module.hide();\n            }\n          },\n          mousedown: function () {\n            if (module.is.searchSelection()) {\n              // prevent menu hiding on immediate re-focus\n              willRefocus = true;\n            } else {\n              // prevents focus callback from occurring on mousedown\n              activated = true;\n            }\n          },\n          mouseup: function () {\n            if (module.is.searchSelection()) {\n              // prevent menu hiding on immediate re-focus\n              willRefocus = false;\n            } else {\n              activated = false;\n            }\n          },\n          click: function (event) {\n            var $target = $(event.target); // focus search\n\n            if ($target.is($module)) {\n              if (!module.is.focusedOnSearch()) {\n                module.focusSearch();\n              } else {\n                module.show();\n              }\n            }\n          },\n          search: {\n            focus: function () {\n              activated = true;\n\n              if (module.is.multiple()) {\n                module.remove.activeLabel();\n              }\n\n              if (settings.showOnFocus) {\n                module.search();\n              }\n            },\n            blur: function (event) {\n              pageLostFocus = document.activeElement === this;\n\n              if (module.is.searchSelection() && !willRefocus) {\n                if (!itemActivated && !pageLostFocus) {\n                  if (settings.forceSelection) {\n                    module.forceSelection();\n                  }\n\n                  module.hide();\n                }\n              }\n\n              willRefocus = false;\n            }\n          },\n          icon: {\n            click: function (event) {\n              module.toggle();\n            }\n          },\n          text: {\n            focus: function (event) {\n              activated = true;\n              module.focusSearch();\n            }\n          },\n          input: function (event) {\n            if (module.is.multiple() || module.is.searchSelection()) {\n              module.set.filtered();\n            }\n\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.search, settings.delay.search);\n          },\n          label: {\n            click: function (event) {\n              var $label = $(this),\n                  $labels = $module.find(selector.label),\n                  $activeLabels = $labels.filter('.' + className.active),\n                  $nextActive = $label.nextAll('.' + className.active),\n                  $prevActive = $label.prevAll('.' + className.active),\n                  $range = $nextActive.length > 0 ? $label.nextUntil($nextActive).add($activeLabels).add($label) : $label.prevUntil($prevActive).add($activeLabels).add($label);\n\n              if (event.shiftKey) {\n                $activeLabels.removeClass(className.active);\n                $range.addClass(className.active);\n              } else if (event.ctrlKey) {\n                $label.toggleClass(className.active);\n              } else {\n                $activeLabels.removeClass(className.active);\n                $label.addClass(className.active);\n              }\n\n              settings.onLabelSelect.apply(this, $labels.filter('.' + className.active));\n            }\n          },\n          remove: {\n            click: function () {\n              var $label = $(this).parent();\n\n              if ($label.hasClass(className.active)) {\n                // remove all selected labels\n                module.remove.activeLabels();\n              } else {\n                // remove this label only\n                module.remove.activeLabels($label);\n              }\n            }\n          },\n          test: {\n            toggle: function (event) {\n              var toggleBehavior = module.is.multiple() ? module.show : module.toggle;\n\n              if (module.is.bubbledLabelClick(event) || module.is.bubbledIconClick(event)) {\n                return;\n              }\n\n              if (module.determine.eventOnElement(event, toggleBehavior)) {\n                event.preventDefault();\n              }\n            },\n            touch: function (event) {\n              module.determine.eventOnElement(event, function () {\n                if (event.type == 'touchstart') {\n                  module.timer = setTimeout(function () {\n                    module.hide();\n                  }, settings.delay.touch);\n                } else if (event.type == 'touchmove') {\n                  clearTimeout(module.timer);\n                }\n              });\n              event.stopPropagation();\n            },\n            hide: function (event) {\n              module.determine.eventInModule(event, module.hide);\n            }\n          },\n          select: {\n            mutation: function (mutations) {\n              module.debug('<select> modified, recreating menu');\n              var isSelectMutation = false;\n              $.each(mutations, function (index, mutation) {\n                if ($(mutation.target).is('select') || $(mutation.addedNodes).is('select')) {\n                  isSelectMutation = true;\n                  return true;\n                }\n              });\n\n              if (isSelectMutation) {\n                module.disconnect.selectObserver();\n                module.refresh();\n                module.setup.select();\n                module.set.selected();\n                module.observe.select();\n              }\n            }\n          },\n          menu: {\n            mutation: function (mutations) {\n              var mutation = mutations[0],\n                  $addedNode = mutation.addedNodes ? $(mutation.addedNodes[0]) : $(false),\n                  $removedNode = mutation.removedNodes ? $(mutation.removedNodes[0]) : $(false),\n                  $changedNodes = $addedNode.add($removedNode),\n                  isUserAddition = $changedNodes.is(selector.addition) || $changedNodes.closest(selector.addition).length > 0,\n                  isMessage = $changedNodes.is(selector.message) || $changedNodes.closest(selector.message).length > 0;\n\n              if (isUserAddition || isMessage) {\n                module.debug('Updating item selector cache');\n                module.refreshItems();\n              } else {\n                module.debug('Menu modified, updating selector cache');\n                module.refresh();\n              }\n            },\n            mousedown: function () {\n              itemActivated = true;\n            },\n            mouseup: function () {\n              itemActivated = false;\n            }\n          },\n          item: {\n            mouseenter: function (event) {\n              var $target = $(event.target),\n                  $item = $(this),\n                  $subMenu = $item.children(selector.menu),\n                  $otherMenus = $item.siblings(selector.item).children(selector.menu),\n                  hasSubMenu = $subMenu.length > 0,\n                  isBubbledEvent = $subMenu.find($target).length > 0;\n\n              if (!isBubbledEvent && hasSubMenu) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function () {\n                  module.verbose('Showing sub-menu', $subMenu);\n                  $.each($otherMenus, function () {\n                    module.animate.hide(false, $(this));\n                  });\n                  module.animate.show(false, $subMenu);\n                }, settings.delay.show);\n                event.preventDefault();\n              }\n            },\n            mouseleave: function (event) {\n              var $subMenu = $(this).children(selector.menu);\n\n              if ($subMenu.length > 0) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function () {\n                  module.verbose('Hiding sub-menu', $subMenu);\n                  module.animate.hide(false, $subMenu);\n                }, settings.delay.hide);\n              }\n            },\n            click: function (event, skipRefocus) {\n              var $choice = $(this),\n                  $target = event ? $(event.target) : $(''),\n                  $subMenu = $choice.find(selector.menu),\n                  text = module.get.choiceText($choice),\n                  value = module.get.choiceValue($choice, text),\n                  hasSubMenu = $subMenu.length > 0,\n                  isBubbledEvent = $subMenu.find($target).length > 0; // prevents IE11 bug where menu receives focus even though `tabindex=-1`\n\n              if (module.has.menuSearch()) {\n                $(document.activeElement).blur();\n              }\n\n              if (!isBubbledEvent && (!hasSubMenu || settings.allowCategorySelection)) {\n                if (module.is.searchSelection()) {\n                  if (settings.allowAdditions) {\n                    module.remove.userAddition();\n                  }\n\n                  module.remove.searchTerm();\n\n                  if (!module.is.focusedOnSearch() && !(skipRefocus == true)) {\n                    module.focusSearch(true);\n                  }\n                }\n\n                if (!settings.useLabels) {\n                  module.remove.filteredItem();\n                  module.set.scrollPosition($choice);\n                }\n\n                module.determine.selectAction.call(this, text, value);\n              }\n            }\n          },\n          document: {\n            // label selection should occur even when element has no focus\n            keydown: function (event) {\n              var pressedKey = event.which,\n                  isShortcutKey = module.is.inObject(pressedKey, keys);\n\n              if (isShortcutKey) {\n                var $label = $module.find(selector.label),\n                    $activeLabel = $label.filter('.' + className.active),\n                    activeValue = $activeLabel.data(metadata.value),\n                    labelIndex = $label.index($activeLabel),\n                    labelCount = $label.length,\n                    hasActiveLabel = $activeLabel.length > 0,\n                    hasMultipleActive = $activeLabel.length > 1,\n                    isFirstLabel = labelIndex === 0,\n                    isLastLabel = labelIndex + 1 == labelCount,\n                    isSearch = module.is.searchSelection(),\n                    isFocusedOnSearch = module.is.focusedOnSearch(),\n                    isFocused = module.is.focused(),\n                    caretAtStart = isFocusedOnSearch && module.get.caretPosition() === 0,\n                    $nextLabel;\n\n                if (isSearch && !hasActiveLabel && !isFocusedOnSearch) {\n                  return;\n                }\n\n                if (pressedKey == keys.leftArrow) {\n                  // activate previous label\n                  if ((isFocused || caretAtStart) && !hasActiveLabel) {\n                    module.verbose('Selecting previous label');\n                    $label.last().addClass(className.active);\n                  } else if (hasActiveLabel) {\n                    if (!event.shiftKey) {\n                      module.verbose('Selecting previous label');\n                      $label.removeClass(className.active);\n                    } else {\n                      module.verbose('Adding previous label to selection');\n                    }\n\n                    if (isFirstLabel && !hasMultipleActive) {\n                      $activeLabel.addClass(className.active);\n                    } else {\n                      $activeLabel.prev(selector.siblingLabel).addClass(className.active).end();\n                    }\n\n                    event.preventDefault();\n                  }\n                } else if (pressedKey == keys.rightArrow) {\n                  // activate first label\n                  if (isFocused && !hasActiveLabel) {\n                    $label.first().addClass(className.active);\n                  } // activate next label\n\n\n                  if (hasActiveLabel) {\n                    if (!event.shiftKey) {\n                      module.verbose('Selecting next label');\n                      $label.removeClass(className.active);\n                    } else {\n                      module.verbose('Adding next label to selection');\n                    }\n\n                    if (isLastLabel) {\n                      if (isSearch) {\n                        if (!isFocusedOnSearch) {\n                          module.focusSearch();\n                        } else {\n                          $label.removeClass(className.active);\n                        }\n                      } else if (hasMultipleActive) {\n                        $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                      } else {\n                        $activeLabel.addClass(className.active);\n                      }\n                    } else {\n                      $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                    }\n\n                    event.preventDefault();\n                  }\n                } else if (pressedKey == keys.deleteKey || pressedKey == keys.backspace) {\n                  if (hasActiveLabel) {\n                    module.verbose('Removing active labels');\n\n                    if (isLastLabel) {\n                      if (isSearch && !isFocusedOnSearch) {\n                        module.focusSearch();\n                      }\n                    }\n\n                    $activeLabel.last().next(selector.siblingLabel).addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                    event.preventDefault();\n                  } else if (caretAtStart && !hasActiveLabel && pressedKey == keys.backspace) {\n                    module.verbose('Removing last label on input backspace');\n                    $activeLabel = $label.last().addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                  }\n                } else {\n                  $activeLabel.removeClass(className.active);\n                }\n              }\n            }\n          },\n          keydown: function (event) {\n            var pressedKey = event.which,\n                isShortcutKey = module.is.inObject(pressedKey, keys);\n\n            if (isShortcutKey) {\n              var $currentlySelected = $item.not(selector.unselectable).filter('.' + className.selected).eq(0),\n                  $activeItem = $menu.children('.' + className.active).eq(0),\n                  $selectedItem = $currentlySelected.length > 0 ? $currentlySelected : $activeItem,\n                  $visibleItems = $selectedItem.length > 0 ? $selectedItem.siblings(':not(.' + className.filtered + ')').addBack() : $menu.children(':not(.' + className.filtered + ')'),\n                  $subMenu = $selectedItem.children(selector.menu),\n                  $parentMenu = $selectedItem.closest(selector.menu),\n                  inVisibleMenu = $parentMenu.hasClass(className.visible) || $parentMenu.hasClass(className.animating) || $parentMenu.parent(selector.menu).length > 0,\n                  hasSubMenu = $subMenu.length > 0,\n                  hasSelectedItem = $selectedItem.length > 0,\n                  selectedIsSelectable = $selectedItem.not(selector.unselectable).length > 0,\n                  delimiterPressed = pressedKey == keys.delimiter && settings.allowAdditions && module.is.multiple(),\n                  isAdditionWithoutMenu = settings.allowAdditions && settings.hideAdditions && (pressedKey == keys.enter || delimiterPressed) && selectedIsSelectable,\n                  $nextItem,\n                  isSubMenuItem,\n                  newIndex; // allow selection with menu closed\n\n              if (isAdditionWithoutMenu) {\n                module.verbose('Selecting item from keyboard shortcut', $selectedItem);\n                module.event.item.click.call($selectedItem, event);\n\n                if (module.is.searchSelection()) {\n                  module.remove.searchTerm();\n                }\n              } // visible menu keyboard shortcuts\n\n\n              if (module.is.visible()) {\n                // enter (select or open sub-menu)\n                if (pressedKey == keys.enter || delimiterPressed) {\n                  if (pressedKey == keys.enter && hasSelectedItem && hasSubMenu && !settings.allowCategorySelection) {\n                    module.verbose('Pressed enter on unselectable category, opening sub menu');\n                    pressedKey = keys.rightArrow;\n                  } else if (selectedIsSelectable) {\n                    module.verbose('Selecting item from keyboard shortcut', $selectedItem);\n                    module.event.item.click.call($selectedItem, event);\n\n                    if (module.is.searchSelection()) {\n                      module.remove.searchTerm();\n                    }\n                  }\n\n                  event.preventDefault();\n                } // sub-menu actions\n\n\n                if (hasSelectedItem) {\n                  if (pressedKey == keys.leftArrow) {\n                    isSubMenuItem = $parentMenu[0] !== $menu[0];\n\n                    if (isSubMenuItem) {\n                      module.verbose('Left key pressed, closing sub-menu');\n                      module.animate.hide(false, $parentMenu);\n                      $selectedItem.removeClass(className.selected);\n                      $parentMenu.closest(selector.item).addClass(className.selected);\n                      event.preventDefault();\n                    }\n                  } // right arrow (show sub-menu)\n\n\n                  if (pressedKey == keys.rightArrow) {\n                    if (hasSubMenu) {\n                      module.verbose('Right key pressed, opening sub-menu');\n                      module.animate.show(false, $subMenu);\n                      $selectedItem.removeClass(className.selected);\n                      $subMenu.find(selector.item).eq(0).addClass(className.selected);\n                      event.preventDefault();\n                    }\n                  }\n                } // up arrow (traverse menu up)\n\n\n                if (pressedKey == keys.upArrow) {\n                  $nextItem = hasSelectedItem && inVisibleMenu ? $selectedItem.prevAll(selector.item + ':not(' + selector.unselectable + ')').eq(0) : $item.eq(0);\n\n                  if ($visibleItems.index($nextItem) < 0) {\n                    module.verbose('Up key pressed but reached top of current menu');\n                    event.preventDefault();\n                    return;\n                  } else {\n                    module.verbose('Up key pressed, changing active item');\n                    $selectedItem.removeClass(className.selected);\n                    $nextItem.addClass(className.selected);\n                    module.set.scrollPosition($nextItem);\n\n                    if (settings.selectOnKeydown && module.is.single()) {\n                      module.set.selectedItem($nextItem);\n                    }\n                  }\n\n                  event.preventDefault();\n                } // down arrow (traverse menu down)\n\n\n                if (pressedKey == keys.downArrow) {\n                  $nextItem = hasSelectedItem && inVisibleMenu ? $nextItem = $selectedItem.nextAll(selector.item + ':not(' + selector.unselectable + ')').eq(0) : $item.eq(0);\n\n                  if ($nextItem.length === 0) {\n                    module.verbose('Down key pressed but reached bottom of current menu');\n                    event.preventDefault();\n                    return;\n                  } else {\n                    module.verbose('Down key pressed, changing active item');\n                    $item.removeClass(className.selected);\n                    $nextItem.addClass(className.selected);\n                    module.set.scrollPosition($nextItem);\n\n                    if (settings.selectOnKeydown && module.is.single()) {\n                      module.set.selectedItem($nextItem);\n                    }\n                  }\n\n                  event.preventDefault();\n                } // page down (show next page)\n\n\n                if (pressedKey == keys.pageUp) {\n                  module.scrollPage('up');\n                  event.preventDefault();\n                }\n\n                if (pressedKey == keys.pageDown) {\n                  module.scrollPage('down');\n                  event.preventDefault();\n                } // escape (close menu)\n\n\n                if (pressedKey == keys.escape) {\n                  module.verbose('Escape key pressed, closing dropdown');\n                  module.hide();\n                }\n              } else {\n                // delimiter key\n                if (delimiterPressed) {\n                  event.preventDefault();\n                } // down arrow (open menu)\n\n\n                if (pressedKey == keys.downArrow && !module.is.visible()) {\n                  module.verbose('Down key pressed, showing dropdown');\n                  module.show();\n                  event.preventDefault();\n                }\n              }\n            } else {\n              if (!module.has.search()) {\n                module.set.selectedLetter(String.fromCharCode(pressedKey));\n              }\n            }\n          }\n        },\n        trigger: {\n          change: function () {\n            var events = document.createEvent('HTMLEvents'),\n                inputElement = $input[0];\n\n            if (inputElement) {\n              module.verbose('Triggering native change event');\n              events.initEvent('change', true, false);\n              inputElement.dispatchEvent(events);\n            }\n          }\n        },\n        determine: {\n          selectAction: function (text, value) {\n            module.verbose('Determining action', settings.action);\n\n            if ($.isFunction(module.action[settings.action])) {\n              module.verbose('Triggering preset action', settings.action, text, value);\n              module.action[settings.action].call(element, text, value, this);\n            } else if ($.isFunction(settings.action)) {\n              module.verbose('Triggering user action', settings.action, text, value);\n              settings.action.call(element, text, value, this);\n            } else {\n              module.error(error.action, settings.action);\n            }\n          },\n          eventInModule: function (event, callback) {\n            var $target = $(event.target),\n                inDocument = $target.closest(document.documentElement).length > 0,\n                inModule = $target.closest($module).length > 0;\n            callback = $.isFunction(callback) ? callback : function () {};\n\n            if (inDocument && !inModule) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            } else {\n              module.verbose('Event occurred in dropdown, canceling callback');\n              return false;\n            }\n          },\n          eventOnElement: function (event, callback) {\n            var $target = $(event.target),\n                $label = $target.closest(selector.siblingLabel),\n                inVisibleDOM = document.body.contains(event.target),\n                notOnLabel = $module.find($label).length === 0,\n                notInMenu = $target.closest($menu).length === 0;\n            callback = $.isFunction(callback) ? callback : function () {};\n\n            if (inVisibleDOM && notOnLabel && notInMenu) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            } else {\n              module.verbose('Event occurred in dropdown menu, canceling callback');\n              return false;\n            }\n          }\n        },\n        action: {\n          nothing: function () {},\n          activate: function (text, value, element) {\n            value = value !== undefined ? value : text;\n\n            if (module.can.activate($(element))) {\n              module.set.selected(value, $(element));\n\n              if (module.is.multiple() && !module.is.allFiltered()) {\n                return;\n              } else {\n                module.hideAndClear();\n              }\n            }\n          },\n          select: function (text, value, element) {\n            value = value !== undefined ? value : text;\n\n            if (module.can.activate($(element))) {\n              module.set.value(value, text, $(element));\n\n              if (module.is.multiple() && !module.is.allFiltered()) {\n                return;\n              } else {\n                module.hideAndClear();\n              }\n            }\n          },\n          combo: function (text, value, element) {\n            value = value !== undefined ? value : text;\n            module.set.selected(value, $(element));\n            module.hideAndClear();\n          },\n          hide: function (text, value, element) {\n            module.set.value(value, text);\n            module.hideAndClear();\n          }\n        },\n        get: {\n          id: function () {\n            return id;\n          },\n          defaultText: function () {\n            return $module.data(metadata.defaultText);\n          },\n          defaultValue: function () {\n            return $module.data(metadata.defaultValue);\n          },\n          placeholderText: function () {\n            if (settings.placeholder != 'auto' && typeof settings.placeholder == 'string') {\n              return settings.placeholder;\n            }\n\n            return $module.data(metadata.placeholderText) || '';\n          },\n          text: function () {\n            return $text.text();\n          },\n          query: function () {\n            return $.trim($search.val());\n          },\n          searchWidth: function (value) {\n            value = value !== undefined ? value : $search.val();\n            $sizer.text(value); // prevent rounding issues\n\n            return Math.ceil($sizer.width() + 1);\n          },\n          selectionCount: function () {\n            var values = module.get.values(),\n                count;\n            count = module.is.multiple() ? $.isArray(values) ? values.length : 0 : module.get.value() !== '' ? 1 : 0;\n            return count;\n          },\n          transition: function ($subMenu) {\n            return settings.transition == 'auto' ? module.is.upward($subMenu) ? 'slide up' : 'slide down' : settings.transition;\n          },\n          userValues: function () {\n            var values = module.get.values();\n\n            if (!values) {\n              return false;\n            }\n\n            values = $.isArray(values) ? values : [values];\n            return $.grep(values, function (value) {\n              return module.get.item(value) === false;\n            });\n          },\n          uniqueArray: function (array) {\n            return $.grep(array, function (value, index) {\n              return $.inArray(value, array) === index;\n            });\n          },\n          caretPosition: function () {\n            var input = $search.get(0),\n                range,\n                rangeLength;\n\n            if ('selectionStart' in input) {\n              return input.selectionStart;\n            } else if (document.selection) {\n              input.focus();\n              range = document.selection.createRange();\n              rangeLength = range.text.length;\n              range.moveStart('character', -input.value.length);\n              return range.text.length - rangeLength;\n            }\n          },\n          value: function () {\n            var value = $input.length > 0 ? $input.val() : $module.data(metadata.value),\n                isEmptyMultiselect = $.isArray(value) && value.length === 1 && value[0] === ''; // prevents placeholder element from being selected when multiple\n\n            return value === undefined || isEmptyMultiselect ? '' : value;\n          },\n          values: function () {\n            var value = module.get.value();\n\n            if (value === '') {\n              return '';\n            }\n\n            return !module.has.selectInput() && module.is.multiple() ? typeof value == 'string' ? // delimited string\n            value.split(settings.delimiter) : '' : value;\n          },\n          remoteValues: function () {\n            var values = module.get.values(),\n                remoteValues = false;\n\n            if (values) {\n              if (typeof values == 'string') {\n                values = [values];\n              }\n\n              $.each(values, function (index, value) {\n                var name = module.read.remoteData(value);\n                module.verbose('Restoring value from session data', name, value);\n\n                if (name) {\n                  if (!remoteValues) {\n                    remoteValues = {};\n                  }\n\n                  remoteValues[value] = name;\n                }\n              });\n            }\n\n            return remoteValues;\n          },\n          choiceText: function ($choice, preserveHTML) {\n            preserveHTML = preserveHTML !== undefined ? preserveHTML : settings.preserveHTML;\n\n            if ($choice) {\n              if ($choice.find(selector.menu).length > 0) {\n                module.verbose('Retrieving text of element with sub-menu');\n                $choice = $choice.clone();\n                $choice.find(selector.menu).remove();\n                $choice.find(selector.menuIcon).remove();\n              }\n\n              return $choice.data(metadata.text) !== undefined ? $choice.data(metadata.text) : preserveHTML ? $.trim($choice.html()) : $.trim($choice.text());\n            }\n          },\n          choiceValue: function ($choice, choiceText) {\n            choiceText = choiceText || module.get.choiceText($choice);\n\n            if (!$choice) {\n              return false;\n            }\n\n            return $choice.data(metadata.value) !== undefined ? String($choice.data(metadata.value)) : typeof choiceText === 'string' ? $.trim(choiceText.toLowerCase()) : String(choiceText);\n          },\n          inputEvent: function () {\n            var input = $search[0];\n\n            if (input) {\n              return input.oninput !== undefined ? 'input' : input.onpropertychange !== undefined ? 'propertychange' : 'keyup';\n            }\n\n            return false;\n          },\n          selectValues: function () {\n            var select = {};\n            select.values = [];\n            $module.find('option').each(function () {\n              var $option = $(this),\n                  name = $option.html(),\n                  disabled = $option.attr('disabled'),\n                  value = $option.attr('value') !== undefined ? $option.attr('value') : name;\n\n              if (settings.placeholder === 'auto' && value === '') {\n                select.placeholder = name;\n              } else {\n                select.values.push({\n                  name: name,\n                  value: value,\n                  disabled: disabled\n                });\n              }\n            });\n\n            if (settings.placeholder && settings.placeholder !== 'auto') {\n              module.debug('Setting placeholder value to', settings.placeholder);\n              select.placeholder = settings.placeholder;\n            }\n\n            if (settings.sortSelect) {\n              select.values.sort(function (a, b) {\n                return a.name > b.name ? 1 : -1;\n              });\n              module.debug('Retrieved and sorted values from select', select);\n            } else {\n              module.debug('Retrieved values from select', select);\n            }\n\n            return select;\n          },\n          activeItem: function () {\n            return $item.filter('.' + className.active);\n          },\n          selectedItem: function () {\n            var $selectedItem = $item.not(selector.unselectable).filter('.' + className.selected);\n            return $selectedItem.length > 0 ? $selectedItem : $item.eq(0);\n          },\n          itemWithAdditions: function (value) {\n            var $items = module.get.item(value),\n                $userItems = module.create.userChoice(value),\n                hasUserItems = $userItems && $userItems.length > 0;\n\n            if (hasUserItems) {\n              $items = $items.length > 0 ? $items.add($userItems) : $userItems;\n            }\n\n            return $items;\n          },\n          item: function (value, strict) {\n            var $selectedItem = false,\n                shouldSearch,\n                isMultiple;\n            value = value !== undefined ? value : module.get.values() !== undefined ? module.get.values() : module.get.text();\n            shouldSearch = isMultiple ? value.length > 0 : value !== undefined && value !== null;\n            isMultiple = module.is.multiple() && $.isArray(value);\n            strict = value === '' || value === 0 ? true : strict || false;\n\n            if (shouldSearch) {\n              $item.each(function () {\n                var $choice = $(this),\n                    optionText = module.get.choiceText($choice),\n                    optionValue = module.get.choiceValue($choice, optionText); // safe early exit\n\n                if (optionValue === null || optionValue === undefined) {\n                  return;\n                }\n\n                if (isMultiple) {\n                  if ($.inArray(String(optionValue), value) !== -1 || $.inArray(optionText, value) !== -1) {\n                    $selectedItem = $selectedItem ? $selectedItem.add($choice) : $choice;\n                  }\n                } else if (strict) {\n                  module.verbose('Ambiguous dropdown value using strict type check', $choice, value);\n\n                  if (optionValue === value || optionText === value) {\n                    $selectedItem = $choice;\n                    return true;\n                  }\n                } else {\n                  if (String(optionValue) == String(value) || optionText == value) {\n                    module.verbose('Found select item by value', optionValue, value);\n                    $selectedItem = $choice;\n                    return true;\n                  }\n                }\n              });\n            }\n\n            return $selectedItem;\n          }\n        },\n        check: {\n          maxSelections: function (selectionCount) {\n            if (settings.maxSelections) {\n              selectionCount = selectionCount !== undefined ? selectionCount : module.get.selectionCount();\n\n              if (selectionCount >= settings.maxSelections) {\n                module.debug('Maximum selection count reached');\n\n                if (settings.useLabels) {\n                  $item.addClass(className.filtered);\n                  module.add.message(message.maxSelections);\n                }\n\n                return true;\n              } else {\n                module.verbose('No longer at maximum selection count');\n                module.remove.message();\n                module.remove.filteredItem();\n\n                if (module.is.searchSelection()) {\n                  module.filterItems();\n                }\n\n                return false;\n              }\n            }\n\n            return true;\n          }\n        },\n        restore: {\n          defaults: function () {\n            module.clear();\n            module.restore.defaultText();\n            module.restore.defaultValue();\n          },\n          defaultText: function () {\n            var defaultText = module.get.defaultText(),\n                placeholderText = module.get.placeholderText;\n\n            if (defaultText === placeholderText) {\n              module.debug('Restoring default placeholder text', defaultText);\n              module.set.placeholderText(defaultText);\n            } else {\n              module.debug('Restoring default text', defaultText);\n              module.set.text(defaultText);\n            }\n          },\n          placeholderText: function () {\n            module.set.placeholderText();\n          },\n          defaultValue: function () {\n            var defaultValue = module.get.defaultValue();\n\n            if (defaultValue !== undefined) {\n              module.debug('Restoring default value', defaultValue);\n\n              if (defaultValue !== '') {\n                module.set.value(defaultValue);\n                module.set.selected();\n              } else {\n                module.remove.activeItem();\n                module.remove.selectedItem();\n              }\n            }\n          },\n          labels: function () {\n            if (settings.allowAdditions) {\n              if (!settings.useLabels) {\n                module.error(error.labels);\n                settings.useLabels = true;\n              }\n\n              module.debug('Restoring selected values');\n              module.create.userLabels();\n            }\n\n            module.check.maxSelections();\n          },\n          selected: function () {\n            module.restore.values();\n\n            if (module.is.multiple()) {\n              module.debug('Restoring previously selected values and labels');\n              module.restore.labels();\n            } else {\n              module.debug('Restoring previously selected values');\n            }\n          },\n          values: function () {\n            // prevents callbacks from occurring on initial load\n            module.set.initialLoad();\n\n            if (settings.apiSettings && settings.saveRemoteData && module.get.remoteValues()) {\n              module.restore.remoteValues();\n            } else {\n              module.set.selected();\n            }\n\n            module.remove.initialLoad();\n          },\n          remoteValues: function () {\n            var values = module.get.remoteValues();\n            module.debug('Recreating selected from session data', values);\n\n            if (values) {\n              if (module.is.single()) {\n                $.each(values, function (value, name) {\n                  module.set.text(name);\n                });\n              } else {\n                $.each(values, function (value, name) {\n                  module.add.label(value, name);\n                });\n              }\n            }\n          }\n        },\n        read: {\n          remoteData: function (value) {\n            var name;\n\n            if (window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n\n            name = sessionStorage.getItem(value);\n            return name !== undefined ? name : false;\n          }\n        },\n        save: {\n          defaults: function () {\n            module.save.defaultText();\n            module.save.placeholderText();\n            module.save.defaultValue();\n          },\n          defaultValue: function () {\n            var value = module.get.value();\n            module.verbose('Saving default value as', value);\n            $module.data(metadata.defaultValue, value);\n          },\n          defaultText: function () {\n            var text = module.get.text();\n            module.verbose('Saving default text as', text);\n            $module.data(metadata.defaultText, text);\n          },\n          placeholderText: function () {\n            var text;\n\n            if (settings.placeholder !== false && $text.hasClass(className.placeholder)) {\n              text = module.get.text();\n              module.verbose('Saving placeholder text as', text);\n              $module.data(metadata.placeholderText, text);\n            }\n          },\n          remoteData: function (name, value) {\n            if (window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n\n            module.verbose('Saving remote data to session storage', value, name);\n            sessionStorage.setItem(value, name);\n          }\n        },\n        clear: function () {\n          if (module.is.multiple() && settings.useLabels) {\n            module.remove.labels();\n          } else {\n            module.remove.activeItem();\n            module.remove.selectedItem();\n          }\n\n          module.set.placeholderText();\n          module.clearValue();\n        },\n        clearValue: function () {\n          module.set.value('');\n        },\n        scrollPage: function (direction, $selectedItem) {\n          var $currentItem = $selectedItem || module.get.selectedItem(),\n              $menu = $currentItem.closest(selector.menu),\n              menuHeight = $menu.outerHeight(),\n              currentScroll = $menu.scrollTop(),\n              itemHeight = $item.eq(0).outerHeight(),\n              itemsPerPage = Math.floor(menuHeight / itemHeight),\n              maxScroll = $menu.prop('scrollHeight'),\n              newScroll = direction == 'up' ? currentScroll - itemHeight * itemsPerPage : currentScroll + itemHeight * itemsPerPage,\n              $selectableItem = $item.not(selector.unselectable),\n              isWithinRange,\n              $nextSelectedItem,\n              elementIndex;\n          elementIndex = direction == 'up' ? $selectableItem.index($currentItem) - itemsPerPage : $selectableItem.index($currentItem) + itemsPerPage;\n          isWithinRange = direction == 'up' ? elementIndex >= 0 : elementIndex < $selectableItem.length;\n          $nextSelectedItem = isWithinRange ? $selectableItem.eq(elementIndex) : direction == 'up' ? $selectableItem.first() : $selectableItem.last();\n\n          if ($nextSelectedItem.length > 0) {\n            module.debug('Scrolling page', direction, $nextSelectedItem);\n            $currentItem.removeClass(className.selected);\n            $nextSelectedItem.addClass(className.selected);\n\n            if (settings.selectOnKeydown && module.is.single()) {\n              module.set.selectedItem($nextSelectedItem);\n            }\n\n            $menu.scrollTop(newScroll);\n          }\n        },\n        set: {\n          filtered: function () {\n            var isMultiple = module.is.multiple(),\n                isSearch = module.is.searchSelection(),\n                isSearchMultiple = isMultiple && isSearch,\n                searchValue = isSearch ? module.get.query() : '',\n                hasSearchValue = typeof searchValue === 'string' && searchValue.length > 0,\n                searchWidth = module.get.searchWidth(),\n                valueIsSet = searchValue !== '';\n\n            if (isMultiple && hasSearchValue) {\n              module.verbose('Adjusting input width', searchWidth, settings.glyphWidth);\n              $search.css('width', searchWidth);\n            }\n\n            if (hasSearchValue || isSearchMultiple && valueIsSet) {\n              module.verbose('Hiding placeholder text');\n              $text.addClass(className.filtered);\n            } else if (!isMultiple || isSearchMultiple && !valueIsSet) {\n              module.verbose('Showing placeholder text');\n              $text.removeClass(className.filtered);\n            }\n          },\n          empty: function () {\n            $module.addClass(className.empty);\n          },\n          loading: function () {\n            $module.addClass(className.loading);\n          },\n          placeholderText: function (text) {\n            text = text || module.get.placeholderText();\n            module.debug('Setting placeholder text', text);\n            module.set.text(text);\n            $text.addClass(className.placeholder);\n          },\n          tabbable: function () {\n            if (module.is.searchSelection()) {\n              module.debug('Added tabindex to searchable dropdown');\n              $search.val('').attr('tabindex', 0);\n              $menu.attr('tabindex', -1);\n            } else {\n              module.debug('Added tabindex to dropdown');\n\n              if ($module.attr('tabindex') === undefined) {\n                $module.attr('tabindex', 0);\n                $menu.attr('tabindex', -1);\n              }\n            }\n          },\n          initialLoad: function () {\n            module.verbose('Setting initial load');\n            initialLoad = true;\n          },\n          activeItem: function ($item) {\n            if (settings.allowAdditions && $item.filter(selector.addition).length > 0) {\n              $item.addClass(className.filtered);\n            } else {\n              $item.addClass(className.active);\n            }\n          },\n          partialSearch: function (text) {\n            var length = module.get.query().length;\n            $search.val(text.substr(0, length));\n          },\n          scrollPosition: function ($item, forceScroll) {\n            var edgeTolerance = 5,\n                $menu,\n                hasActive,\n                offset,\n                itemHeight,\n                itemOffset,\n                menuOffset,\n                menuScroll,\n                menuHeight,\n                abovePage,\n                belowPage;\n            $item = $item || module.get.selectedItem();\n            $menu = $item.closest(selector.menu);\n            hasActive = $item && $item.length > 0;\n            forceScroll = forceScroll !== undefined ? forceScroll : false;\n\n            if ($item && $menu.length > 0 && hasActive) {\n              itemOffset = $item.position().top;\n              $menu.addClass(className.loading);\n              menuScroll = $menu.scrollTop();\n              menuOffset = $menu.offset().top;\n              itemOffset = $item.offset().top;\n              offset = menuScroll - menuOffset + itemOffset;\n\n              if (!forceScroll) {\n                menuHeight = $menu.height();\n                belowPage = menuScroll + menuHeight < offset + edgeTolerance;\n                abovePage = offset - edgeTolerance < menuScroll;\n              }\n\n              module.debug('Scrolling to active item', offset);\n\n              if (forceScroll || abovePage || belowPage) {\n                $menu.scrollTop(offset);\n              }\n\n              $menu.removeClass(className.loading);\n            }\n          },\n          text: function (text) {\n            if (settings.action !== 'select') {\n              if (settings.action == 'combo') {\n                module.debug('Changing combo button text', text, $combo);\n\n                if (settings.preserveHTML) {\n                  $combo.html(text);\n                } else {\n                  $combo.text(text);\n                }\n              } else {\n                if (text !== module.get.placeholderText()) {\n                  $text.removeClass(className.placeholder);\n                }\n\n                module.debug('Changing text', text, $text);\n                $text.removeClass(className.filtered);\n\n                if (settings.preserveHTML) {\n                  $text.html(text);\n                } else {\n                  $text.text(text);\n                }\n              }\n            }\n          },\n          selectedItem: function ($item) {\n            var value = module.get.choiceValue($item),\n                searchText = module.get.choiceText($item, false),\n                text = module.get.choiceText($item, true);\n            module.debug('Setting user selection to item', $item);\n            module.remove.activeItem();\n            module.set.partialSearch(searchText);\n            module.set.activeItem($item);\n            module.set.selected(value, $item);\n            module.set.text(text);\n          },\n          selectedLetter: function (letter) {\n            var $selectedItem = $item.filter('.' + className.selected),\n                alreadySelectedLetter = $selectedItem.length > 0 && module.has.firstLetter($selectedItem, letter),\n                $nextValue = false,\n                $nextItem; // check next of same letter\n\n            if (alreadySelectedLetter) {\n              $nextItem = $selectedItem.nextAll($item).eq(0);\n\n              if (module.has.firstLetter($nextItem, letter)) {\n                $nextValue = $nextItem;\n              }\n            } // check all values\n\n\n            if (!$nextValue) {\n              $item.each(function () {\n                if (module.has.firstLetter($(this), letter)) {\n                  $nextValue = $(this);\n                  return false;\n                }\n              });\n            } // set next value\n\n\n            if ($nextValue) {\n              module.verbose('Scrolling to next value with letter', letter);\n              module.set.scrollPosition($nextValue);\n              $selectedItem.removeClass(className.selected);\n              $nextValue.addClass(className.selected);\n\n              if (settings.selectOnKeydown && module.is.single()) {\n                module.set.selectedItem($nextValue);\n              }\n            }\n          },\n          direction: function ($menu) {\n            if (settings.direction == 'auto') {\n              // reset position\n              module.remove.upward();\n\n              if (module.can.openDownward($menu)) {\n                module.remove.upward($menu);\n              } else {\n                module.set.upward($menu);\n              }\n\n              if (!module.is.leftward($menu) && !module.can.openRightward($menu)) {\n                module.set.leftward($menu);\n              }\n            } else if (settings.direction == 'upward') {\n              module.set.upward($menu);\n            }\n          },\n          upward: function ($currentMenu) {\n            var $element = $currentMenu || $module;\n            $element.addClass(className.upward);\n          },\n          leftward: function ($currentMenu) {\n            var $element = $currentMenu || $menu;\n            $element.addClass(className.leftward);\n          },\n          value: function (value, text, $selected) {\n            var escapedValue = module.escape.value(value),\n                hasInput = $input.length > 0,\n                currentValue = module.get.values(),\n                stringValue = value !== undefined ? String(value) : value,\n                newValue;\n\n            if (hasInput) {\n              if (!settings.allowReselection && stringValue == currentValue) {\n                module.verbose('Skipping value update already same value', value, currentValue);\n\n                if (!module.is.initialLoad()) {\n                  return;\n                }\n              }\n\n              if (module.is.single() && module.has.selectInput() && module.can.extendSelect()) {\n                module.debug('Adding user option', value);\n                module.add.optionValue(value);\n              }\n\n              module.debug('Updating input value', escapedValue, currentValue);\n              internalChange = true;\n              $input.val(escapedValue);\n\n              if (settings.fireOnInit === false && module.is.initialLoad()) {\n                module.debug('Input native change event ignored on initial load');\n              } else {\n                module.trigger.change();\n              }\n\n              internalChange = false;\n            } else {\n              module.verbose('Storing value in metadata', escapedValue, $input);\n\n              if (escapedValue !== currentValue) {\n                $module.data(metadata.value, stringValue);\n              }\n            }\n\n            if (settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onChange);\n            } else {\n              settings.onChange.call(element, value, text, $selected);\n            }\n          },\n          active: function () {\n            $module.addClass(className.active);\n          },\n          multiple: function () {\n            $module.addClass(className.multiple);\n          },\n          visible: function () {\n            $module.addClass(className.visible);\n          },\n          exactly: function (value, $selectedItem) {\n            module.debug('Setting selected to exact values');\n            module.clear();\n            module.set.selected(value, $selectedItem);\n          },\n          selected: function (value, $selectedItem) {\n            var isMultiple = module.is.multiple(),\n                $userSelectedItem;\n            $selectedItem = settings.allowAdditions ? $selectedItem || module.get.itemWithAdditions(value) : $selectedItem || module.get.item(value);\n\n            if (!$selectedItem) {\n              return;\n            }\n\n            module.debug('Setting selected menu item to', $selectedItem);\n\n            if (module.is.multiple()) {\n              module.remove.searchWidth();\n            }\n\n            if (module.is.single()) {\n              module.remove.activeItem();\n              module.remove.selectedItem();\n            } else if (settings.useLabels) {\n              module.remove.selectedItem();\n            } // select each item\n\n\n            $selectedItem.each(function () {\n              var $selected = $(this),\n                  selectedText = module.get.choiceText($selected),\n                  selectedValue = module.get.choiceValue($selected, selectedText),\n                  isFiltered = $selected.hasClass(className.filtered),\n                  isActive = $selected.hasClass(className.active),\n                  isUserValue = $selected.hasClass(className.addition),\n                  shouldAnimate = isMultiple && $selectedItem.length == 1;\n\n              if (isMultiple) {\n                if (!isActive || isUserValue) {\n                  if (settings.apiSettings && settings.saveRemoteData) {\n                    module.save.remoteData(selectedText, selectedValue);\n                  }\n\n                  if (settings.useLabels) {\n                    module.add.label(selectedValue, selectedText, shouldAnimate);\n                    module.add.value(selectedValue, selectedText, $selected);\n                    module.set.activeItem($selected);\n                    module.filterActive();\n                    module.select.nextAvailable($selectedItem);\n                  } else {\n                    module.add.value(selectedValue, selectedText, $selected);\n                    module.set.text(module.add.variables(message.count));\n                    module.set.activeItem($selected);\n                  }\n                } else if (!isFiltered) {\n                  module.debug('Selected active value, removing label');\n                  module.remove.selected(selectedValue);\n                }\n              } else {\n                if (settings.apiSettings && settings.saveRemoteData) {\n                  module.save.remoteData(selectedText, selectedValue);\n                }\n\n                module.set.text(selectedText);\n                module.set.value(selectedValue, selectedText, $selected);\n                $selected.addClass(className.active).addClass(className.selected);\n              }\n            });\n          }\n        },\n        add: {\n          label: function (value, text, shouldAnimate) {\n            var $next = module.is.searchSelection() ? $search : $text,\n                escapedValue = module.escape.value(value),\n                $label;\n\n            if (settings.ignoreCase) {\n              escapedValue = escapedValue.toLowerCase();\n            }\n\n            $label = $('<a />').addClass(className.label).attr('data-' + metadata.value, escapedValue).html(templates.label(escapedValue, text));\n            $label = settings.onLabelCreate.call($label, escapedValue, text);\n\n            if (module.has.label(value)) {\n              module.debug('User selection already exists, skipping', escapedValue);\n              return;\n            }\n\n            if (settings.label.variation) {\n              $label.addClass(settings.label.variation);\n            }\n\n            if (shouldAnimate === true) {\n              module.debug('Animating in label', $label);\n              $label.addClass(className.hidden).insertBefore($next).transition(settings.label.transition, settings.label.duration);\n            } else {\n              module.debug('Adding selection label', $label);\n              $label.insertBefore($next);\n            }\n          },\n          message: function (message) {\n            var $message = $menu.children(selector.message),\n                html = settings.templates.message(module.add.variables(message));\n\n            if ($message.length > 0) {\n              $message.html(html);\n            } else {\n              $message = $('<div/>').html(html).addClass(className.message).appendTo($menu);\n            }\n          },\n          optionValue: function (value) {\n            var escapedValue = module.escape.value(value),\n                $option = $input.find('option[value=\"' + module.escape.string(escapedValue) + '\"]'),\n                hasOption = $option.length > 0;\n\n            if (hasOption) {\n              return;\n            } // temporarily disconnect observer\n\n\n            module.disconnect.selectObserver();\n\n            if (module.is.single()) {\n              module.verbose('Removing previous user addition');\n              $input.find('option.' + className.addition).remove();\n            }\n\n            $('<option/>').prop('value', escapedValue).addClass(className.addition).html(value).appendTo($input);\n            module.verbose('Adding user addition as an <option>', value);\n            module.observe.select();\n          },\n          userSuggestion: function (value) {\n            var $addition = $menu.children(selector.addition),\n                $existingItem = module.get.item(value),\n                alreadyHasValue = $existingItem && $existingItem.not(selector.addition).length,\n                hasUserSuggestion = $addition.length > 0,\n                html;\n\n            if (settings.useLabels && module.has.maxSelections()) {\n              return;\n            }\n\n            if (value === '' || alreadyHasValue) {\n              $addition.remove();\n              return;\n            }\n\n            if (hasUserSuggestion) {\n              $addition.data(metadata.value, value).data(metadata.text, value).attr('data-' + metadata.value, value).attr('data-' + metadata.text, value).removeClass(className.filtered);\n\n              if (!settings.hideAdditions) {\n                html = settings.templates.addition(module.add.variables(message.addResult, value));\n                $addition.html(html);\n              }\n\n              module.verbose('Replacing user suggestion with new value', $addition);\n            } else {\n              $addition = module.create.userChoice(value);\n              $addition.prependTo($menu);\n              module.verbose('Adding item choice to menu corresponding with user choice addition', $addition);\n            }\n\n            if (!settings.hideAdditions || module.is.allFiltered()) {\n              $addition.addClass(className.selected).siblings().removeClass(className.selected);\n            }\n\n            module.refreshItems();\n          },\n          variables: function (message, term) {\n            var hasCount = message.search('{count}') !== -1,\n                hasMaxCount = message.search('{maxCount}') !== -1,\n                hasTerm = message.search('{term}') !== -1,\n                values,\n                count,\n                query;\n            module.verbose('Adding templated variables to message', message);\n\n            if (hasCount) {\n              count = module.get.selectionCount();\n              message = message.replace('{count}', count);\n            }\n\n            if (hasMaxCount) {\n              count = module.get.selectionCount();\n              message = message.replace('{maxCount}', settings.maxSelections);\n            }\n\n            if (hasTerm) {\n              query = term || module.get.query();\n              message = message.replace('{term}', query);\n            }\n\n            return message;\n          },\n          value: function (addedValue, addedText, $selectedItem) {\n            var currentValue = module.get.values(),\n                newValue;\n\n            if (module.has.value(addedValue)) {\n              module.debug('Value already selected');\n              return;\n            }\n\n            if (addedValue === '') {\n              module.debug('Cannot select blank values from multiselect');\n              return;\n            } // extend current array\n\n\n            if ($.isArray(currentValue)) {\n              newValue = currentValue.concat([addedValue]);\n              newValue = module.get.uniqueArray(newValue);\n            } else {\n              newValue = [addedValue];\n            } // add values\n\n\n            if (module.has.selectInput()) {\n              if (module.can.extendSelect()) {\n                module.debug('Adding value to select', addedValue, newValue, $input);\n                module.add.optionValue(addedValue);\n              }\n            } else {\n              newValue = newValue.join(settings.delimiter);\n              module.debug('Setting hidden input to delimited value', newValue, $input);\n            }\n\n            if (settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('Skipping onadd callback on initial load', settings.onAdd);\n            } else {\n              settings.onAdd.call(element, addedValue, addedText, $selectedItem);\n            }\n\n            module.set.value(newValue, addedValue, addedText, $selectedItem);\n            module.check.maxSelections();\n          }\n        },\n        remove: {\n          active: function () {\n            $module.removeClass(className.active);\n          },\n          activeLabel: function () {\n            $module.find(selector.label).removeClass(className.active);\n          },\n          empty: function () {\n            $module.removeClass(className.empty);\n          },\n          loading: function () {\n            $module.removeClass(className.loading);\n          },\n          initialLoad: function () {\n            initialLoad = false;\n          },\n          upward: function ($currentMenu) {\n            var $element = $currentMenu || $module;\n            $element.removeClass(className.upward);\n          },\n          leftward: function ($currentMenu) {\n            var $element = $currentMenu || $menu;\n            $element.removeClass(className.leftward);\n          },\n          visible: function () {\n            $module.removeClass(className.visible);\n          },\n          activeItem: function () {\n            $item.removeClass(className.active);\n          },\n          filteredItem: function () {\n            if (settings.useLabels && module.has.maxSelections()) {\n              return;\n            }\n\n            if (settings.useLabels && module.is.multiple()) {\n              $item.not('.' + className.active).removeClass(className.filtered);\n            } else {\n              $item.removeClass(className.filtered);\n            }\n\n            module.remove.empty();\n          },\n          optionValue: function (value) {\n            var escapedValue = module.escape.value(value),\n                $option = $input.find('option[value=\"' + module.escape.string(escapedValue) + '\"]'),\n                hasOption = $option.length > 0;\n\n            if (!hasOption || !$option.hasClass(className.addition)) {\n              return;\n            } // temporarily disconnect observer\n\n\n            if (selectObserver) {\n              selectObserver.disconnect();\n              module.verbose('Temporarily disconnecting mutation observer');\n            }\n\n            $option.remove();\n            module.verbose('Removing user addition as an <option>', escapedValue);\n\n            if (selectObserver) {\n              selectObserver.observe($input[0], {\n                childList: true,\n                subtree: true\n              });\n            }\n          },\n          message: function () {\n            $menu.children(selector.message).remove();\n          },\n          searchWidth: function () {\n            $search.css('width', '');\n          },\n          searchTerm: function () {\n            module.verbose('Cleared search term');\n            $search.val('');\n            module.set.filtered();\n          },\n          userAddition: function () {\n            $item.filter(selector.addition).remove();\n          },\n          selected: function (value, $selectedItem) {\n            $selectedItem = settings.allowAdditions ? $selectedItem || module.get.itemWithAdditions(value) : $selectedItem || module.get.item(value);\n\n            if (!$selectedItem) {\n              return false;\n            }\n\n            $selectedItem.each(function () {\n              var $selected = $(this),\n                  selectedText = module.get.choiceText($selected),\n                  selectedValue = module.get.choiceValue($selected, selectedText);\n\n              if (module.is.multiple()) {\n                if (settings.useLabels) {\n                  module.remove.value(selectedValue, selectedText, $selected);\n                  module.remove.label(selectedValue);\n                } else {\n                  module.remove.value(selectedValue, selectedText, $selected);\n\n                  if (module.get.selectionCount() === 0) {\n                    module.set.placeholderText();\n                  } else {\n                    module.set.text(module.add.variables(message.count));\n                  }\n                }\n              } else {\n                module.remove.value(selectedValue, selectedText, $selected);\n              }\n\n              $selected.removeClass(className.filtered).removeClass(className.active);\n\n              if (settings.useLabels) {\n                $selected.removeClass(className.selected);\n              }\n            });\n          },\n          selectedItem: function () {\n            $item.removeClass(className.selected);\n          },\n          value: function (removedValue, removedText, $removedItem) {\n            var values = module.get.values(),\n                newValue;\n\n            if (module.has.selectInput()) {\n              module.verbose('Input is <select> removing selected option', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              module.remove.optionValue(removedValue);\n            } else {\n              module.verbose('Removing from delimited values', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              newValue = newValue.join(settings.delimiter);\n            }\n\n            if (settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onRemove);\n            } else {\n              settings.onRemove.call(element, removedValue, removedText, $removedItem);\n            }\n\n            module.set.value(newValue, removedText, $removedItem);\n            module.check.maxSelections();\n          },\n          arrayValue: function (removedValue, values) {\n            if (!$.isArray(values)) {\n              values = [values];\n            }\n\n            values = $.grep(values, function (value) {\n              return removedValue != value;\n            });\n            module.verbose('Removed value from delimited string', removedValue, values);\n            return values;\n          },\n          label: function (value, shouldAnimate) {\n            var $labels = $module.find(selector.label),\n                $removedLabel = $labels.filter('[data-' + metadata.value + '=\"' + module.escape.string(value) + '\"]');\n            module.verbose('Removing label', $removedLabel);\n            $removedLabel.remove();\n          },\n          activeLabels: function ($activeLabels) {\n            $activeLabels = $activeLabels || $module.find(selector.label).filter('.' + className.active);\n            module.verbose('Removing active label selections', $activeLabels);\n            module.remove.labels($activeLabels);\n          },\n          labels: function ($labels) {\n            $labels = $labels || $module.find(selector.label);\n            module.verbose('Removing labels', $labels);\n            $labels.each(function () {\n              var $label = $(this),\n                  value = $label.data(metadata.value),\n                  stringValue = value !== undefined ? String(value) : value,\n                  isUserValue = module.is.userValue(stringValue);\n\n              if (settings.onLabelRemove.call($label, value) === false) {\n                module.debug('Label remove callback cancelled removal');\n                return;\n              }\n\n              module.remove.message();\n\n              if (isUserValue) {\n                module.remove.value(stringValue);\n                module.remove.label(stringValue);\n              } else {\n                // selected will also remove label\n                module.remove.selected(stringValue);\n              }\n            });\n          },\n          tabbable: function () {\n            if (module.is.searchSelection()) {\n              module.debug('Searchable dropdown initialized');\n              $search.removeAttr('tabindex');\n              $menu.removeAttr('tabindex');\n            } else {\n              module.debug('Simple selection dropdown initialized');\n              $module.removeAttr('tabindex');\n              $menu.removeAttr('tabindex');\n            }\n          }\n        },\n        has: {\n          menuSearch: function () {\n            return module.has.search() && $search.closest($menu).length > 0;\n          },\n          search: function () {\n            return $search.length > 0;\n          },\n          sizer: function () {\n            return $sizer.length > 0;\n          },\n          selectInput: function () {\n            return $input.is('select');\n          },\n          minCharacters: function (searchTerm) {\n            if (settings.minCharacters) {\n              searchTerm = searchTerm !== undefined ? String(searchTerm) : String(module.get.query());\n              return searchTerm.length >= settings.minCharacters;\n            }\n\n            return true;\n          },\n          firstLetter: function ($item, letter) {\n            var text, firstLetter;\n\n            if (!$item || $item.length === 0 || typeof letter !== 'string') {\n              return false;\n            }\n\n            text = module.get.choiceText($item, false);\n            letter = letter.toLowerCase();\n            firstLetter = String(text).charAt(0).toLowerCase();\n            return letter == firstLetter;\n          },\n          input: function () {\n            return $input.length > 0;\n          },\n          items: function () {\n            return $item.length > 0;\n          },\n          menu: function () {\n            return $menu.length > 0;\n          },\n          message: function () {\n            return $menu.children(selector.message).length !== 0;\n          },\n          label: function (value) {\n            var escapedValue = module.escape.value(value),\n                $labels = $module.find(selector.label);\n\n            if (settings.ignoreCase) {\n              escapedValue = escapedValue.toLowerCase();\n            }\n\n            return $labels.filter('[data-' + metadata.value + '=\"' + module.escape.string(escapedValue) + '\"]').length > 0;\n          },\n          maxSelections: function () {\n            return settings.maxSelections && module.get.selectionCount() >= settings.maxSelections;\n          },\n          allResultsFiltered: function () {\n            var $normalResults = $item.not(selector.addition);\n            return $normalResults.filter(selector.unselectable).length === $normalResults.length;\n          },\n          userSuggestion: function () {\n            return $menu.children(selector.addition).length > 0;\n          },\n          query: function () {\n            return module.get.query() !== '';\n          },\n          value: function (value) {\n            return settings.ignoreCase ? module.has.valueIgnoringCase(value) : module.has.valueMatchingCase(value);\n          },\n          valueMatchingCase: function (value) {\n            var values = module.get.values(),\n                hasValue = $.isArray(values) ? values && $.inArray(value, values) !== -1 : values == value;\n            return hasValue ? true : false;\n          },\n          valueIgnoringCase: function (value) {\n            var values = module.get.values(),\n                hasValue = false;\n\n            if (!$.isArray(values)) {\n              values = [values];\n            }\n\n            $.each(values, function (index, existingValue) {\n              if (String(value).toLowerCase() == String(existingValue).toLowerCase()) {\n                hasValue = true;\n                return false;\n              }\n            });\n            return hasValue;\n          }\n        },\n        is: {\n          active: function () {\n            return $module.hasClass(className.active);\n          },\n          animatingInward: function () {\n            return $menu.transition('is inward');\n          },\n          animatingOutward: function () {\n            return $menu.transition('is outward');\n          },\n          bubbledLabelClick: function (event) {\n            return $(event.target).is('select, input') && $module.closest('label').length > 0;\n          },\n          bubbledIconClick: function (event) {\n            return $(event.target).closest($icon).length > 0;\n          },\n          alreadySetup: function () {\n            return $module.is('select') && $module.parent(selector.dropdown).data(moduleNamespace) !== undefined && $module.prev().length === 0;\n          },\n          animating: function ($subMenu) {\n            return $subMenu ? $subMenu.transition && $subMenu.transition('is animating') : $menu.transition && $menu.transition('is animating');\n          },\n          leftward: function ($subMenu) {\n            var $selectedMenu = $subMenu || $menu;\n            return $selectedMenu.hasClass(className.leftward);\n          },\n          disabled: function () {\n            return $module.hasClass(className.disabled);\n          },\n          focused: function () {\n            return document.activeElement === $module[0];\n          },\n          focusedOnSearch: function () {\n            return document.activeElement === $search[0];\n          },\n          allFiltered: function () {\n            return (module.is.multiple() || module.has.search()) && !(settings.hideAdditions == false && module.has.userSuggestion()) && !module.has.message() && module.has.allResultsFiltered();\n          },\n          hidden: function ($subMenu) {\n            return !module.is.visible($subMenu);\n          },\n          initialLoad: function () {\n            return initialLoad;\n          },\n          inObject: function (needle, object) {\n            var found = false;\n            $.each(object, function (index, property) {\n              if (property == needle) {\n                found = true;\n                return true;\n              }\n            });\n            return found;\n          },\n          multiple: function () {\n            return $module.hasClass(className.multiple);\n          },\n          remote: function () {\n            return settings.apiSettings && module.can.useAPI();\n          },\n          single: function () {\n            return !module.is.multiple();\n          },\n          selectMutation: function (mutations) {\n            var selectChanged = false;\n            $.each(mutations, function (index, mutation) {\n              if (mutation.target && $(mutation.target).is('select')) {\n                selectChanged = true;\n                return true;\n              }\n            });\n            return selectChanged;\n          },\n          search: function () {\n            return $module.hasClass(className.search);\n          },\n          searchSelection: function () {\n            return module.has.search() && $search.parent(selector.dropdown).length === 1;\n          },\n          selection: function () {\n            return $module.hasClass(className.selection);\n          },\n          userValue: function (value) {\n            return $.inArray(value, module.get.userValues()) !== -1;\n          },\n          upward: function ($menu) {\n            var $element = $menu || $module;\n            return $element.hasClass(className.upward);\n          },\n          visible: function ($subMenu) {\n            return $subMenu ? $subMenu.hasClass(className.visible) : $menu.hasClass(className.visible);\n          },\n          verticallyScrollableContext: function () {\n            var overflowY = $context.get(0) !== window ? $context.css('overflow-y') : false;\n            return overflowY == 'auto' || overflowY == 'scroll';\n          },\n          horizontallyScrollableContext: function () {\n            var overflowX = $context.get(0) !== window ? $context.css('overflow-X') : false;\n            return overflowX == 'auto' || overflowX == 'scroll';\n          }\n        },\n        can: {\n          activate: function ($item) {\n            if (settings.useLabels) {\n              return true;\n            }\n\n            if (!module.has.maxSelections()) {\n              return true;\n            }\n\n            if (module.has.maxSelections() && $item.hasClass(className.active)) {\n              return true;\n            }\n\n            return false;\n          },\n          openDownward: function ($subMenu) {\n            var $currentMenu = $subMenu || $menu,\n                canOpenDownward = true,\n                onScreen = {},\n                calculations;\n            $currentMenu.addClass(className.loading);\n            calculations = {\n              context: {\n                offset: $context.get(0) === window ? {\n                  top: 0,\n                  left: 0\n                } : $context.offset(),\n                scrollTop: $context.scrollTop(),\n                height: $context.outerHeight()\n              },\n              menu: {\n                offset: $currentMenu.offset(),\n                height: $currentMenu.outerHeight()\n              }\n            };\n\n            if (module.is.verticallyScrollableContext()) {\n              calculations.menu.offset.top += calculations.context.scrollTop;\n            }\n\n            onScreen = {\n              above: calculations.context.scrollTop <= calculations.menu.offset.top - calculations.context.offset.top - calculations.menu.height,\n              below: calculations.context.scrollTop + calculations.context.height >= calculations.menu.offset.top - calculations.context.offset.top + calculations.menu.height\n            };\n\n            if (onScreen.below) {\n              module.verbose('Dropdown can fit in context downward', onScreen);\n              canOpenDownward = true;\n            } else if (!onScreen.below && !onScreen.above) {\n              module.verbose('Dropdown cannot fit in either direction, favoring downward', onScreen);\n              canOpenDownward = true;\n            } else {\n              module.verbose('Dropdown cannot fit below, opening upward', onScreen);\n              canOpenDownward = false;\n            }\n\n            $currentMenu.removeClass(className.loading);\n            return canOpenDownward;\n          },\n          openRightward: function ($subMenu) {\n            var $currentMenu = $subMenu || $menu,\n                canOpenRightward = true,\n                isOffscreenRight = false,\n                calculations;\n            $currentMenu.addClass(className.loading);\n            calculations = {\n              context: {\n                offset: $context.get(0) === window ? {\n                  top: 0,\n                  left: 0\n                } : $context.offset(),\n                scrollLeft: $context.scrollLeft(),\n                width: $context.outerWidth()\n              },\n              menu: {\n                offset: $currentMenu.offset(),\n                width: $currentMenu.outerWidth()\n              }\n            };\n\n            if (module.is.horizontallyScrollableContext()) {\n              calculations.menu.offset.left += calculations.context.scrollLeft;\n            }\n\n            isOffscreenRight = calculations.menu.offset.left - calculations.context.offset.left + calculations.menu.width >= calculations.context.scrollLeft + calculations.context.width;\n\n            if (isOffscreenRight) {\n              module.verbose('Dropdown cannot fit in context rightward', isOffscreenRight);\n              canOpenRightward = false;\n            }\n\n            $currentMenu.removeClass(className.loading);\n            return canOpenRightward;\n          },\n          click: function () {\n            return hasTouch || settings.on == 'click';\n          },\n          extendSelect: function () {\n            return settings.allowAdditions || settings.apiSettings;\n          },\n          show: function () {\n            return !module.is.disabled() && (module.has.items() || module.has.message());\n          },\n          useAPI: function () {\n            return $.fn.api !== undefined;\n          }\n        },\n        animate: {\n          show: function (callback, $subMenu) {\n            var $currentMenu = $subMenu || $menu,\n                start = $subMenu ? function () {} : function () {\n              module.hideSubMenus();\n              module.hideOthers();\n              module.set.active();\n            },\n                transition;\n            callback = $.isFunction(callback) ? callback : function () {};\n            module.verbose('Doing menu show animation', $currentMenu);\n            module.set.direction($subMenu);\n            transition = module.get.transition($subMenu);\n\n            if (module.is.selection()) {\n              module.set.scrollPosition(module.get.selectedItem(), true);\n            }\n\n            if (module.is.hidden($currentMenu) || module.is.animating($currentMenu)) {\n              if (transition == 'none') {\n                start();\n                $currentMenu.transition('show');\n                callback.call(element);\n              } else if ($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu.transition({\n                  animation: transition + ' in',\n                  debug: settings.debug,\n                  verbose: settings.verbose,\n                  duration: settings.duration,\n                  queue: true,\n                  onStart: start,\n                  onComplete: function () {\n                    callback.call(element);\n                  }\n                });\n              } else {\n                module.error(error.noTransition, transition);\n              }\n            }\n          },\n          hide: function (callback, $subMenu) {\n            var $currentMenu = $subMenu || $menu,\n                duration = $subMenu ? settings.duration * 0.9 : settings.duration,\n                start = $subMenu ? function () {} : function () {\n              if (module.can.click()) {\n                module.unbind.intent();\n              }\n\n              module.remove.active();\n            },\n                transition = module.get.transition($subMenu);\n            callback = $.isFunction(callback) ? callback : function () {};\n\n            if (module.is.visible($currentMenu) || module.is.animating($currentMenu)) {\n              module.verbose('Doing menu hide animation', $currentMenu);\n\n              if (transition == 'none') {\n                start();\n                $currentMenu.transition('hide');\n                callback.call(element);\n              } else if ($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu.transition({\n                  animation: transition + ' out',\n                  duration: settings.duration,\n                  debug: settings.debug,\n                  verbose: settings.verbose,\n                  queue: false,\n                  onStart: start,\n                  onComplete: function () {\n                    callback.call(element);\n                  }\n                });\n              } else {\n                module.error(error.transition);\n              }\n            }\n          }\n        },\n        hideAndClear: function () {\n          module.remove.searchTerm();\n\n          if (module.has.maxSelections()) {\n            return;\n          }\n\n          if (module.has.search()) {\n            module.hide(function () {\n              module.remove.filteredItem();\n            });\n          } else {\n            module.hide();\n          }\n        },\n        delay: {\n          show: function () {\n            module.verbose('Delaying show event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.show, settings.delay.show);\n          },\n          hide: function () {\n            module.verbose('Delaying hide event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.hide, settings.delay.hide);\n          }\n        },\n        escape: {\n          value: function (value) {\n            var multipleValues = $.isArray(value),\n                stringValue = typeof value === 'string',\n                isUnparsable = !stringValue && !multipleValues,\n                hasQuotes = stringValue && value.search(regExp.quote) !== -1,\n                values = [];\n\n            if (isUnparsable || !hasQuotes) {\n              return value;\n            }\n\n            module.debug('Encoding quote values for use in select', value);\n\n            if (multipleValues) {\n              $.each(value, function (index, value) {\n                values.push(value.replace(regExp.quote, '&quot;'));\n              });\n              return values;\n            }\n\n            return value.replace(regExp.quote, '&quot;');\n          },\n          string: function (text) {\n            text = String(text);\n            return text.replace(regExp.escape, '\\\\$&');\n          }\n        },\n        setting: function (name, value) {\n          module.debug('Changing setting', name, value);\n\n          if ($.isPlainObject(name)) {\n            $.extend(true, settings, name);\n          } else if (value !== undefined) {\n            if ($.isPlainObject(settings[name])) {\n              $.extend(true, settings[name], value);\n            } else {\n              settings[name] = value;\n            }\n          } else {\n            return settings[name];\n          }\n        },\n        internal: function (name, value) {\n          if ($.isPlainObject(name)) {\n            $.extend(true, module, name);\n          } else if (value !== undefined) {\n            module[name] = value;\n          } else {\n            return module[name];\n          }\n        },\n        debug: function () {\n          if (!settings.silent && settings.debug) {\n            if (settings.performance) {\n              module.performance.log(arguments);\n            } else {\n              module.debug = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.debug.apply(console, arguments);\n            }\n          }\n        },\n        verbose: function () {\n          if (!settings.silent && settings.verbose && settings.debug) {\n            if (settings.performance) {\n              module.performance.log(arguments);\n            } else {\n              module.verbose = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.verbose.apply(console, arguments);\n            }\n          }\n        },\n        error: function () {\n          if (!settings.silent) {\n            module.error = Function.prototype.bind.call(console.error, console, settings.name + ':');\n            module.error.apply(console, arguments);\n          }\n        },\n        performance: {\n          log: function (message) {\n            var currentTime, executionTime, previousTime;\n\n            if (settings.performance) {\n              currentTime = new Date().getTime();\n              previousTime = time || currentTime;\n              executionTime = currentTime - previousTime;\n              time = currentTime;\n              performance.push({\n                'Name': message[0],\n                'Arguments': [].slice.call(message, 1) || '',\n                'Element': element,\n                'Execution Time': executionTime\n              });\n            }\n\n            clearTimeout(module.performance.timer);\n            module.performance.timer = setTimeout(module.performance.display, 500);\n          },\n          display: function () {\n            var title = settings.name + ':',\n                totalTime = 0;\n            time = false;\n            clearTimeout(module.performance.timer);\n            $.each(performance, function (index, data) {\n              totalTime += data['Execution Time'];\n            });\n            title += ' ' + totalTime + 'ms';\n\n            if (moduleSelector) {\n              title += ' \\'' + moduleSelector + '\\'';\n            }\n\n            if ((console.group !== undefined || console.table !== undefined) && performance.length > 0) {\n              console.groupCollapsed(title);\n\n              if (console.table) {\n                console.table(performance);\n              } else {\n                $.each(performance, function (index, data) {\n                  console.log(data['Name'] + ': ' + data['Execution Time'] + 'ms');\n                });\n              }\n\n              console.groupEnd();\n            }\n\n            performance = [];\n          }\n        },\n        invoke: function (query, passedArguments, context) {\n          var object = instance,\n              maxDepth,\n              found,\n              response;\n          passedArguments = passedArguments || queryArguments;\n          context = element || context;\n\n          if (typeof query == 'string' && object !== undefined) {\n            query = query.split(/[\\. ]/);\n            maxDepth = query.length - 1;\n            $.each(query, function (depth, value) {\n              var camelCaseValue = depth != maxDepth ? value + query[depth + 1].charAt(0).toUpperCase() + query[depth + 1].slice(1) : query;\n\n              if ($.isPlainObject(object[camelCaseValue]) && depth != maxDepth) {\n                object = object[camelCaseValue];\n              } else if (object[camelCaseValue] !== undefined) {\n                found = object[camelCaseValue];\n                return false;\n              } else if ($.isPlainObject(object[value]) && depth != maxDepth) {\n                object = object[value];\n              } else if (object[value] !== undefined) {\n                found = object[value];\n                return false;\n              } else {\n                module.error(error.method, query);\n                return false;\n              }\n            });\n          }\n\n          if ($.isFunction(found)) {\n            response = found.apply(context, passedArguments);\n          } else if (found !== undefined) {\n            response = found;\n          }\n\n          if ($.isArray(returnedValue)) {\n            returnedValue.push(response);\n          } else if (returnedValue !== undefined) {\n            returnedValue = [returnedValue, response];\n          } else if (response !== undefined) {\n            returnedValue = response;\n          }\n\n          return found;\n        }\n      };\n\n      if (methodInvoked) {\n        if (instance === undefined) {\n          module.initialize();\n        }\n\n        module.invoke(query);\n      } else {\n        if (instance !== undefined) {\n          instance.invoke('destroy');\n        }\n\n        module.initialize();\n      }\n    });\n    return returnedValue !== undefined ? returnedValue : $allModules;\n  };\n\n  $.fn.dropdown.settings = {\n    silent: false,\n    debug: false,\n    verbose: false,\n    performance: true,\n    on: 'click',\n    // what event should show menu action on item selection\n    action: 'activate',\n    // action on item selection (nothing, activate, select, combo, hide, function(){})\n    values: false,\n    // specify values to use for dropdown\n    apiSettings: false,\n    selectOnKeydown: true,\n    // Whether selection should occur automatically when keyboard shortcuts used\n    minCharacters: 0,\n    // Minimum characters required to trigger API call\n    filterRemoteData: false,\n    // Whether API results should be filtered after being returned for query term\n    saveRemoteData: true,\n    // Whether remote name/value pairs should be stored in sessionStorage to allow remote data to be restored on page refresh\n    throttle: 200,\n    // How long to wait after last user input to search remotely\n    context: window,\n    // Context to use when determining if on screen\n    direction: 'auto',\n    // Whether dropdown should always open in one direction\n    keepOnScreen: true,\n    // Whether dropdown should check whether it is on screen before showing\n    match: 'both',\n    // what to match against with search selection (both, text, or label)\n    fullTextSearch: false,\n    // search anywhere in value (set to 'exact' to require exact matches)\n    placeholder: 'auto',\n    // whether to convert blank <select> values to placeholder text\n    preserveHTML: true,\n    // preserve html when selecting value\n    sortSelect: false,\n    // sort selection on init\n    forceSelection: true,\n    // force a choice on blur with search selection\n    allowAdditions: false,\n    // whether multiple select should allow user added values\n    ignoreCase: false,\n    // whether to consider values not matching in case to be the same\n    hideAdditions: true,\n    // whether or not to hide special message prompting a user they can enter a value\n    maxSelections: false,\n    // When set to a number limits the number of selections to this count\n    useLabels: true,\n    // whether multiple select should filter currently active selections from choices\n    delimiter: ',',\n    // when multiselect uses normal <input> the values will be delimited with this character\n    showOnFocus: true,\n    // show menu on focus\n    allowReselection: false,\n    // whether current value should trigger callbacks when reselected\n    allowTab: true,\n    // add tabindex to element\n    allowCategorySelection: false,\n    // allow elements with sub-menus to be selected\n    fireOnInit: false,\n    // Whether callbacks should fire when initializing dropdown values\n    transition: 'auto',\n    // auto transition will slide down or up based on direction\n    duration: 200,\n    // duration of transition\n    glyphWidth: 1.037,\n    // widest glyph width in em (W is 1.037 em) used to calculate multiselect input width\n    // label settings on multi-select\n    label: {\n      transition: 'scale',\n      duration: 200,\n      variation: false\n    },\n    // delay before event\n    delay: {\n      hide: 300,\n      show: 200,\n      search: 20,\n      touch: 50\n    },\n\n    /* Callbacks */\n    onChange: function (value, text, $selected) {},\n    onAdd: function (value, text, $selected) {},\n    onRemove: function (value, text, $selected) {},\n    onLabelSelect: function ($selectedLabels) {},\n    onLabelCreate: function (value, text) {\n      return $(this);\n    },\n    onLabelRemove: function (value) {\n      return true;\n    },\n    onNoResults: function (searchTerm) {\n      return true;\n    },\n    onShow: function () {},\n    onHide: function () {},\n\n    /* Component */\n    name: 'Dropdown',\n    namespace: 'dropdown',\n    message: {\n      addResult: 'Add <b>{term}</b>',\n      count: '{count} selected',\n      maxSelections: 'Max {maxCount} selections',\n      noResults: 'No results found.',\n      serverError: 'There was an error contacting the server'\n    },\n    error: {\n      action: 'You called a dropdown action that was not defined',\n      alreadySetup: 'Once a select has been initialized behaviors must be called on the created ui dropdown',\n      labels: 'Allowing user additions currently requires the use of labels.',\n      missingMultiple: '<select> requires multiple property to be set to correctly preserve multiple values',\n      method: 'The method you called is not defined.',\n      noAPI: 'The API module is required to load resources remotely',\n      noStorage: 'Saving remote data requires session storage',\n      noTransition: 'This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>'\n    },\n    regExp: {\n      escape: /[-[\\]{}()*+?.,\\\\^$|#\\s]/g,\n      quote: /\"/g\n    },\n    metadata: {\n      defaultText: 'defaultText',\n      defaultValue: 'defaultValue',\n      placeholderText: 'placeholder',\n      text: 'text',\n      value: 'value'\n    },\n    // property names for remote query\n    fields: {\n      remoteValues: 'results',\n      // grouping for api results\n      values: 'values',\n      // grouping for all dropdown values\n      disabled: 'disabled',\n      // whether value should be disabled\n      name: 'name',\n      // displayed dropdown text\n      value: 'value',\n      // actual dropdown value\n      text: 'text' // displayed text when selected\n\n    },\n    keys: {\n      backspace: 8,\n      delimiter: 188,\n      // comma\n      deleteKey: 46,\n      enter: 13,\n      escape: 27,\n      pageUp: 33,\n      pageDown: 34,\n      leftArrow: 37,\n      upArrow: 38,\n      rightArrow: 39,\n      downArrow: 40\n    },\n    selector: {\n      addition: '.addition',\n      dropdown: '.ui.dropdown',\n      hidden: '.hidden',\n      icon: '> .dropdown.icon',\n      input: '> input[type=\"hidden\"], > select',\n      item: '.item',\n      label: '> .label',\n      remove: '> .label > .delete.icon',\n      siblingLabel: '.label',\n      menu: '.menu',\n      message: '.message',\n      menuIcon: '.dropdown.icon',\n      search: 'input.search, .menu > .search > input, .menu input.search',\n      sizer: '> input.sizer',\n      text: '> .text:not(.icon)',\n      unselectable: '.disabled, .filtered'\n    },\n    className: {\n      active: 'active',\n      addition: 'addition',\n      animating: 'animating',\n      disabled: 'disabled',\n      empty: 'empty',\n      dropdown: 'ui dropdown',\n      filtered: 'filtered',\n      hidden: 'hidden transition',\n      item: 'item',\n      label: 'ui label',\n      loading: 'loading',\n      menu: 'menu',\n      message: 'message',\n      multiple: 'multiple',\n      placeholder: 'default',\n      sizer: 'sizer',\n      search: 'search',\n      selected: 'selected',\n      selection: 'selection',\n      upward: 'upward',\n      leftward: 'left',\n      visible: 'visible'\n    }\n  };\n  /* Templates */\n\n  $.fn.dropdown.settings.templates = {\n    // generates dropdown from select values\n    dropdown: function (select) {\n      var placeholder = select.placeholder || false,\n          values = select.values || {},\n          html = '';\n      html += '<i class=\"dropdown icon\"></i>';\n\n      if (select.placeholder) {\n        html += '<div class=\"default text\">' + placeholder + '</div>';\n      } else {\n        html += '<div class=\"text\"></div>';\n      }\n\n      html += '<div class=\"menu\">';\n      $.each(select.values, function (index, option) {\n        html += option.disabled ? '<div class=\"disabled item\" data-value=\"' + option.value + '\">' + option.name + '</div>' : '<div class=\"item\" data-value=\"' + option.value + '\">' + option.name + '</div>';\n      });\n      html += '</div>';\n      return html;\n    },\n    // generates just menu from select\n    menu: function (response, fields) {\n      var values = response[fields.values] || {},\n          html = '';\n      $.each(values, function (index, option) {\n        var maybeText = option[fields.text] ? 'data-text=\"' + option[fields.text] + '\"' : '',\n            maybeDisabled = option[fields.disabled] ? 'disabled ' : '';\n        html += '<div class=\"' + maybeDisabled + 'item\" data-value=\"' + option[fields.value] + '\"' + maybeText + '>';\n        html += option[fields.name];\n        html += '</div>';\n      });\n      return html;\n    },\n    // generates label for multiselect\n    label: function (value, text) {\n      return text + '<i class=\"delete icon\"></i>';\n    },\n    // generates messages like \"No results\"\n    message: function (message) {\n      return message;\n    },\n    // generates user addition to selection menu\n    addition: function (choice) {\n      return choice;\n    }\n  };\n})(jQuery, window, document);","map":{"version":3,"sources":["semantic/src/definitions/modules/dropdown.js"],"names":["$","window","document","undefined","Math","self","Function","fn","dropdown","parameters","$allModules","$document","moduleSelector","selector","hasTouch","documentElement","time","Date","getTime","performance","query","arguments","methodInvoked","queryArguments","slice","call","returnedValue","each","elementIndex","settings","isPlainObject","extend","className","message","fields","keys","metadata","namespace","regExp","error","templates","eventNamespace","moduleNamespace","$module","$context","context","$text","find","text","$search","search","$sizer","sizer","$input","input","$icon","icon","$combo","prev","length","$menu","children","menu","$item","item","activated","itemActivated","internalChange","element","instance","data","initialLoad","pageLostFocus","willRefocus","elementNamespace","id","selectObserver","menuObserver","module","initialize","debug","is","alreadySetup","setup","reference","layout","values","change","refreshData","save","defaults","restore","selected","create","bind","events","observeChanges","instantiate","verbose","destroy","remove","tabbable","off","removeData","disconnect","MutationObserver","event","select","mutation","observe","has","childList","subtree","random","toString","substr","userChoice","$userChoices","$userChoice","isUserValue","html","get","userValues","isArray","index","value","addition","add","variables","addResult","attr","addClass","hideAdditions","hidden","userLabels","label","appendTo","insertAfter","minCharacters","filter","hide","firstUnfiltered","selectedItem","not","unselectable","eq","nextAvailable","$selected","$nextAvailable","nextAll","$prevAvailable","prevAll","hasNext","api","apiSettings","urlData","on","returnedObject","prop","insertBefore","multiple","searchSelection","allowTab","set","selectValues","parent","closest","selection","hasClass","missingMultiple","disabled","removeAttr","detach","prependTo","refresh","$firstModules","$lastModules","refreshSelectors","refreshItems","clearData","defaultText","defaultValue","placeholderText","toggle","active","show","callback","isFunction","can","remote","queryRemote","maxSelections","allResultsFiltered","allFiltered","onShow","animate","click","intent","menuSearch","focusSearch","visible","animatingOutward","onHide","hideOthers","hideMenu","transition","hideSubMenus","$subMenus","touchEvents","keyboardEvents","inputEvents","mouseEvents","single","test","mouseenter","keydown","inputEvent","mousedown","mouseup","focus","blur","delay","mouseleave","touch","unbind","searchTerm","afterFiltered","filterActive","activeItem","onNoResults","allowAdditions","empty","noResults","userSuggestion","focusedOnSearch","useLabels","useAPI","filterRemoteData","filterItems","noAPI","errorDuration","cache","throttle","onError","serverError","onFailure","onSuccess","response","remoteValues","hasRemoteValues","results","escapedTerm","escape","string","beginsWithRegExp","RegExp","$choice","match","String","choiceText","push","fullTextSearch","exactSearch","fuzzySearch","choiceValue","filteredItem","filtered","term","termLength","queryLength","toLowerCase","characterIndex","nextCharacterIndex","queryCharacter","charCodeAt","indexOf","skipHandler","forceSelection","$currentlySelected","$activeItem","$selectedItem","hasSelected","clear","showOnFocus","activeElement","activeLabel","$target","target","clearTimeout","timer","setTimeout","$label","$labels","$activeLabels","$nextActive","$prevActive","$range","nextUntil","prevUntil","shiftKey","removeClass","ctrlKey","toggleClass","onLabelSelect","apply","activeLabels","toggleBehavior","bubbledLabelClick","bubbledIconClick","determine","eventOnElement","preventDefault","type","stopPropagation","eventInModule","mutations","isSelectMutation","addedNodes","$addedNode","$removedNode","removedNodes","$changedNodes","isUserAddition","isMessage","$subMenu","$otherMenus","siblings","hasSubMenu","isBubbledEvent","itemTimer","skipRefocus","allowCategorySelection","userAddition","scrollPosition","selectAction","pressedKey","which","isShortcutKey","inObject","$activeLabel","activeValue","labelIndex","labelCount","hasActiveLabel","hasMultipleActive","isFirstLabel","isLastLabel","isSearch","isFocusedOnSearch","isFocused","focused","caretAtStart","caretPosition","$nextLabel","leftArrow","last","siblingLabel","end","rightArrow","first","next","deleteKey","backspace","$visibleItems","addBack","$parentMenu","inVisibleMenu","animating","hasSelectedItem","selectedIsSelectable","delimiterPressed","delimiter","isAdditionWithoutMenu","enter","$nextItem","isSubMenuItem","newIndex","upArrow","selectOnKeydown","downArrow","pageUp","scrollPage","pageDown","selectedLetter","fromCharCode","trigger","createEvent","inputElement","initEvent","dispatchEvent","action","inDocument","inModule","inVisibleDOM","body","contains","notOnLabel","notInMenu","nothing","activate","hideAndClear","combo","placeholder","trim","val","searchWidth","ceil","width","selectionCount","count","upward","grep","uniqueArray","array","inArray","range","rangeLength","selectionStart","createRange","moveStart","isEmptyMultiselect","selectInput","split","name","read","remoteData","preserveHTML","clone","menuIcon","oninput","onpropertychange","$option","sortSelect","sort","a","b","itemWithAdditions","$items","$userItems","hasUserItems","strict","shouldSearch","isMultiple","optionText","optionValue","check","labels","saveRemoteData","Storage","noStorage","sessionStorage","getItem","setItem","clearValue","direction","$currentItem","menuHeight","outerHeight","currentScroll","scrollTop","itemHeight","itemsPerPage","floor","maxScroll","newScroll","$selectableItem","isWithinRange","$nextSelectedItem","isSearchMultiple","searchValue","hasSearchValue","valueIsSet","glyphWidth","css","loading","partialSearch","forceScroll","edgeTolerance","hasActive","offset","itemOffset","menuOffset","menuScroll","abovePage","belowPage","position","top","height","searchText","letter","alreadySelectedLetter","firstLetter","$nextValue","openDownward","leftward","openRightward","$currentMenu","$element","escapedValue","hasInput","currentValue","stringValue","newValue","allowReselection","extendSelect","fireOnInit","onChange","exactly","$userSelectedItem","selectedText","selectedValue","isFiltered","isActive","shouldAnimate","$next","ignoreCase","onLabelCreate","variation","duration","$message","hasOption","$addition","$existingItem","alreadyHasValue","hasUserSuggestion","hasCount","hasMaxCount","hasTerm","replace","addedValue","addedText","concat","join","onAdd","removedValue","removedText","$removedItem","arrayValue","onRemove","$removedLabel","userValue","onLabelRemove","charAt","items","$normalResults","valueIgnoringCase","valueMatchingCase","hasValue","existingValue","animatingInward","$selectedMenu","needle","object","found","property","selectMutation","selectChanged","verticallyScrollableContext","overflowY","horizontallyScrollableContext","overflowX","canOpenDownward","onScreen","calculations","left","above","below","canOpenRightward","isOffscreenRight","scrollLeft","outerWidth","start","animation","queue","onStart","onComplete","noTransition","multipleValues","isUnparsable","hasQuotes","quote","setting","internal","silent","log","prototype","console","info","currentTime","executionTime","previousTime","display","title","totalTime","group","table","groupCollapsed","groupEnd","invoke","passedArguments","maxDepth","depth","camelCaseValue","toUpperCase","method","keepOnScreen","$selectedLabels","option","maybeText","maybeDisabled","choice","jQuery"],"mappings":"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","sourcesContent":["/*!\n * # Semantic UI - Dropdown\n * http://github.com/semantic-org/semantic-ui/\n *\n *\n * Released under the MIT license\n * http://opensource.org/licenses/MIT\n *\n */\n\n;(function ($, window, document, undefined) {\n\n'use strict';\n\nwindow = (typeof window != 'undefined' && window.Math == Math)\n  ? window\n  : (typeof self != 'undefined' && self.Math == Math)\n    ? self\n    : Function('return this')()\n;\n\n$.fn.dropdown = function(parameters) {\n  var\n    $allModules    = $(this),\n    $document      = $(document),\n\n    moduleSelector = $allModules.selector || '',\n\n    hasTouch       = ('ontouchstart' in document.documentElement),\n    time           = new Date().getTime(),\n    performance    = [],\n\n    query          = arguments[0],\n    methodInvoked  = (typeof query == 'string'),\n    queryArguments = [].slice.call(arguments, 1),\n    returnedValue\n  ;\n\n  $allModules\n    .each(function(elementIndex) {\n      var\n        settings          = ( $.isPlainObject(parameters) )\n          ? $.extend(true, {}, $.fn.dropdown.settings, parameters)\n          : $.extend({}, $.fn.dropdown.settings),\n\n        className       = settings.className,\n        message         = settings.message,\n        fields          = settings.fields,\n        keys            = settings.keys,\n        metadata        = settings.metadata,\n        namespace       = settings.namespace,\n        regExp          = settings.regExp,\n        selector        = settings.selector,\n        error           = settings.error,\n        templates       = settings.templates,\n\n        eventNamespace  = '.' + namespace,\n        moduleNamespace = 'module-' + namespace,\n\n        $module         = $(this),\n        $context        = $(settings.context),\n        $text           = $module.find(selector.text),\n        $search         = $module.find(selector.search),\n        $sizer          = $module.find(selector.sizer),\n        $input          = $module.find(selector.input),\n        $icon           = $module.find(selector.icon),\n\n        $combo = ($module.prev().find(selector.text).length > 0)\n          ? $module.prev().find(selector.text)\n          : $module.prev(),\n\n        $menu           = $module.children(selector.menu),\n        $item           = $menu.find(selector.item),\n\n        activated       = false,\n        itemActivated   = false,\n        internalChange  = false,\n        element         = this,\n        instance        = $module.data(moduleNamespace),\n\n        initialLoad,\n        pageLostFocus,\n        willRefocus,\n        elementNamespace,\n        id,\n        selectObserver,\n        menuObserver,\n        module\n      ;\n\n      module = {\n\n        initialize: function() {\n          module.debug('Initializing dropdown', settings);\n\n          if( module.is.alreadySetup() ) {\n            module.setup.reference();\n          }\n          else {\n\n            module.setup.layout();\n\n            if(settings.values) {\n              module.change.values(settings.values);\n            }\n\n            module.refreshData();\n\n            module.save.defaults();\n            module.restore.selected();\n\n            module.create.id();\n            module.bind.events();\n\n            module.observeChanges();\n            module.instantiate();\n          }\n\n        },\n\n        instantiate: function() {\n          module.verbose('Storing instance of dropdown', module);\n          instance = module;\n          $module\n            .data(moduleNamespace, module)\n          ;\n        },\n\n        destroy: function() {\n          module.verbose('Destroying previous dropdown', $module);\n          module.remove.tabbable();\n          $module\n            .off(eventNamespace)\n            .removeData(moduleNamespace)\n          ;\n          $menu\n            .off(eventNamespace)\n          ;\n          $document\n            .off(elementNamespace)\n          ;\n          module.disconnect.menuObserver();\n          module.disconnect.selectObserver();\n        },\n\n        observeChanges: function() {\n          if('MutationObserver' in window) {\n            selectObserver = new MutationObserver(module.event.select.mutation);\n            menuObserver   = new MutationObserver(module.event.menu.mutation);\n            module.debug('Setting up mutation observer', selectObserver, menuObserver);\n            module.observe.select();\n            module.observe.menu();\n          }\n        },\n\n        disconnect: {\n          menuObserver: function() {\n            if(menuObserver) {\n              menuObserver.disconnect();\n            }\n          },\n          selectObserver: function() {\n            if(selectObserver) {\n              selectObserver.disconnect();\n            }\n          }\n        },\n        observe: {\n          select: function() {\n            if(module.has.input()) {\n              selectObserver.observe($module[0], {\n                childList : true,\n                subtree   : true\n              });\n            }\n          },\n          menu: function() {\n            if(module.has.menu()) {\n              menuObserver.observe($menu[0], {\n                childList : true,\n                subtree   : true\n              });\n            }\n          }\n        },\n\n        create: {\n          id: function() {\n            id = (Math.random().toString(16) + '000000000').substr(2, 8);\n            elementNamespace = '.' + id;\n            module.verbose('Creating unique id for element', id);\n          },\n          userChoice: function(values) {\n            var\n              $userChoices,\n              $userChoice,\n              isUserValue,\n              html\n            ;\n            values = values || module.get.userValues();\n            if(!values) {\n              return false;\n            }\n            values = $.isArray(values)\n              ? values\n              : [values]\n            ;\n            $.each(values, function(index, value) {\n              if(module.get.item(value) === false) {\n                html         = settings.templates.addition( module.add.variables(message.addResult, value) );\n                $userChoice  = $('<div />')\n                  .html(html)\n                  .attr('data-' + metadata.value, value)\n                  .attr('data-' + metadata.text, value)\n                  .addClass(className.addition)\n                  .addClass(className.item)\n                ;\n                if(settings.hideAdditions) {\n                  $userChoice.addClass(className.hidden);\n                }\n                $userChoices = ($userChoices === undefined)\n                  ? $userChoice\n                  : $userChoices.add($userChoice)\n                ;\n                module.verbose('Creating user choices for value', value, $userChoice);\n              }\n            });\n            return $userChoices;\n          },\n          userLabels: function(value) {\n            var\n              userValues = module.get.userValues()\n            ;\n            if(userValues) {\n              module.debug('Adding user labels', userValues);\n              $.each(userValues, function(index, value) {\n                module.verbose('Adding custom user value');\n                module.add.label(value, value);\n              });\n            }\n          },\n          menu: function() {\n            $menu = $('<div />')\n              .addClass(className.menu)\n              .appendTo($module)\n            ;\n          },\n          sizer: function() {\n            $sizer = $('<span />')\n              .addClass(className.sizer)\n              .insertAfter($search)\n            ;\n          }\n        },\n\n        search: function(query) {\n          query = (query !== undefined)\n            ? query\n            : module.get.query()\n          ;\n          module.verbose('Searching for query', query);\n          if(module.has.minCharacters(query)) {\n            module.filter(query);\n          }\n          else {\n            module.hide();\n          }\n        },\n\n        select: {\n          firstUnfiltered: function() {\n            module.verbose('Selecting first non-filtered element');\n            module.remove.selectedItem();\n            $item\n              .not(selector.unselectable)\n              .not(selector.addition + selector.hidden)\n                .eq(0)\n                .addClass(className.selected)\n            ;\n          },\n          nextAvailable: function($selected) {\n            $selected = $selected.eq(0);\n            var\n              $nextAvailable = $selected.nextAll(selector.item).not(selector.unselectable).eq(0),\n              $prevAvailable = $selected.prevAll(selector.item).not(selector.unselectable).eq(0),\n              hasNext        = ($nextAvailable.length > 0)\n            ;\n            if(hasNext) {\n              module.verbose('Moving selection to', $nextAvailable);\n              $nextAvailable.addClass(className.selected);\n            }\n            else {\n              module.verbose('Moving selection to', $prevAvailable);\n              $prevAvailable.addClass(className.selected);\n            }\n          }\n        },\n\n        setup: {\n          api: function() {\n            var\n              apiSettings = {\n                debug   : settings.debug,\n                urlData : {\n                  value : module.get.value(),\n                  query : module.get.query()\n                },\n                on    : false\n              }\n            ;\n            module.verbose('First request, initializing API');\n            $module\n              .api(apiSettings)\n            ;\n          },\n          layout: function() {\n            if( $module.is('select') ) {\n              module.setup.select();\n              module.setup.returnedObject();\n            }\n            if( !module.has.menu() ) {\n              module.create.menu();\n            }\n            if( module.is.search() && !module.has.search() ) {\n              module.verbose('Adding search input');\n              $search = $('<input />')\n                .addClass(className.search)\n                .prop('autocomplete', 'off')\n                .insertBefore($text)\n              ;\n            }\n            if( module.is.multiple() && module.is.searchSelection() && !module.has.sizer()) {\n              module.create.sizer();\n            }\n            if(settings.allowTab) {\n              module.set.tabbable();\n            }\n          },\n          select: function() {\n            var\n              selectValues  = module.get.selectValues()\n            ;\n            module.debug('Dropdown initialized on a select', selectValues);\n            if( $module.is('select') ) {\n              $input = $module;\n            }\n            // see if select is placed correctly already\n            if($input.parent(selector.dropdown).length > 0) {\n              module.debug('UI dropdown already exists. Creating dropdown menu only');\n              $module = $input.closest(selector.dropdown);\n              if( !module.has.menu() ) {\n                module.create.menu();\n              }\n              $menu = $module.children(selector.menu);\n              module.setup.menu(selectValues);\n            }\n            else {\n              module.debug('Creating entire dropdown from select');\n              $module = $('<div />')\n                .attr('class', $input.attr('class') )\n                .addClass(className.selection)\n                .addClass(className.dropdown)\n                .html( templates.dropdown(selectValues) )\n                .insertBefore($input)\n              ;\n              if($input.hasClass(className.multiple) && $input.prop('multiple') === false) {\n                module.error(error.missingMultiple);\n                $input.prop('multiple', true);\n              }\n              if($input.is('[multiple]')) {\n                module.set.multiple();\n              }\n              if ($input.prop('disabled')) {\n                module.debug('Disabling dropdown');\n                $module.addClass(className.disabled);\n              }\n              $input\n                .removeAttr('class')\n                .detach()\n                .prependTo($module)\n              ;\n            }\n            module.refresh();\n          },\n          menu: function(values) {\n            $menu.html( templates.menu(values, fields));\n            $item = $menu.find(selector.item);\n          },\n          reference: function() {\n            module.debug('Dropdown behavior was called on select, replacing with closest dropdown');\n            // replace module reference\n            $module  = $module.parent(selector.dropdown);\n            instance = $module.data(moduleNamespace);\n            element  = $module.get(0);\n            module.refresh();\n            module.setup.returnedObject();\n          },\n          returnedObject: function() {\n            var\n              $firstModules = $allModules.slice(0, elementIndex),\n              $lastModules  = $allModules.slice(elementIndex + 1)\n            ;\n            // adjust all modules to use correct reference\n            $allModules = $firstModules.add($module).add($lastModules);\n          }\n        },\n\n        refresh: function() {\n          module.refreshSelectors();\n          module.refreshData();\n        },\n\n        refreshItems: function() {\n          $item = $menu.find(selector.item);\n        },\n\n        refreshSelectors: function() {\n          module.verbose('Refreshing selector cache');\n          $text   = $module.find(selector.text);\n          $search = $module.find(selector.search);\n          $input  = $module.find(selector.input);\n          $icon   = $module.find(selector.icon);\n          $combo  = ($module.prev().find(selector.text).length > 0)\n            ? $module.prev().find(selector.text)\n            : $module.prev()\n          ;\n          $menu    = $module.children(selector.menu);\n          $item    = $menu.find(selector.item);\n        },\n\n        refreshData: function() {\n          module.verbose('Refreshing cached metadata');\n          $item\n            .removeData(metadata.text)\n            .removeData(metadata.value)\n          ;\n        },\n\n        clearData: function() {\n          module.verbose('Clearing metadata');\n          $item\n            .removeData(metadata.text)\n            .removeData(metadata.value)\n          ;\n          $module\n            .removeData(metadata.defaultText)\n            .removeData(metadata.defaultValue)\n            .removeData(metadata.placeholderText)\n          ;\n        },\n\n        toggle: function() {\n          module.verbose('Toggling menu visibility');\n          if( !module.is.active() ) {\n            module.show();\n          }\n          else {\n            module.hide();\n          }\n        },\n\n        show: function(callback) {\n          callback = $.isFunction(callback)\n            ? callback\n            : function(){}\n          ;\n          if(!module.can.show() && module.is.remote()) {\n            module.debug('No API results retrieved, searching before show');\n            module.queryRemote(module.get.query(), module.show);\n          }\n          if( module.can.show() && !module.is.active() ) {\n            module.debug('Showing dropdown');\n            if(module.has.message() && !(module.has.maxSelections() || module.has.allResultsFiltered()) ) {\n              module.remove.message();\n            }\n            if(module.is.allFiltered()) {\n              return true;\n            }\n            if(settings.onShow.call(element) !== false) {\n              module.animate.show(function() {\n                if( module.can.click() ) {\n                  module.bind.intent();\n                }\n                if(module.has.menuSearch()) {\n                  module.focusSearch();\n                }\n                module.set.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n\n        hide: function(callback) {\n          callback = $.isFunction(callback)\n            ? callback\n            : function(){}\n          ;\n          if( module.is.active() && !module.is.animatingOutward() ) {\n            module.debug('Hiding dropdown');\n            if(settings.onHide.call(element) !== false) {\n              module.animate.hide(function() {\n                module.remove.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n\n        hideOthers: function() {\n          module.verbose('Finding other dropdowns to hide');\n          $allModules\n            .not($module)\n              .has(selector.menu + '.' + className.visible)\n                .dropdown('hide')\n          ;\n        },\n\n        hideMenu: function() {\n          module.verbose('Hiding menu  instantaneously');\n          module.remove.active();\n          module.remove.visible();\n          $menu.transition('hide');\n        },\n\n        hideSubMenus: function() {\n          var\n            $subMenus = $menu.children(selector.item).find(selector.menu)\n          ;\n          module.verbose('Hiding sub menus', $subMenus);\n          $subMenus.transition('hide');\n        },\n\n        bind: {\n          events: function() {\n            if(hasTouch) {\n              module.bind.touchEvents();\n            }\n            module.bind.keyboardEvents();\n            module.bind.inputEvents();\n            module.bind.mouseEvents();\n          },\n          touchEvents: function() {\n            module.debug('Touch device detected binding additional touch events');\n            if( module.is.searchSelection() ) {\n              // do nothing special yet\n            }\n            else if( module.is.single() ) {\n              $module\n                .on('touchstart' + eventNamespace, module.event.test.toggle)\n              ;\n            }\n            $menu\n              .on('touchstart' + eventNamespace, selector.item, module.event.item.mouseenter)\n            ;\n          },\n          keyboardEvents: function() {\n            module.verbose('Binding keyboard events');\n            $module\n              .on('keydown' + eventNamespace, module.event.keydown)\n            ;\n            if( module.has.search() ) {\n              $module\n                .on(module.get.inputEvent() + eventNamespace, selector.search, module.event.input)\n              ;\n            }\n            if( module.is.multiple() ) {\n              $document\n                .on('keydown' + elementNamespace, module.event.document.keydown)\n              ;\n            }\n          },\n          inputEvents: function() {\n            module.verbose('Binding input change events');\n            $module\n              .on('change' + eventNamespace, selector.input, module.event.change)\n            ;\n          },\n          mouseEvents: function() {\n            module.verbose('Binding mouse events');\n            if(module.is.multiple()) {\n              $module\n                .on('click'   + eventNamespace, selector.label,  module.event.label.click)\n                .on('click'   + eventNamespace, selector.remove, module.event.remove.click)\n              ;\n            }\n            if( module.is.searchSelection() ) {\n              $module\n                .on('mousedown' + eventNamespace, module.event.mousedown)\n                .on('mouseup'   + eventNamespace, module.event.mouseup)\n                .on('mousedown' + eventNamespace, selector.menu,   module.event.menu.mousedown)\n                .on('mouseup'   + eventNamespace, selector.menu,   module.event.menu.mouseup)\n                .on('click'     + eventNamespace, selector.icon,   module.event.icon.click)\n                .on('focus'     + eventNamespace, selector.search, module.event.search.focus)\n                .on('click'     + eventNamespace, selector.search, module.event.search.focus)\n                .on('blur'      + eventNamespace, selector.search, module.event.search.blur)\n                .on('click'     + eventNamespace, selector.text,   module.event.text.focus)\n              ;\n              if(module.is.multiple()) {\n                $module\n                  .on('click' + eventNamespace, module.event.click)\n                ;\n              }\n            }\n            else {\n              if(settings.on == 'click') {\n                $module\n                  .on('click' + eventNamespace, selector.icon, module.event.icon.click)\n                  .on('click' + eventNamespace, module.event.test.toggle)\n                ;\n              }\n              else if(settings.on == 'hover') {\n                $module\n                  .on('mouseenter' + eventNamespace, module.delay.show)\n                  .on('mouseleave' + eventNamespace, module.delay.hide)\n                ;\n              }\n              else {\n                $module\n                  .on(settings.on + eventNamespace, module.toggle)\n                ;\n              }\n              $module\n                .on('mousedown' + eventNamespace, module.event.mousedown)\n                .on('mouseup'   + eventNamespace, module.event.mouseup)\n                .on('focus'     + eventNamespace, module.event.focus)\n              ;\n              if(module.has.menuSearch() ) {\n                $module\n                  .on('blur' + eventNamespace, selector.search, module.event.search.blur)\n                ;\n              }\n              else {\n                $module\n                  .on('blur' + eventNamespace, module.event.blur)\n                ;\n              }\n            }\n            $menu\n              .on('mouseenter' + eventNamespace, selector.item, module.event.item.mouseenter)\n              .on('mouseleave' + eventNamespace, selector.item, module.event.item.mouseleave)\n              .on('click'      + eventNamespace, selector.item, module.event.item.click)\n            ;\n          },\n          intent: function() {\n            module.verbose('Binding hide intent event to document');\n            if(hasTouch) {\n              $document\n                .on('touchstart' + elementNamespace, module.event.test.touch)\n                .on('touchmove'  + elementNamespace, module.event.test.touch)\n              ;\n            }\n            $document\n              .on('click' + elementNamespace, module.event.test.hide)\n            ;\n          }\n        },\n\n        unbind: {\n          intent: function() {\n            module.verbose('Removing hide intent event from document');\n            if(hasTouch) {\n              $document\n                .off('touchstart' + elementNamespace)\n                .off('touchmove' + elementNamespace)\n              ;\n            }\n            $document\n              .off('click' + elementNamespace)\n            ;\n          }\n        },\n\n        filter: function(query) {\n          var\n            searchTerm = (query !== undefined)\n              ? query\n              : module.get.query(),\n            afterFiltered = function() {\n              if(module.is.multiple()) {\n                module.filterActive();\n              }\n              if(query || (!query && module.get.activeItem().length == 0)) {\n                module.select.firstUnfiltered();\n              }\n              if( module.has.allResultsFiltered() ) {\n                if( settings.onNoResults.call(element, searchTerm) ) {\n                  if(settings.allowAdditions) {\n                    if(settings.hideAdditions) {\n                      module.verbose('User addition with no menu, setting empty style');\n                      module.set.empty();\n                      module.hideMenu();\n                    }\n                  }\n                  else {\n                    module.verbose('All items filtered, showing message', searchTerm);\n                    module.add.message(message.noResults);\n                  }\n                }\n                else {\n                  module.verbose('All items filtered, hiding dropdown', searchTerm);\n                  module.hideMenu();\n                }\n              }\n              else {\n                module.remove.empty();\n                module.remove.message();\n              }\n              if(settings.allowAdditions) {\n                module.add.userSuggestion(query);\n              }\n              if(module.is.searchSelection() && module.can.show() && module.is.focusedOnSearch() ) {\n                module.show();\n              }\n            }\n          ;\n          if(settings.useLabels && module.has.maxSelections()) {\n            return;\n          }\n          if(settings.apiSettings) {\n            if( module.can.useAPI() ) {\n              module.queryRemote(searchTerm, function() {\n                if(settings.filterRemoteData) {\n                  module.filterItems(searchTerm);\n                }\n                afterFiltered();\n              });\n            }\n            else {\n              module.error(error.noAPI);\n            }\n          }\n          else {\n            module.filterItems(searchTerm);\n            afterFiltered();\n          }\n        },\n\n        queryRemote: function(query, callback) {\n          var\n            apiSettings = {\n              errorDuration : false,\n              cache         : 'local',\n              throttle      : settings.throttle,\n              urlData       : {\n                query: query\n              },\n              onError: function() {\n                module.add.message(message.serverError);\n                callback();\n              },\n              onFailure: function() {\n                module.add.message(message.serverError);\n                callback();\n              },\n              onSuccess : function(response) {\n                var\n                  values          = response[fields.remoteValues],\n                  hasRemoteValues = ($.isArray(values) && values.length > 0)\n                ;\n                if(hasRemoteValues) {\n                  module.remove.message();\n                  module.setup.menu({\n                    values: response[fields.remoteValues]\n                  });\n                }\n                else {\n                  module.add.message(message.noResults);\n                }\n                callback();\n              }\n            }\n          ;\n          if( !$module.api('get request') ) {\n            module.setup.api();\n          }\n          apiSettings = $.extend(true, {}, apiSettings, settings.apiSettings);\n          $module\n            .api('setting', apiSettings)\n            .api('query')\n          ;\n        },\n\n        filterItems: function(query) {\n          var\n            searchTerm = (query !== undefined)\n              ? query\n              : module.get.query(),\n            results          =  null,\n            escapedTerm      = module.escape.string(searchTerm),\n            beginsWithRegExp = new RegExp('^' + escapedTerm, 'igm')\n          ;\n          // avoid loop if we're matching nothing\n          if( module.has.query() ) {\n            results = [];\n\n            module.verbose('Searching for matching values', searchTerm);\n            $item\n              .each(function(){\n                var\n                  $choice = $(this),\n                  text,\n                  value\n                ;\n                if(settings.match == 'both' || settings.match == 'text') {\n                  text = String(module.get.choiceText($choice, false));\n                  if(text.search(beginsWithRegExp) !== -1) {\n                    results.push(this);\n                    return true;\n                  }\n                  else if (settings.fullTextSearch === 'exact' && module.exactSearch(searchTerm, text)) {\n                    results.push(this);\n                    return true;\n                  }\n                  else if (settings.fullTextSearch === true && module.fuzzySearch(searchTerm, text)) {\n                    results.push(this);\n                    return true;\n                  }\n                }\n                if(settings.match == 'both' || settings.match == 'value') {\n                  value = String(module.get.choiceValue($choice, text));\n                  if(value.search(beginsWithRegExp) !== -1) {\n                    results.push(this);\n                    return true;\n                  }\n                  else if (settings.fullTextSearch === 'exact' && module.exactSearch(searchTerm, value)) {\n                    results.push(this);\n                    return true;\n                  }\n                  else if (settings.fullTextSearch === true && module.fuzzySearch(searchTerm, value)) {\n                    results.push(this);\n                    return true;\n                  }\n                }\n              })\n            ;\n          }\n          module.debug('Showing only matched items', searchTerm);\n          module.remove.filteredItem();\n          if(results) {\n            $item\n              .not(results)\n              .addClass(className.filtered)\n            ;\n          }\n        },\n\n        fuzzySearch: function(query, term) {\n          var\n            termLength  = term.length,\n            queryLength = query.length\n          ;\n          query = query.toLowerCase();\n          term  = term.toLowerCase();\n          if(queryLength > termLength) {\n            return false;\n          }\n          if(queryLength === termLength) {\n            return (query === term);\n          }\n          search: for (var characterIndex = 0, nextCharacterIndex = 0; characterIndex < queryLength; characterIndex++) {\n            var\n              queryCharacter = query.charCodeAt(characterIndex)\n            ;\n            while(nextCharacterIndex < termLength) {\n              if(term.charCodeAt(nextCharacterIndex++) === queryCharacter) {\n                continue search;\n              }\n            }\n            return false;\n          }\n          return true;\n        },\n        exactSearch: function (query, term) {\n          query = query.toLowerCase();\n          term  = term.toLowerCase();\n          if(term.indexOf(query) > -1) {\n             return true;\n          }\n          return false;\n        },\n        filterActive: function() {\n          if(settings.useLabels) {\n            $item.filter('.' + className.active)\n              .addClass(className.filtered)\n            ;\n          }\n        },\n\n        focusSearch: function(skipHandler) {\n          if( module.has.search() && !module.is.focusedOnSearch() ) {\n            if(skipHandler) {\n              $module.off('focus' + eventNamespace, selector.search);\n              $search.focus();\n              $module.on('focus'  + eventNamespace, selector.search, module.event.search.focus);\n            }\n            else {\n              $search.focus();\n            }\n          }\n        },\n\n        forceSelection: function() {\n          var\n            $currentlySelected = $item.not(className.filtered).filter('.' + className.selected).eq(0),\n            $activeItem        = $item.not(className.filtered).filter('.' + className.active).eq(0),\n            $selectedItem      = ($currentlySelected.length > 0)\n              ? $currentlySelected\n              : $activeItem,\n            hasSelected = ($selectedItem.length > 0)\n          ;\n          if(hasSelected && !module.is.multiple()) {\n            module.debug('Forcing partial selection to selected item', $selectedItem);\n            module.event.item.click.call($selectedItem, {}, true);\n            return;\n          }\n          else {\n            if(settings.allowAdditions) {\n              module.set.selected(module.get.query());\n              module.remove.searchTerm();\n            }\n            else {\n              module.remove.searchTerm();\n            }\n          }\n        },\n\n        change: {\n          values: function(values) {\n            if(!settings.allowAdditions) {\n              module.clear();\n            }\n            module.debug('Creating dropdown with specified values', values);\n            module.setup.menu({values: values});\n            $.each(values, function(index, item) {\n              if(item.selected == true) {\n                module.debug('Setting initial selection to', item.value);\n                module.set.selected(item.value);\n                return true;\n              }\n            });\n          }\n        },\n\n        event: {\n          change: function() {\n            if(!internalChange) {\n              module.debug('Input changed, updating selection');\n              module.set.selected();\n            }\n          },\n          focus: function() {\n            if(settings.showOnFocus && !activated && module.is.hidden() && !pageLostFocus) {\n              module.show();\n            }\n          },\n          blur: function(event) {\n            pageLostFocus = (document.activeElement === this);\n            if(!activated && !pageLostFocus) {\n              module.remove.activeLabel();\n              module.hide();\n            }\n          },\n          mousedown: function() {\n            if(module.is.searchSelection()) {\n              // prevent menu hiding on immediate re-focus\n              willRefocus = true;\n            }\n            else {\n              // prevents focus callback from occurring on mousedown\n              activated = true;\n            }\n          },\n          mouseup: function() {\n            if(module.is.searchSelection()) {\n              // prevent menu hiding on immediate re-focus\n              willRefocus = false;\n            }\n            else {\n              activated = false;\n            }\n          },\n          click: function(event) {\n            var\n              $target = $(event.target)\n            ;\n            // focus search\n            if($target.is($module)) {\n              if(!module.is.focusedOnSearch()) {\n                module.focusSearch();\n              }\n              else {\n                module.show();\n              }\n            }\n          },\n          search: {\n            focus: function() {\n              activated = true;\n              if(module.is.multiple()) {\n                module.remove.activeLabel();\n              }\n              if(settings.showOnFocus) {\n                module.search();\n              }\n            },\n            blur: function(event) {\n              pageLostFocus = (document.activeElement === this);\n              if(module.is.searchSelection() && !willRefocus) {\n                if(!itemActivated && !pageLostFocus) {\n                  if(settings.forceSelection) {\n                    module.forceSelection();\n                  }\n                  module.hide();\n                }\n              }\n              willRefocus = false;\n            }\n          },\n          icon: {\n            click: function(event) {\n              module.toggle();\n            }\n          },\n          text: {\n            focus: function(event) {\n              activated = true;\n              module.focusSearch();\n            }\n          },\n          input: function(event) {\n            if(module.is.multiple() || module.is.searchSelection()) {\n              module.set.filtered();\n            }\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.search, settings.delay.search);\n          },\n          label: {\n            click: function(event) {\n              var\n                $label        = $(this),\n                $labels       = $module.find(selector.label),\n                $activeLabels = $labels.filter('.' + className.active),\n                $nextActive   = $label.nextAll('.' + className.active),\n                $prevActive   = $label.prevAll('.' + className.active),\n                $range = ($nextActive.length > 0)\n                  ? $label.nextUntil($nextActive).add($activeLabels).add($label)\n                  : $label.prevUntil($prevActive).add($activeLabels).add($label)\n              ;\n              if(event.shiftKey) {\n                $activeLabels.removeClass(className.active);\n                $range.addClass(className.active);\n              }\n              else if(event.ctrlKey) {\n                $label.toggleClass(className.active);\n              }\n              else {\n                $activeLabels.removeClass(className.active);\n                $label.addClass(className.active);\n              }\n              settings.onLabelSelect.apply(this, $labels.filter('.' + className.active));\n            }\n          },\n          remove: {\n            click: function() {\n              var\n                $label = $(this).parent()\n              ;\n              if( $label.hasClass(className.active) ) {\n                // remove all selected labels\n                module.remove.activeLabels();\n              }\n              else {\n                // remove this label only\n                module.remove.activeLabels( $label );\n              }\n            }\n          },\n          test: {\n            toggle: function(event) {\n              var\n                toggleBehavior = (module.is.multiple())\n                  ? module.show\n                  : module.toggle\n              ;\n              if(module.is.bubbledLabelClick(event) || module.is.bubbledIconClick(event)) {\n                return;\n              }\n              if( module.determine.eventOnElement(event, toggleBehavior) ) {\n                event.preventDefault();\n              }\n            },\n            touch: function(event) {\n              module.determine.eventOnElement(event, function() {\n                if(event.type == 'touchstart') {\n                  module.timer = setTimeout(function() {\n                    module.hide();\n                  }, settings.delay.touch);\n                }\n                else if(event.type == 'touchmove') {\n                  clearTimeout(module.timer);\n                }\n              });\n              event.stopPropagation();\n            },\n            hide: function(event) {\n              module.determine.eventInModule(event, module.hide);\n            }\n          },\n          select: {\n            mutation: function(mutations) {\n              module.debug('<select> modified, recreating menu');\n              var\n                isSelectMutation = false\n              ;\n              $.each(mutations, function(index, mutation) {\n                if($(mutation.target).is('select') || $(mutation.addedNodes).is('select')) {\n                  isSelectMutation = true;\n                  return true;\n                }\n              });\n              if(isSelectMutation) {\n                module.disconnect.selectObserver();\n                module.refresh();\n                module.setup.select();\n                module.set.selected();\n                module.observe.select();\n              }\n            }\n          },\n          menu: {\n            mutation: function(mutations) {\n              var\n                mutation   = mutations[0],\n                $addedNode = mutation.addedNodes\n                  ? $(mutation.addedNodes[0])\n                  : $(false),\n                $removedNode = mutation.removedNodes\n                  ? $(mutation.removedNodes[0])\n                  : $(false),\n                $changedNodes  = $addedNode.add($removedNode),\n                isUserAddition = $changedNodes.is(selector.addition) || $changedNodes.closest(selector.addition).length > 0,\n                isMessage      = $changedNodes.is(selector.message)  || $changedNodes.closest(selector.message).length > 0\n              ;\n              if(isUserAddition || isMessage) {\n                module.debug('Updating item selector cache');\n                module.refreshItems();\n              }\n              else {\n                module.debug('Menu modified, updating selector cache');\n                module.refresh();\n              }\n            },\n            mousedown: function() {\n              itemActivated = true;\n            },\n            mouseup: function() {\n              itemActivated = false;\n            }\n          },\n          item: {\n            mouseenter: function(event) {\n              var\n                $target        = $(event.target),\n                $item          = $(this),\n                $subMenu       = $item.children(selector.menu),\n                $otherMenus    = $item.siblings(selector.item).children(selector.menu),\n                hasSubMenu     = ($subMenu.length > 0),\n                isBubbledEvent = ($subMenu.find($target).length > 0)\n              ;\n              if( !isBubbledEvent && hasSubMenu ) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function() {\n                  module.verbose('Showing sub-menu', $subMenu);\n                  $.each($otherMenus, function() {\n                    module.animate.hide(false, $(this));\n                  });\n                  module.animate.show(false, $subMenu);\n                }, settings.delay.show);\n                event.preventDefault();\n              }\n            },\n            mouseleave: function(event) {\n              var\n                $subMenu = $(this).children(selector.menu)\n              ;\n              if($subMenu.length > 0) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function() {\n                  module.verbose('Hiding sub-menu', $subMenu);\n                  module.animate.hide(false, $subMenu);\n                }, settings.delay.hide);\n              }\n            },\n            click: function (event, skipRefocus) {\n              var\n                $choice        = $(this),\n                $target        = (event)\n                  ? $(event.target)\n                  : $(''),\n                $subMenu       = $choice.find(selector.menu),\n                text           = module.get.choiceText($choice),\n                value          = module.get.choiceValue($choice, text),\n                hasSubMenu     = ($subMenu.length > 0),\n                isBubbledEvent = ($subMenu.find($target).length > 0)\n              ;\n              // prevents IE11 bug where menu receives focus even though `tabindex=-1`\n              if(module.has.menuSearch()) {\n                $(document.activeElement).blur();\n              }\n              if(!isBubbledEvent && (!hasSubMenu || settings.allowCategorySelection)) {\n                if(module.is.searchSelection()) {\n                  if(settings.allowAdditions) {\n                    module.remove.userAddition();\n                  }\n                  module.remove.searchTerm();\n                  if(!module.is.focusedOnSearch() && !(skipRefocus == true)) {\n                    module.focusSearch(true);\n                  }\n                }\n                if(!settings.useLabels) {\n                  module.remove.filteredItem();\n                  module.set.scrollPosition($choice);\n                }\n                module.determine.selectAction.call(this, text, value);\n              }\n            }\n          },\n\n          document: {\n            // label selection should occur even when element has no focus\n            keydown: function(event) {\n              var\n                pressedKey    = event.which,\n                isShortcutKey = module.is.inObject(pressedKey, keys)\n              ;\n              if(isShortcutKey) {\n                var\n                  $label            = $module.find(selector.label),\n                  $activeLabel      = $label.filter('.' + className.active),\n                  activeValue       = $activeLabel.data(metadata.value),\n                  labelIndex        = $label.index($activeLabel),\n                  labelCount        = $label.length,\n                  hasActiveLabel    = ($activeLabel.length > 0),\n                  hasMultipleActive = ($activeLabel.length > 1),\n                  isFirstLabel      = (labelIndex === 0),\n                  isLastLabel       = (labelIndex + 1 == labelCount),\n                  isSearch          = module.is.searchSelection(),\n                  isFocusedOnSearch = module.is.focusedOnSearch(),\n                  isFocused         = module.is.focused(),\n                  caretAtStart      = (isFocusedOnSearch && module.get.caretPosition() === 0),\n                  $nextLabel\n                ;\n                if(isSearch && !hasActiveLabel && !isFocusedOnSearch) {\n                  return;\n                }\n\n                if(pressedKey == keys.leftArrow) {\n                  // activate previous label\n                  if((isFocused || caretAtStart) && !hasActiveLabel) {\n                    module.verbose('Selecting previous label');\n                    $label.last().addClass(className.active);\n                  }\n                  else if(hasActiveLabel) {\n                    if(!event.shiftKey) {\n                      module.verbose('Selecting previous label');\n                      $label.removeClass(className.active);\n                    }\n                    else {\n                      module.verbose('Adding previous label to selection');\n                    }\n                    if(isFirstLabel && !hasMultipleActive) {\n                      $activeLabel.addClass(className.active);\n                    }\n                    else {\n                      $activeLabel.prev(selector.siblingLabel)\n                        .addClass(className.active)\n                        .end()\n                      ;\n                    }\n                    event.preventDefault();\n                  }\n                }\n                else if(pressedKey == keys.rightArrow) {\n                  // activate first label\n                  if(isFocused && !hasActiveLabel) {\n                    $label.first().addClass(className.active);\n                  }\n                  // activate next label\n                  if(hasActiveLabel) {\n                    if(!event.shiftKey) {\n                      module.verbose('Selecting next label');\n                      $label.removeClass(className.active);\n                    }\n                    else {\n                      module.verbose('Adding next label to selection');\n                    }\n                    if(isLastLabel) {\n                      if(isSearch) {\n                        if(!isFocusedOnSearch) {\n                          module.focusSearch();\n                        }\n                        else {\n                          $label.removeClass(className.active);\n                        }\n                      }\n                      else if(hasMultipleActive) {\n                        $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                      }\n                      else {\n                        $activeLabel.addClass(className.active);\n                      }\n                    }\n                    else {\n                      $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                    }\n                    event.preventDefault();\n                  }\n                }\n                else if(pressedKey == keys.deleteKey || pressedKey == keys.backspace) {\n                  if(hasActiveLabel) {\n                    module.verbose('Removing active labels');\n                    if(isLastLabel) {\n                      if(isSearch && !isFocusedOnSearch) {\n                        module.focusSearch();\n                      }\n                    }\n                    $activeLabel.last().next(selector.siblingLabel).addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                    event.preventDefault();\n                  }\n                  else if(caretAtStart && !hasActiveLabel && pressedKey == keys.backspace) {\n                    module.verbose('Removing last label on input backspace');\n                    $activeLabel = $label.last().addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                  }\n                }\n                else {\n                  $activeLabel.removeClass(className.active);\n                }\n              }\n            }\n          },\n\n          keydown: function(event) {\n            var\n              pressedKey    = event.which,\n              isShortcutKey = module.is.inObject(pressedKey, keys)\n            ;\n            if(isShortcutKey) {\n              var\n                $currentlySelected = $item.not(selector.unselectable).filter('.' + className.selected).eq(0),\n                $activeItem        = $menu.children('.' + className.active).eq(0),\n                $selectedItem      = ($currentlySelected.length > 0)\n                  ? $currentlySelected\n                  : $activeItem,\n                $visibleItems = ($selectedItem.length > 0)\n                  ? $selectedItem.siblings(':not(.' + className.filtered +')').addBack()\n                  : $menu.children(':not(.' + className.filtered +')'),\n                $subMenu              = $selectedItem.children(selector.menu),\n                $parentMenu           = $selectedItem.closest(selector.menu),\n                inVisibleMenu         = ($parentMenu.hasClass(className.visible) || $parentMenu.hasClass(className.animating) || $parentMenu.parent(selector.menu).length > 0),\n                hasSubMenu            = ($subMenu.length> 0),\n                hasSelectedItem       = ($selectedItem.length > 0),\n                selectedIsSelectable  = ($selectedItem.not(selector.unselectable).length > 0),\n                delimiterPressed      = (pressedKey == keys.delimiter && settings.allowAdditions && module.is.multiple()),\n                isAdditionWithoutMenu = (settings.allowAdditions && settings.hideAdditions && (pressedKey == keys.enter || delimiterPressed) && selectedIsSelectable),\n                $nextItem,\n                isSubMenuItem,\n                newIndex\n              ;\n              // allow selection with menu closed\n              if(isAdditionWithoutMenu) {\n                module.verbose('Selecting item from keyboard shortcut', $selectedItem);\n                module.event.item.click.call($selectedItem, event);\n                if(module.is.searchSelection()) {\n                  module.remove.searchTerm();\n                }\n              }\n\n              // visible menu keyboard shortcuts\n              if( module.is.visible() ) {\n\n                // enter (select or open sub-menu)\n                if(pressedKey == keys.enter || delimiterPressed) {\n                  if(pressedKey == keys.enter && hasSelectedItem && hasSubMenu && !settings.allowCategorySelection) {\n                    module.verbose('Pressed enter on unselectable category, opening sub menu');\n                    pressedKey = keys.rightArrow;\n                  }\n                  else if(selectedIsSelectable) {\n                    module.verbose('Selecting item from keyboard shortcut', $selectedItem);\n                    module.event.item.click.call($selectedItem, event);\n                    if(module.is.searchSelection()) {\n                      module.remove.searchTerm();\n                    }\n                  }\n                  event.preventDefault();\n                }\n\n                // sub-menu actions\n                if(hasSelectedItem) {\n\n                  if(pressedKey == keys.leftArrow) {\n\n                    isSubMenuItem = ($parentMenu[0] !== $menu[0]);\n\n                    if(isSubMenuItem) {\n                      module.verbose('Left key pressed, closing sub-menu');\n                      module.animate.hide(false, $parentMenu);\n                      $selectedItem\n                        .removeClass(className.selected)\n                      ;\n                      $parentMenu\n                        .closest(selector.item)\n                          .addClass(className.selected)\n                      ;\n                      event.preventDefault();\n                    }\n                  }\n\n                  // right arrow (show sub-menu)\n                  if(pressedKey == keys.rightArrow) {\n                    if(hasSubMenu) {\n                      module.verbose('Right key pressed, opening sub-menu');\n                      module.animate.show(false, $subMenu);\n                      $selectedItem\n                        .removeClass(className.selected)\n                      ;\n                      $subMenu\n                        .find(selector.item).eq(0)\n                          .addClass(className.selected)\n                      ;\n                      event.preventDefault();\n                    }\n                  }\n                }\n\n                // up arrow (traverse menu up)\n                if(pressedKey == keys.upArrow) {\n                  $nextItem = (hasSelectedItem && inVisibleMenu)\n                    ? $selectedItem.prevAll(selector.item + ':not(' + selector.unselectable + ')').eq(0)\n                    : $item.eq(0)\n                  ;\n                  if($visibleItems.index( $nextItem ) < 0) {\n                    module.verbose('Up key pressed but reached top of current menu');\n                    event.preventDefault();\n                    return;\n                  }\n                  else {\n                    module.verbose('Up key pressed, changing active item');\n                    $selectedItem\n                      .removeClass(className.selected)\n                    ;\n                    $nextItem\n                      .addClass(className.selected)\n                    ;\n                    module.set.scrollPosition($nextItem);\n                    if(settings.selectOnKeydown && module.is.single()) {\n                      module.set.selectedItem($nextItem);\n                    }\n                  }\n                  event.preventDefault();\n                }\n\n                // down arrow (traverse menu down)\n                if(pressedKey == keys.downArrow) {\n                  $nextItem = (hasSelectedItem && inVisibleMenu)\n                    ? $nextItem = $selectedItem.nextAll(selector.item + ':not(' + selector.unselectable + ')').eq(0)\n                    : $item.eq(0)\n                  ;\n                  if($nextItem.length === 0) {\n                    module.verbose('Down key pressed but reached bottom of current menu');\n                    event.preventDefault();\n                    return;\n                  }\n                  else {\n                    module.verbose('Down key pressed, changing active item');\n                    $item\n                      .removeClass(className.selected)\n                    ;\n                    $nextItem\n                      .addClass(className.selected)\n                    ;\n                    module.set.scrollPosition($nextItem);\n                    if(settings.selectOnKeydown && module.is.single()) {\n                      module.set.selectedItem($nextItem);\n                    }\n                  }\n                  event.preventDefault();\n                }\n\n                // page down (show next page)\n                if(pressedKey == keys.pageUp) {\n                  module.scrollPage('up');\n                  event.preventDefault();\n                }\n                if(pressedKey == keys.pageDown) {\n                  module.scrollPage('down');\n                  event.preventDefault();\n                }\n\n                // escape (close menu)\n                if(pressedKey == keys.escape) {\n                  module.verbose('Escape key pressed, closing dropdown');\n                  module.hide();\n                }\n\n              }\n              else {\n                // delimiter key\n                if(delimiterPressed) {\n                  event.preventDefault();\n                }\n                // down arrow (open menu)\n                if(pressedKey == keys.downArrow && !module.is.visible()) {\n                  module.verbose('Down key pressed, showing dropdown');\n                  module.show();\n                  event.preventDefault();\n                }\n              }\n            }\n            else {\n              if( !module.has.search() ) {\n                module.set.selectedLetter( String.fromCharCode(pressedKey) );\n              }\n            }\n          }\n        },\n\n        trigger: {\n          change: function() {\n            var\n              events       = document.createEvent('HTMLEvents'),\n              inputElement = $input[0]\n            ;\n            if(inputElement) {\n              module.verbose('Triggering native change event');\n              events.initEvent('change', true, false);\n              inputElement.dispatchEvent(events);\n            }\n          }\n        },\n\n        determine: {\n          selectAction: function(text, value) {\n            module.verbose('Determining action', settings.action);\n            if( $.isFunction( module.action[settings.action] ) ) {\n              module.verbose('Triggering preset action', settings.action, text, value);\n              module.action[ settings.action ].call(element, text, value, this);\n            }\n            else if( $.isFunction(settings.action) ) {\n              module.verbose('Triggering user action', settings.action, text, value);\n              settings.action.call(element, text, value, this);\n            }\n            else {\n              module.error(error.action, settings.action);\n            }\n          },\n          eventInModule: function(event, callback) {\n            var\n              $target    = $(event.target),\n              inDocument = ($target.closest(document.documentElement).length > 0),\n              inModule   = ($target.closest($module).length > 0)\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            if(inDocument && !inModule) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            }\n            else {\n              module.verbose('Event occurred in dropdown, canceling callback');\n              return false;\n            }\n          },\n          eventOnElement: function(event, callback) {\n            var\n              $target      = $(event.target),\n              $label       = $target.closest(selector.siblingLabel),\n              inVisibleDOM = document.body.contains(event.target),\n              notOnLabel   = ($module.find($label).length === 0),\n              notInMenu    = ($target.closest($menu).length === 0)\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            if(inVisibleDOM && notOnLabel && notInMenu) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            }\n            else {\n              module.verbose('Event occurred in dropdown menu, canceling callback');\n              return false;\n            }\n          }\n        },\n\n        action: {\n\n          nothing: function() {},\n\n          activate: function(text, value, element) {\n            value = (value !== undefined)\n              ? value\n              : text\n            ;\n            if( module.can.activate( $(element) ) ) {\n              module.set.selected(value, $(element));\n              if(module.is.multiple() && !module.is.allFiltered()) {\n                return;\n              }\n              else {\n                module.hideAndClear();\n              }\n            }\n          },\n\n          select: function(text, value, element) {\n            value = (value !== undefined)\n              ? value\n              : text\n            ;\n            if( module.can.activate( $(element) ) ) {\n              module.set.value(value, text, $(element));\n              if(module.is.multiple() && !module.is.allFiltered()) {\n                return;\n              }\n              else {\n                module.hideAndClear();\n              }\n            }\n          },\n\n          combo: function(text, value, element) {\n            value = (value !== undefined)\n              ? value\n              : text\n            ;\n            module.set.selected(value, $(element));\n            module.hideAndClear();\n          },\n\n          hide: function(text, value, element) {\n            module.set.value(value, text);\n            module.hideAndClear();\n          }\n\n        },\n\n        get: {\n          id: function() {\n            return id;\n          },\n          defaultText: function() {\n            return $module.data(metadata.defaultText);\n          },\n          defaultValue: function() {\n            return $module.data(metadata.defaultValue);\n          },\n          placeholderText: function() {\n            if(settings.placeholder != 'auto' && typeof settings.placeholder == 'string') {\n              return settings.placeholder;\n            }\n            return $module.data(metadata.placeholderText) || '';\n          },\n          text: function() {\n            return $text.text();\n          },\n          query: function() {\n            return $.trim($search.val());\n          },\n          searchWidth: function(value) {\n            value = (value !== undefined)\n              ? value\n              : $search.val()\n            ;\n            $sizer.text(value);\n            // prevent rounding issues\n            return Math.ceil( $sizer.width() + 1);\n          },\n          selectionCount: function() {\n            var\n              values = module.get.values(),\n              count\n            ;\n            count = ( module.is.multiple() )\n              ? $.isArray(values)\n                ? values.length\n                : 0\n              : (module.get.value() !== '')\n                ? 1\n                : 0\n            ;\n            return count;\n          },\n          transition: function($subMenu) {\n            return (settings.transition == 'auto')\n              ? module.is.upward($subMenu)\n                ? 'slide up'\n                : 'slide down'\n              : settings.transition\n            ;\n          },\n          userValues: function() {\n            var\n              values = module.get.values()\n            ;\n            if(!values) {\n              return false;\n            }\n            values = $.isArray(values)\n              ? values\n              : [values]\n            ;\n            return $.grep(values, function(value) {\n              return (module.get.item(value) === false);\n            });\n          },\n          uniqueArray: function(array) {\n            return $.grep(array, function (value, index) {\n                return $.inArray(value, array) === index;\n            });\n          },\n          caretPosition: function() {\n            var\n              input = $search.get(0),\n              range,\n              rangeLength\n            ;\n            if('selectionStart' in input) {\n              return input.selectionStart;\n            }\n            else if (document.selection) {\n              input.focus();\n              range       = document.selection.createRange();\n              rangeLength = range.text.length;\n              range.moveStart('character', -input.value.length);\n              return range.text.length - rangeLength;\n            }\n          },\n          value: function() {\n            var\n              value = ($input.length > 0)\n                ? $input.val()\n                : $module.data(metadata.value),\n              isEmptyMultiselect = ($.isArray(value) && value.length === 1 && value[0] === '')\n            ;\n            // prevents placeholder element from being selected when multiple\n            return (value === undefined || isEmptyMultiselect)\n              ? ''\n              : value\n            ;\n          },\n          values: function() {\n            var\n              value = module.get.value()\n            ;\n            if(value === '') {\n              return '';\n            }\n            return ( !module.has.selectInput() && module.is.multiple() )\n              ? (typeof value == 'string') // delimited string\n                ? value.split(settings.delimiter)\n                : ''\n              : value\n            ;\n          },\n          remoteValues: function() {\n            var\n              values = module.get.values(),\n              remoteValues = false\n            ;\n            if(values) {\n              if(typeof values == 'string') {\n                values = [values];\n              }\n              $.each(values, function(index, value) {\n                var\n                  name = module.read.remoteData(value)\n                ;\n                module.verbose('Restoring value from session data', name, value);\n                if(name) {\n                  if(!remoteValues) {\n                    remoteValues = {};\n                  }\n                  remoteValues[value] = name;\n                }\n              });\n            }\n            return remoteValues;\n          },\n          choiceText: function($choice, preserveHTML) {\n            preserveHTML = (preserveHTML !== undefined)\n              ? preserveHTML\n              : settings.preserveHTML\n            ;\n            if($choice) {\n              if($choice.find(selector.menu).length > 0) {\n                module.verbose('Retrieving text of element with sub-menu');\n                $choice = $choice.clone();\n                $choice.find(selector.menu).remove();\n                $choice.find(selector.menuIcon).remove();\n              }\n              return ($choice.data(metadata.text) !== undefined)\n                ? $choice.data(metadata.text)\n                : (preserveHTML)\n                  ? $.trim($choice.html())\n                  : $.trim($choice.text())\n              ;\n            }\n          },\n          choiceValue: function($choice, choiceText) {\n            choiceText = choiceText || module.get.choiceText($choice);\n            if(!$choice) {\n              return false;\n            }\n            return ($choice.data(metadata.value) !== undefined)\n              ? String( $choice.data(metadata.value) )\n              : (typeof choiceText === 'string')\n                ? $.trim(choiceText.toLowerCase())\n                : String(choiceText)\n            ;\n          },\n          inputEvent: function() {\n            var\n              input = $search[0]\n            ;\n            if(input) {\n              return (input.oninput !== undefined)\n                ? 'input'\n                : (input.onpropertychange !== undefined)\n                  ? 'propertychange'\n                  : 'keyup'\n              ;\n            }\n            return false;\n          },\n          selectValues: function() {\n            var\n              select = {}\n            ;\n            select.values = [];\n            $module\n              .find('option')\n                .each(function() {\n                  var\n                    $option  = $(this),\n                    name     = $option.html(),\n                    disabled = $option.attr('disabled'),\n                    value    = ( $option.attr('value') !== undefined )\n                      ? $option.attr('value')\n                      : name\n                  ;\n                  if(settings.placeholder === 'auto' && value === '') {\n                    select.placeholder = name;\n                  }\n                  else {\n                    select.values.push({\n                      name     : name,\n                      value    : value,\n                      disabled : disabled\n                    });\n                  }\n                })\n            ;\n            if(settings.placeholder && settings.placeholder !== 'auto') {\n              module.debug('Setting placeholder value to', settings.placeholder);\n              select.placeholder = settings.placeholder;\n            }\n            if(settings.sortSelect) {\n              select.values.sort(function(a, b) {\n                return (a.name > b.name)\n                  ? 1\n                  : -1\n                ;\n              });\n              module.debug('Retrieved and sorted values from select', select);\n            }\n            else {\n              module.debug('Retrieved values from select', select);\n            }\n            return select;\n          },\n          activeItem: function() {\n            return $item.filter('.'  + className.active);\n          },\n          selectedItem: function() {\n            var\n              $selectedItem = $item.not(selector.unselectable).filter('.'  + className.selected)\n            ;\n            return ($selectedItem.length > 0)\n              ? $selectedItem\n              : $item.eq(0)\n            ;\n          },\n          itemWithAdditions: function(value) {\n            var\n              $items       = module.get.item(value),\n              $userItems   = module.create.userChoice(value),\n              hasUserItems = ($userItems && $userItems.length > 0)\n            ;\n            if(hasUserItems) {\n              $items = ($items.length > 0)\n                ? $items.add($userItems)\n                : $userItems\n              ;\n            }\n            return $items;\n          },\n          item: function(value, strict) {\n            var\n              $selectedItem = false,\n              shouldSearch,\n              isMultiple\n            ;\n            value = (value !== undefined)\n              ? value\n              : ( module.get.values() !== undefined)\n                ? module.get.values()\n                : module.get.text()\n            ;\n            shouldSearch = (isMultiple)\n              ? (value.length > 0)\n              : (value !== undefined && value !== null)\n            ;\n            isMultiple = (module.is.multiple() && $.isArray(value));\n            strict     = (value === '' || value === 0)\n              ? true\n              : strict || false\n            ;\n            if(shouldSearch) {\n              $item\n                .each(function() {\n                  var\n                    $choice       = $(this),\n                    optionText    = module.get.choiceText($choice),\n                    optionValue   = module.get.choiceValue($choice, optionText)\n                  ;\n                  // safe early exit\n                  if(optionValue === null || optionValue === undefined) {\n                    return;\n                  }\n                  if(isMultiple) {\n                    if($.inArray( String(optionValue), value) !== -1 || $.inArray(optionText, value) !== -1) {\n                      $selectedItem = ($selectedItem)\n                        ? $selectedItem.add($choice)\n                        : $choice\n                      ;\n                    }\n                  }\n                  else if(strict) {\n                    module.verbose('Ambiguous dropdown value using strict type check', $choice, value);\n                    if( optionValue === value || optionText === value) {\n                      $selectedItem = $choice;\n                      return true;\n                    }\n                  }\n                  else {\n                    if( String(optionValue) == String(value) || optionText == value) {\n                      module.verbose('Found select item by value', optionValue, value);\n                      $selectedItem = $choice;\n                      return true;\n                    }\n                  }\n                })\n              ;\n            }\n            return $selectedItem;\n          }\n        },\n\n        check: {\n          maxSelections: function(selectionCount) {\n            if(settings.maxSelections) {\n              selectionCount = (selectionCount !== undefined)\n                ? selectionCount\n                : module.get.selectionCount()\n              ;\n              if(selectionCount >= settings.maxSelections) {\n                module.debug('Maximum selection count reached');\n                if(settings.useLabels) {\n                  $item.addClass(className.filtered);\n                  module.add.message(message.maxSelections);\n                }\n                return true;\n              }\n              else {\n                module.verbose('No longer at maximum selection count');\n                module.remove.message();\n                module.remove.filteredItem();\n                if(module.is.searchSelection()) {\n                  module.filterItems();\n                }\n                return false;\n              }\n            }\n            return true;\n          }\n        },\n\n        restore: {\n          defaults: function() {\n            module.clear();\n            module.restore.defaultText();\n            module.restore.defaultValue();\n          },\n          defaultText: function() {\n            var\n              defaultText     = module.get.defaultText(),\n              placeholderText = module.get.placeholderText\n            ;\n            if(defaultText === placeholderText) {\n              module.debug('Restoring default placeholder text', defaultText);\n              module.set.placeholderText(defaultText);\n            }\n            else {\n              module.debug('Restoring default text', defaultText);\n              module.set.text(defaultText);\n            }\n          },\n          placeholderText: function() {\n            module.set.placeholderText();\n          },\n          defaultValue: function() {\n            var\n              defaultValue = module.get.defaultValue()\n            ;\n            if(defaultValue !== undefined) {\n              module.debug('Restoring default value', defaultValue);\n              if(defaultValue !== '') {\n                module.set.value(defaultValue);\n                module.set.selected();\n              }\n              else {\n                module.remove.activeItem();\n                module.remove.selectedItem();\n              }\n            }\n          },\n          labels: function() {\n            if(settings.allowAdditions) {\n              if(!settings.useLabels) {\n                module.error(error.labels);\n                settings.useLabels = true;\n              }\n              module.debug('Restoring selected values');\n              module.create.userLabels();\n            }\n            module.check.maxSelections();\n          },\n          selected: function() {\n            module.restore.values();\n            if(module.is.multiple()) {\n              module.debug('Restoring previously selected values and labels');\n              module.restore.labels();\n            }\n            else {\n              module.debug('Restoring previously selected values');\n            }\n          },\n          values: function() {\n            // prevents callbacks from occurring on initial load\n            module.set.initialLoad();\n            if(settings.apiSettings && settings.saveRemoteData && module.get.remoteValues()) {\n              module.restore.remoteValues();\n            }\n            else {\n              module.set.selected();\n            }\n            module.remove.initialLoad();\n          },\n          remoteValues: function() {\n            var\n              values = module.get.remoteValues()\n            ;\n            module.debug('Recreating selected from session data', values);\n            if(values) {\n              if( module.is.single() ) {\n                $.each(values, function(value, name) {\n                  module.set.text(name);\n                });\n              }\n              else {\n                $.each(values, function(value, name) {\n                  module.add.label(value, name);\n                });\n              }\n            }\n          }\n        },\n\n        read: {\n          remoteData: function(value) {\n            var\n              name\n            ;\n            if(window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n            name = sessionStorage.getItem(value);\n            return (name !== undefined)\n              ? name\n              : false\n            ;\n          }\n        },\n\n        save: {\n          defaults: function() {\n            module.save.defaultText();\n            module.save.placeholderText();\n            module.save.defaultValue();\n          },\n          defaultValue: function() {\n            var\n              value = module.get.value()\n            ;\n            module.verbose('Saving default value as', value);\n            $module.data(metadata.defaultValue, value);\n          },\n          defaultText: function() {\n            var\n              text = module.get.text()\n            ;\n            module.verbose('Saving default text as', text);\n            $module.data(metadata.defaultText, text);\n          },\n          placeholderText: function() {\n            var\n              text\n            ;\n            if(settings.placeholder !== false && $text.hasClass(className.placeholder)) {\n              text = module.get.text();\n              module.verbose('Saving placeholder text as', text);\n              $module.data(metadata.placeholderText, text);\n            }\n          },\n          remoteData: function(name, value) {\n            if(window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n            module.verbose('Saving remote data to session storage', value, name);\n            sessionStorage.setItem(value, name);\n          }\n        },\n\n        clear: function() {\n          if(module.is.multiple() && settings.useLabels) {\n            module.remove.labels();\n          }\n          else {\n            module.remove.activeItem();\n            module.remove.selectedItem();\n          }\n          module.set.placeholderText();\n          module.clearValue();\n        },\n\n        clearValue: function() {\n          module.set.value('');\n        },\n\n        scrollPage: function(direction, $selectedItem) {\n          var\n            $currentItem  = $selectedItem || module.get.selectedItem(),\n            $menu         = $currentItem.closest(selector.menu),\n            menuHeight    = $menu.outerHeight(),\n            currentScroll = $menu.scrollTop(),\n            itemHeight    = $item.eq(0).outerHeight(),\n            itemsPerPage  = Math.floor(menuHeight / itemHeight),\n            maxScroll     = $menu.prop('scrollHeight'),\n            newScroll     = (direction == 'up')\n              ? currentScroll - (itemHeight * itemsPerPage)\n              : currentScroll + (itemHeight * itemsPerPage),\n            $selectableItem = $item.not(selector.unselectable),\n            isWithinRange,\n            $nextSelectedItem,\n            elementIndex\n          ;\n          elementIndex      = (direction == 'up')\n            ? $selectableItem.index($currentItem) - itemsPerPage\n            : $selectableItem.index($currentItem) + itemsPerPage\n          ;\n          isWithinRange = (direction == 'up')\n            ? (elementIndex >= 0)\n            : (elementIndex < $selectableItem.length)\n          ;\n          $nextSelectedItem = (isWithinRange)\n            ? $selectableItem.eq(elementIndex)\n            : (direction == 'up')\n              ? $selectableItem.first()\n              : $selectableItem.last()\n          ;\n          if($nextSelectedItem.length > 0) {\n            module.debug('Scrolling page', direction, $nextSelectedItem);\n            $currentItem\n              .removeClass(className.selected)\n            ;\n            $nextSelectedItem\n              .addClass(className.selected)\n            ;\n            if(settings.selectOnKeydown && module.is.single()) {\n              module.set.selectedItem($nextSelectedItem);\n            }\n            $menu\n              .scrollTop(newScroll)\n            ;\n          }\n        },\n\n        set: {\n          filtered: function() {\n            var\n              isMultiple       = module.is.multiple(),\n              isSearch         = module.is.searchSelection(),\n              isSearchMultiple = (isMultiple && isSearch),\n              searchValue      = (isSearch)\n                ? module.get.query()\n                : '',\n              hasSearchValue   = (typeof searchValue === 'string' && searchValue.length > 0),\n              searchWidth      = module.get.searchWidth(),\n              valueIsSet       = searchValue !== ''\n            ;\n            if(isMultiple && hasSearchValue) {\n              module.verbose('Adjusting input width', searchWidth, settings.glyphWidth);\n              $search.css('width', searchWidth);\n            }\n            if(hasSearchValue || (isSearchMultiple && valueIsSet)) {\n              module.verbose('Hiding placeholder text');\n              $text.addClass(className.filtered);\n            }\n            else if(!isMultiple || (isSearchMultiple && !valueIsSet)) {\n              module.verbose('Showing placeholder text');\n              $text.removeClass(className.filtered);\n            }\n          },\n          empty: function() {\n            $module.addClass(className.empty);\n          },\n          loading: function() {\n            $module.addClass(className.loading);\n          },\n          placeholderText: function(text) {\n            text = text || module.get.placeholderText();\n            module.debug('Setting placeholder text', text);\n            module.set.text(text);\n            $text.addClass(className.placeholder);\n          },\n          tabbable: function() {\n            if( module.is.searchSelection() ) {\n              module.debug('Added tabindex to searchable dropdown');\n              $search\n                .val('')\n                .attr('tabindex', 0)\n              ;\n              $menu\n                .attr('tabindex', -1)\n              ;\n            }\n            else {\n              module.debug('Added tabindex to dropdown');\n              if( $module.attr('tabindex') === undefined) {\n                $module\n                  .attr('tabindex', 0)\n                ;\n                $menu\n                  .attr('tabindex', -1)\n                ;\n              }\n            }\n          },\n          initialLoad: function() {\n            module.verbose('Setting initial load');\n            initialLoad = true;\n          },\n          activeItem: function($item) {\n            if( settings.allowAdditions && $item.filter(selector.addition).length > 0 ) {\n              $item.addClass(className.filtered);\n            }\n            else {\n              $item.addClass(className.active);\n            }\n          },\n          partialSearch: function(text) {\n            var\n              length = module.get.query().length\n            ;\n            $search.val( text.substr(0, length));\n          },\n          scrollPosition: function($item, forceScroll) {\n            var\n              edgeTolerance = 5,\n              $menu,\n              hasActive,\n              offset,\n              itemHeight,\n              itemOffset,\n              menuOffset,\n              menuScroll,\n              menuHeight,\n              abovePage,\n              belowPage\n            ;\n\n            $item       = $item || module.get.selectedItem();\n            $menu       = $item.closest(selector.menu);\n            hasActive   = ($item && $item.length > 0);\n            forceScroll = (forceScroll !== undefined)\n              ? forceScroll\n              : false\n            ;\n            if($item && $menu.length > 0 && hasActive) {\n              itemOffset = $item.position().top;\n\n              $menu.addClass(className.loading);\n              menuScroll = $menu.scrollTop();\n              menuOffset = $menu.offset().top;\n              itemOffset = $item.offset().top;\n              offset     = menuScroll - menuOffset + itemOffset;\n              if(!forceScroll) {\n                menuHeight = $menu.height();\n                belowPage  = menuScroll + menuHeight < (offset + edgeTolerance);\n                abovePage  = ((offset - edgeTolerance) < menuScroll);\n              }\n              module.debug('Scrolling to active item', offset);\n              if(forceScroll || abovePage || belowPage) {\n                $menu.scrollTop(offset);\n              }\n              $menu.removeClass(className.loading);\n            }\n          },\n          text: function(text) {\n            if(settings.action !== 'select') {\n              if(settings.action == 'combo') {\n                module.debug('Changing combo button text', text, $combo);\n                if(settings.preserveHTML) {\n                  $combo.html(text);\n                }\n                else {\n                  $combo.text(text);\n                }\n              }\n              else {\n                if(text !== module.get.placeholderText()) {\n                  $text.removeClass(className.placeholder);\n                }\n                module.debug('Changing text', text, $text);\n                $text\n                  .removeClass(className.filtered)\n                ;\n                if(settings.preserveHTML) {\n                  $text.html(text);\n                }\n                else {\n                  $text.text(text);\n                }\n              }\n            }\n          },\n          selectedItem: function($item) {\n            var\n              value      = module.get.choiceValue($item),\n              searchText = module.get.choiceText($item, false),\n              text       = module.get.choiceText($item, true)\n            ;\n            module.debug('Setting user selection to item', $item);\n            module.remove.activeItem();\n            module.set.partialSearch(searchText);\n            module.set.activeItem($item);\n            module.set.selected(value, $item);\n            module.set.text(text);\n          },\n          selectedLetter: function(letter) {\n            var\n              $selectedItem         = $item.filter('.' + className.selected),\n              alreadySelectedLetter = $selectedItem.length > 0 && module.has.firstLetter($selectedItem, letter),\n              $nextValue            = false,\n              $nextItem\n            ;\n            // check next of same letter\n            if(alreadySelectedLetter) {\n              $nextItem = $selectedItem.nextAll($item).eq(0);\n              if( module.has.firstLetter($nextItem, letter) ) {\n                $nextValue  = $nextItem;\n              }\n            }\n            // check all values\n            if(!$nextValue) {\n              $item\n                .each(function(){\n                  if(module.has.firstLetter($(this), letter)) {\n                    $nextValue = $(this);\n                    return false;\n                  }\n                })\n              ;\n            }\n            // set next value\n            if($nextValue) {\n              module.verbose('Scrolling to next value with letter', letter);\n              module.set.scrollPosition($nextValue);\n              $selectedItem.removeClass(className.selected);\n              $nextValue.addClass(className.selected);\n              if(settings.selectOnKeydown && module.is.single()) {\n                module.set.selectedItem($nextValue);\n              }\n            }\n          },\n          direction: function($menu) {\n            if(settings.direction == 'auto') {\n              // reset position\n              module.remove.upward();\n\n              if(module.can.openDownward($menu)) {\n                module.remove.upward($menu);\n              }\n              else {\n                module.set.upward($menu);\n              }\n              if(!module.is.leftward($menu) && !module.can.openRightward($menu)) {\n                module.set.leftward($menu);\n              }\n            }\n            else if(settings.direction == 'upward') {\n              module.set.upward($menu);\n            }\n          },\n          upward: function($currentMenu) {\n            var $element = $currentMenu || $module;\n            $element.addClass(className.upward);\n          },\n          leftward: function($currentMenu) {\n            var $element = $currentMenu || $menu;\n            $element.addClass(className.leftward);\n          },\n          value: function(value, text, $selected) {\n            var\n              escapedValue = module.escape.value(value),\n              hasInput     = ($input.length > 0),\n              currentValue = module.get.values(),\n              stringValue  = (value !== undefined)\n                ? String(value)\n                : value,\n              newValue\n            ;\n            if(hasInput) {\n              if(!settings.allowReselection && stringValue == currentValue) {\n                module.verbose('Skipping value update already same value', value, currentValue);\n                if(!module.is.initialLoad()) {\n                  return;\n                }\n              }\n\n              if( module.is.single() && module.has.selectInput() && module.can.extendSelect() ) {\n                module.debug('Adding user option', value);\n                module.add.optionValue(value);\n              }\n              module.debug('Updating input value', escapedValue, currentValue);\n              internalChange = true;\n              $input\n                .val(escapedValue)\n              ;\n              if(settings.fireOnInit === false && module.is.initialLoad()) {\n                module.debug('Input native change event ignored on initial load');\n              }\n              else {\n                module.trigger.change();\n              }\n              internalChange = false;\n            }\n            else {\n              module.verbose('Storing value in metadata', escapedValue, $input);\n              if(escapedValue !== currentValue) {\n                $module.data(metadata.value, stringValue);\n              }\n            }\n            if(settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onChange);\n            }\n            else {\n              settings.onChange.call(element, value, text, $selected);\n            }\n          },\n          active: function() {\n            $module\n              .addClass(className.active)\n            ;\n          },\n          multiple: function() {\n            $module.addClass(className.multiple);\n          },\n          visible: function() {\n            $module.addClass(className.visible);\n          },\n          exactly: function(value, $selectedItem) {\n            module.debug('Setting selected to exact values');\n            module.clear();\n            module.set.selected(value, $selectedItem);\n          },\n          selected: function(value, $selectedItem) {\n            var\n              isMultiple = module.is.multiple(),\n              $userSelectedItem\n            ;\n            $selectedItem = (settings.allowAdditions)\n              ? $selectedItem || module.get.itemWithAdditions(value)\n              : $selectedItem || module.get.item(value)\n            ;\n            if(!$selectedItem) {\n              return;\n            }\n            module.debug('Setting selected menu item to', $selectedItem);\n            if(module.is.multiple()) {\n              module.remove.searchWidth();\n            }\n            if(module.is.single()) {\n              module.remove.activeItem();\n              module.remove.selectedItem();\n            }\n            else if(settings.useLabels) {\n              module.remove.selectedItem();\n            }\n            // select each item\n            $selectedItem\n              .each(function() {\n                var\n                  $selected      = $(this),\n                  selectedText   = module.get.choiceText($selected),\n                  selectedValue  = module.get.choiceValue($selected, selectedText),\n\n                  isFiltered     = $selected.hasClass(className.filtered),\n                  isActive       = $selected.hasClass(className.active),\n                  isUserValue    = $selected.hasClass(className.addition),\n                  shouldAnimate  = (isMultiple && $selectedItem.length == 1)\n                ;\n                if(isMultiple) {\n                  if(!isActive || isUserValue) {\n                    if(settings.apiSettings && settings.saveRemoteData) {\n                      module.save.remoteData(selectedText, selectedValue);\n                    }\n                    if(settings.useLabels) {\n                      module.add.label(selectedValue, selectedText, shouldAnimate);\n                      module.add.value(selectedValue, selectedText, $selected);\n                      module.set.activeItem($selected);\n                      module.filterActive();\n                      module.select.nextAvailable($selectedItem);\n                    }\n                    else {\n                      module.add.value(selectedValue, selectedText, $selected);\n                      module.set.text(module.add.variables(message.count));\n                      module.set.activeItem($selected);\n                    }\n                  }\n                  else if(!isFiltered) {\n                    module.debug('Selected active value, removing label');\n                    module.remove.selected(selectedValue);\n                  }\n                }\n                else {\n                  if(settings.apiSettings && settings.saveRemoteData) {\n                    module.save.remoteData(selectedText, selectedValue);\n                  }\n                  module.set.text(selectedText);\n                  module.set.value(selectedValue, selectedText, $selected);\n                  $selected\n                    .addClass(className.active)\n                    .addClass(className.selected)\n                  ;\n                }\n              })\n            ;\n          }\n        },\n\n        add: {\n          label: function(value, text, shouldAnimate) {\n            var\n              $next  = module.is.searchSelection()\n                ? $search\n                : $text,\n              escapedValue = module.escape.value(value),\n              $label\n            ;\n            if(settings.ignoreCase) {\n              escapedValue = escapedValue.toLowerCase();\n            }\n            $label =  $('<a />')\n              .addClass(className.label)\n              .attr('data-' + metadata.value, escapedValue)\n              .html(templates.label(escapedValue, text))\n            ;\n            $label = settings.onLabelCreate.call($label, escapedValue, text);\n\n            if(module.has.label(value)) {\n              module.debug('User selection already exists, skipping', escapedValue);\n              return;\n            }\n            if(settings.label.variation) {\n              $label.addClass(settings.label.variation);\n            }\n            if(shouldAnimate === true) {\n              module.debug('Animating in label', $label);\n              $label\n                .addClass(className.hidden)\n                .insertBefore($next)\n                .transition(settings.label.transition, settings.label.duration)\n              ;\n            }\n            else {\n              module.debug('Adding selection label', $label);\n              $label\n                .insertBefore($next)\n              ;\n            }\n          },\n          message: function(message) {\n            var\n              $message = $menu.children(selector.message),\n              html     = settings.templates.message(module.add.variables(message))\n            ;\n            if($message.length > 0) {\n              $message\n                .html(html)\n              ;\n            }\n            else {\n              $message = $('<div/>')\n                .html(html)\n                .addClass(className.message)\n                .appendTo($menu)\n              ;\n            }\n          },\n          optionValue: function(value) {\n            var\n              escapedValue = module.escape.value(value),\n              $option      = $input.find('option[value=\"' + module.escape.string(escapedValue) + '\"]'),\n              hasOption    = ($option.length > 0)\n            ;\n            if(hasOption) {\n              return;\n            }\n            // temporarily disconnect observer\n            module.disconnect.selectObserver();\n            if( module.is.single() ) {\n              module.verbose('Removing previous user addition');\n              $input.find('option.' + className.addition).remove();\n            }\n            $('<option/>')\n              .prop('value', escapedValue)\n              .addClass(className.addition)\n              .html(value)\n              .appendTo($input)\n            ;\n            module.verbose('Adding user addition as an <option>', value);\n            module.observe.select();\n          },\n          userSuggestion: function(value) {\n            var\n              $addition         = $menu.children(selector.addition),\n              $existingItem     = module.get.item(value),\n              alreadyHasValue   = $existingItem && $existingItem.not(selector.addition).length,\n              hasUserSuggestion = $addition.length > 0,\n              html\n            ;\n            if(settings.useLabels && module.has.maxSelections()) {\n              return;\n            }\n            if(value === '' || alreadyHasValue) {\n              $addition.remove();\n              return;\n            }\n            if(hasUserSuggestion) {\n              $addition\n                .data(metadata.value, value)\n                .data(metadata.text, value)\n                .attr('data-' + metadata.value, value)\n                .attr('data-' + metadata.text, value)\n                .removeClass(className.filtered)\n              ;\n              if(!settings.hideAdditions) {\n                html = settings.templates.addition( module.add.variables(message.addResult, value) );\n                $addition\n                  .html(html)\n                ;\n              }\n              module.verbose('Replacing user suggestion with new value', $addition);\n            }\n            else {\n              $addition = module.create.userChoice(value);\n              $addition\n                .prependTo($menu)\n              ;\n              module.verbose('Adding item choice to menu corresponding with user choice addition', $addition);\n            }\n            if(!settings.hideAdditions || module.is.allFiltered()) {\n              $addition\n                .addClass(className.selected)\n                .siblings()\n                .removeClass(className.selected)\n              ;\n            }\n            module.refreshItems();\n          },\n          variables: function(message, term) {\n            var\n              hasCount    = (message.search('{count}') !== -1),\n              hasMaxCount = (message.search('{maxCount}') !== -1),\n              hasTerm     = (message.search('{term}') !== -1),\n              values,\n              count,\n              query\n            ;\n            module.verbose('Adding templated variables to message', message);\n            if(hasCount) {\n              count  = module.get.selectionCount();\n              message = message.replace('{count}', count);\n            }\n            if(hasMaxCount) {\n              count  = module.get.selectionCount();\n              message = message.replace('{maxCount}', settings.maxSelections);\n            }\n            if(hasTerm) {\n              query   = term || module.get.query();\n              message = message.replace('{term}', query);\n            }\n            return message;\n          },\n          value: function(addedValue, addedText, $selectedItem) {\n            var\n              currentValue = module.get.values(),\n              newValue\n            ;\n            if(module.has.value(addedValue)) {\n              module.debug('Value already selected');\n              return;\n            }\n            if(addedValue === '') {\n              module.debug('Cannot select blank values from multiselect');\n              return;\n            }\n            // extend current array\n            if($.isArray(currentValue)) {\n              newValue = currentValue.concat([addedValue]);\n              newValue = module.get.uniqueArray(newValue);\n            }\n            else {\n              newValue = [addedValue];\n            }\n            // add values\n            if( module.has.selectInput() ) {\n              if(module.can.extendSelect()) {\n                module.debug('Adding value to select', addedValue, newValue, $input);\n                module.add.optionValue(addedValue);\n              }\n            }\n            else {\n              newValue = newValue.join(settings.delimiter);\n              module.debug('Setting hidden input to delimited value', newValue, $input);\n            }\n\n            if(settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('Skipping onadd callback on initial load', settings.onAdd);\n            }\n            else {\n              settings.onAdd.call(element, addedValue, addedText, $selectedItem);\n            }\n            module.set.value(newValue, addedValue, addedText, $selectedItem);\n            module.check.maxSelections();\n          }\n        },\n\n        remove: {\n          active: function() {\n            $module.removeClass(className.active);\n          },\n          activeLabel: function() {\n            $module.find(selector.label).removeClass(className.active);\n          },\n          empty: function() {\n            $module.removeClass(className.empty);\n          },\n          loading: function() {\n            $module.removeClass(className.loading);\n          },\n          initialLoad: function() {\n            initialLoad = false;\n          },\n          upward: function($currentMenu) {\n            var $element = $currentMenu || $module;\n            $element.removeClass(className.upward);\n          },\n          leftward: function($currentMenu) {\n            var $element = $currentMenu || $menu;\n            $element.removeClass(className.leftward);\n          },\n          visible: function() {\n            $module.removeClass(className.visible);\n          },\n          activeItem: function() {\n            $item.removeClass(className.active);\n          },\n          filteredItem: function() {\n            if(settings.useLabels && module.has.maxSelections() ) {\n              return;\n            }\n            if(settings.useLabels && module.is.multiple()) {\n              $item.not('.' + className.active).removeClass(className.filtered);\n            }\n            else {\n              $item.removeClass(className.filtered);\n            }\n            module.remove.empty();\n          },\n          optionValue: function(value) {\n            var\n              escapedValue = module.escape.value(value),\n              $option      = $input.find('option[value=\"' + module.escape.string(escapedValue) + '\"]'),\n              hasOption    = ($option.length > 0)\n            ;\n            if(!hasOption || !$option.hasClass(className.addition)) {\n              return;\n            }\n            // temporarily disconnect observer\n            if(selectObserver) {\n              selectObserver.disconnect();\n              module.verbose('Temporarily disconnecting mutation observer');\n            }\n            $option.remove();\n            module.verbose('Removing user addition as an <option>', escapedValue);\n            if(selectObserver) {\n              selectObserver.observe($input[0], {\n                childList : true,\n                subtree   : true\n              });\n            }\n          },\n          message: function() {\n            $menu.children(selector.message).remove();\n          },\n          searchWidth: function() {\n            $search.css('width', '');\n          },\n          searchTerm: function() {\n            module.verbose('Cleared search term');\n            $search.val('');\n            module.set.filtered();\n          },\n          userAddition: function() {\n            $item.filter(selector.addition).remove();\n          },\n          selected: function(value, $selectedItem) {\n            $selectedItem = (settings.allowAdditions)\n              ? $selectedItem || module.get.itemWithAdditions(value)\n              : $selectedItem || module.get.item(value)\n            ;\n\n            if(!$selectedItem) {\n              return false;\n            }\n\n            $selectedItem\n              .each(function() {\n                var\n                  $selected     = $(this),\n                  selectedText  = module.get.choiceText($selected),\n                  selectedValue = module.get.choiceValue($selected, selectedText)\n                ;\n                if(module.is.multiple()) {\n                  if(settings.useLabels) {\n                    module.remove.value(selectedValue, selectedText, $selected);\n                    module.remove.label(selectedValue);\n                  }\n                  else {\n                    module.remove.value(selectedValue, selectedText, $selected);\n                    if(module.get.selectionCount() === 0) {\n                      module.set.placeholderText();\n                    }\n                    else {\n                      module.set.text(module.add.variables(message.count));\n                    }\n                  }\n                }\n                else {\n                  module.remove.value(selectedValue, selectedText, $selected);\n                }\n                $selected\n                  .removeClass(className.filtered)\n                  .removeClass(className.active)\n                ;\n                if(settings.useLabels) {\n                  $selected.removeClass(className.selected);\n                }\n              })\n            ;\n          },\n          selectedItem: function() {\n            $item.removeClass(className.selected);\n          },\n          value: function(removedValue, removedText, $removedItem) {\n            var\n              values = module.get.values(),\n              newValue\n            ;\n            if( module.has.selectInput() ) {\n              module.verbose('Input is <select> removing selected option', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              module.remove.optionValue(removedValue);\n            }\n            else {\n              module.verbose('Removing from delimited values', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              newValue = newValue.join(settings.delimiter);\n            }\n            if(settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onRemove);\n            }\n            else {\n              settings.onRemove.call(element, removedValue, removedText, $removedItem);\n            }\n            module.set.value(newValue, removedText, $removedItem);\n            module.check.maxSelections();\n          },\n          arrayValue: function(removedValue, values) {\n            if( !$.isArray(values) ) {\n              values = [values];\n            }\n            values = $.grep(values, function(value){\n              return (removedValue != value);\n            });\n            module.verbose('Removed value from delimited string', removedValue, values);\n            return values;\n          },\n          label: function(value, shouldAnimate) {\n            var\n              $labels       = $module.find(selector.label),\n              $removedLabel = $labels.filter('[data-' + metadata.value + '=\"' + module.escape.string(value) +'\"]')\n            ;\n            module.verbose('Removing label', $removedLabel);\n            $removedLabel.remove();\n          },\n          activeLabels: function($activeLabels) {\n            $activeLabels = $activeLabels || $module.find(selector.label).filter('.' + className.active);\n            module.verbose('Removing active label selections', $activeLabels);\n            module.remove.labels($activeLabels);\n          },\n          labels: function($labels) {\n            $labels = $labels || $module.find(selector.label);\n            module.verbose('Removing labels', $labels);\n            $labels\n              .each(function(){\n                var\n                  $label      = $(this),\n                  value       = $label.data(metadata.value),\n                  stringValue = (value !== undefined)\n                    ? String(value)\n                    : value,\n                  isUserValue = module.is.userValue(stringValue)\n                ;\n                if(settings.onLabelRemove.call($label, value) === false) {\n                  module.debug('Label remove callback cancelled removal');\n                  return;\n                }\n                module.remove.message();\n                if(isUserValue) {\n                  module.remove.value(stringValue);\n                  module.remove.label(stringValue);\n                }\n                else {\n                  // selected will also remove label\n                  module.remove.selected(stringValue);\n                }\n              })\n            ;\n          },\n          tabbable: function() {\n            if( module.is.searchSelection() ) {\n              module.debug('Searchable dropdown initialized');\n              $search\n                .removeAttr('tabindex')\n              ;\n              $menu\n                .removeAttr('tabindex')\n              ;\n            }\n            else {\n              module.debug('Simple selection dropdown initialized');\n              $module\n                .removeAttr('tabindex')\n              ;\n              $menu\n                .removeAttr('tabindex')\n              ;\n            }\n          }\n        },\n\n        has: {\n          menuSearch: function() {\n            return (module.has.search() && $search.closest($menu).length > 0);\n          },\n          search: function() {\n            return ($search.length > 0);\n          },\n          sizer: function() {\n            return ($sizer.length > 0);\n          },\n          selectInput: function() {\n            return ( $input.is('select') );\n          },\n          minCharacters: function(searchTerm) {\n            if(settings.minCharacters) {\n              searchTerm = (searchTerm !== undefined)\n                ? String(searchTerm)\n                : String(module.get.query())\n              ;\n              return (searchTerm.length >= settings.minCharacters);\n            }\n            return true;\n          },\n          firstLetter: function($item, letter) {\n            var\n              text,\n              firstLetter\n            ;\n            if(!$item || $item.length === 0 || typeof letter !== 'string') {\n              return false;\n            }\n            text        = module.get.choiceText($item, false);\n            letter      = letter.toLowerCase();\n            firstLetter = String(text).charAt(0).toLowerCase();\n            return (letter == firstLetter);\n          },\n          input: function() {\n            return ($input.length > 0);\n          },\n          items: function() {\n            return ($item.length > 0);\n          },\n          menu: function() {\n            return ($menu.length > 0);\n          },\n          message: function() {\n            return ($menu.children(selector.message).length !== 0);\n          },\n          label: function(value) {\n            var\n              escapedValue = module.escape.value(value),\n              $labels      = $module.find(selector.label)\n            ;\n            if(settings.ignoreCase) {\n              escapedValue = escapedValue.toLowerCase();\n            }\n            return ($labels.filter('[data-' + metadata.value + '=\"' + module.escape.string(escapedValue) +'\"]').length > 0);\n          },\n          maxSelections: function() {\n            return (settings.maxSelections && module.get.selectionCount() >= settings.maxSelections);\n          },\n          allResultsFiltered: function() {\n            var\n              $normalResults = $item.not(selector.addition)\n            ;\n            return ($normalResults.filter(selector.unselectable).length === $normalResults.length);\n          },\n          userSuggestion: function() {\n            return ($menu.children(selector.addition).length > 0);\n          },\n          query: function() {\n            return (module.get.query() !== '');\n          },\n          value: function(value) {\n            return (settings.ignoreCase)\n              ? module.has.valueIgnoringCase(value)\n              : module.has.valueMatchingCase(value)\n            ;\n          },\n          valueMatchingCase: function(value) {\n            var\n              values   = module.get.values(),\n              hasValue = $.isArray(values)\n               ? values && ($.inArray(value, values) !== -1)\n               : (values == value)\n            ;\n            return (hasValue)\n              ? true\n              : false\n            ;\n          },\n          valueIgnoringCase: function(value) {\n            var\n              values   = module.get.values(),\n              hasValue = false\n            ;\n            if(!$.isArray(values)) {\n              values = [values];\n            }\n            $.each(values, function(index, existingValue) {\n              if(String(value).toLowerCase() == String(existingValue).toLowerCase()) {\n                hasValue = true;\n                return false;\n              }\n            });\n            return hasValue;\n          }\n        },\n\n        is: {\n          active: function() {\n            return $module.hasClass(className.active);\n          },\n          animatingInward: function() {\n            return $menu.transition('is inward');\n          },\n          animatingOutward: function() {\n            return $menu.transition('is outward');\n          },\n          bubbledLabelClick: function(event) {\n            return $(event.target).is('select, input') && $module.closest('label').length > 0;\n          },\n          bubbledIconClick: function(event) {\n            return $(event.target).closest($icon).length > 0;\n          },\n          alreadySetup: function() {\n            return ($module.is('select') && $module.parent(selector.dropdown).data(moduleNamespace) !== undefined && $module.prev().length === 0);\n          },\n          animating: function($subMenu) {\n            return ($subMenu)\n              ? $subMenu.transition && $subMenu.transition('is animating')\n              : $menu.transition    && $menu.transition('is animating')\n            ;\n          },\n          leftward: function($subMenu) {\n            var $selectedMenu = $subMenu || $menu;\n            return $selectedMenu.hasClass(className.leftward);\n          },\n          disabled: function() {\n            return $module.hasClass(className.disabled);\n          },\n          focused: function() {\n            return (document.activeElement === $module[0]);\n          },\n          focusedOnSearch: function() {\n            return (document.activeElement === $search[0]);\n          },\n          allFiltered: function() {\n            return( (module.is.multiple() || module.has.search()) && !(settings.hideAdditions == false && module.has.userSuggestion()) && !module.has.message() && module.has.allResultsFiltered() );\n          },\n          hidden: function($subMenu) {\n            return !module.is.visible($subMenu);\n          },\n          initialLoad: function() {\n            return initialLoad;\n          },\n          inObject: function(needle, object) {\n            var\n              found = false\n            ;\n            $.each(object, function(index, property) {\n              if(property == needle) {\n                found = true;\n                return true;\n              }\n            });\n            return found;\n          },\n          multiple: function() {\n            return $module.hasClass(className.multiple);\n          },\n          remote: function() {\n            return settings.apiSettings && module.can.useAPI();\n          },\n          single: function() {\n            return !module.is.multiple();\n          },\n          selectMutation: function(mutations) {\n            var\n              selectChanged = false\n            ;\n            $.each(mutations, function(index, mutation) {\n              if(mutation.target && $(mutation.target).is('select')) {\n                selectChanged = true;\n                return true;\n              }\n            });\n            return selectChanged;\n          },\n          search: function() {\n            return $module.hasClass(className.search);\n          },\n          searchSelection: function() {\n            return ( module.has.search() && $search.parent(selector.dropdown).length === 1 );\n          },\n          selection: function() {\n            return $module.hasClass(className.selection);\n          },\n          userValue: function(value) {\n            return ($.inArray(value, module.get.userValues()) !== -1);\n          },\n          upward: function($menu) {\n            var $element = $menu || $module;\n            return $element.hasClass(className.upward);\n          },\n          visible: function($subMenu) {\n            return ($subMenu)\n              ? $subMenu.hasClass(className.visible)\n              : $menu.hasClass(className.visible)\n            ;\n          },\n          verticallyScrollableContext: function() {\n            var\n              overflowY = ($context.get(0) !== window)\n                ? $context.css('overflow-y')\n                : false\n            ;\n            return (overflowY == 'auto' || overflowY == 'scroll');\n          },\n          horizontallyScrollableContext: function() {\n            var\n              overflowX = ($context.get(0) !== window)\n                ? $context.css('overflow-X')\n                : false\n            ;\n            return (overflowX == 'auto' || overflowX == 'scroll');\n          }\n        },\n\n        can: {\n          activate: function($item) {\n            if(settings.useLabels) {\n              return true;\n            }\n            if(!module.has.maxSelections()) {\n              return true;\n            }\n            if(module.has.maxSelections() && $item.hasClass(className.active)) {\n              return true;\n            }\n            return false;\n          },\n          openDownward: function($subMenu) {\n            var\n              $currentMenu    = $subMenu || $menu,\n              canOpenDownward = true,\n              onScreen        = {},\n              calculations\n            ;\n            $currentMenu\n              .addClass(className.loading)\n            ;\n            calculations = {\n              context: {\n                offset    : ($context.get(0) === window)\n                  ? { top: 0, left: 0}\n                  : $context.offset(),\n                scrollTop : $context.scrollTop(),\n                height    : $context.outerHeight()\n              },\n              menu : {\n                offset: $currentMenu.offset(),\n                height: $currentMenu.outerHeight()\n              }\n            };\n            if(module.is.verticallyScrollableContext()) {\n              calculations.menu.offset.top += calculations.context.scrollTop;\n            }\n            onScreen = {\n              above : (calculations.context.scrollTop) <= calculations.menu.offset.top - calculations.context.offset.top - calculations.menu.height,\n              below : (calculations.context.scrollTop + calculations.context.height) >= calculations.menu.offset.top - calculations.context.offset.top + calculations.menu.height\n            };\n            if(onScreen.below) {\n              module.verbose('Dropdown can fit in context downward', onScreen);\n              canOpenDownward = true;\n            }\n            else if(!onScreen.below && !onScreen.above) {\n              module.verbose('Dropdown cannot fit in either direction, favoring downward', onScreen);\n              canOpenDownward = true;\n            }\n            else {\n              module.verbose('Dropdown cannot fit below, opening upward', onScreen);\n              canOpenDownward = false;\n            }\n            $currentMenu.removeClass(className.loading);\n            return canOpenDownward;\n          },\n          openRightward: function($subMenu) {\n            var\n              $currentMenu     = $subMenu || $menu,\n              canOpenRightward = true,\n              isOffscreenRight = false,\n              calculations\n            ;\n            $currentMenu\n              .addClass(className.loading)\n            ;\n            calculations = {\n              context: {\n                offset     : ($context.get(0) === window)\n                  ? { top: 0, left: 0}\n                  : $context.offset(),\n                scrollLeft : $context.scrollLeft(),\n                width      : $context.outerWidth()\n              },\n              menu: {\n                offset : $currentMenu.offset(),\n                width  : $currentMenu.outerWidth()\n              }\n            };\n            if(module.is.horizontallyScrollableContext()) {\n              calculations.menu.offset.left += calculations.context.scrollLeft;\n            }\n            isOffscreenRight = (calculations.menu.offset.left - calculations.context.offset.left + calculations.menu.width >= calculations.context.scrollLeft + calculations.context.width);\n            if(isOffscreenRight) {\n              module.verbose('Dropdown cannot fit in context rightward', isOffscreenRight);\n              canOpenRightward = false;\n            }\n            $currentMenu.removeClass(className.loading);\n            return canOpenRightward;\n          },\n          click: function() {\n            return (hasTouch || settings.on == 'click');\n          },\n          extendSelect: function() {\n            return settings.allowAdditions || settings.apiSettings;\n          },\n          show: function() {\n            return !module.is.disabled() && (module.has.items() || module.has.message());\n          },\n          useAPI: function() {\n            return $.fn.api !== undefined;\n          }\n        },\n\n        animate: {\n          show: function(callback, $subMenu) {\n            var\n              $currentMenu = $subMenu || $menu,\n              start = ($subMenu)\n                ? function() {}\n                : function() {\n                  module.hideSubMenus();\n                  module.hideOthers();\n                  module.set.active();\n                },\n              transition\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            module.verbose('Doing menu show animation', $currentMenu);\n            module.set.direction($subMenu);\n            transition = module.get.transition($subMenu);\n            if( module.is.selection() ) {\n              module.set.scrollPosition(module.get.selectedItem(), true);\n            }\n            if( module.is.hidden($currentMenu) || module.is.animating($currentMenu) ) {\n              if(transition == 'none') {\n                start();\n                $currentMenu.transition('show');\n                callback.call(element);\n              }\n              else if($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu\n                  .transition({\n                    animation  : transition + ' in',\n                    debug      : settings.debug,\n                    verbose    : settings.verbose,\n                    duration   : settings.duration,\n                    queue      : true,\n                    onStart    : start,\n                    onComplete : function() {\n                      callback.call(element);\n                    }\n                  })\n                ;\n              }\n              else {\n                module.error(error.noTransition, transition);\n              }\n            }\n          },\n          hide: function(callback, $subMenu) {\n            var\n              $currentMenu = $subMenu || $menu,\n              duration = ($subMenu)\n                ? (settings.duration * 0.9)\n                : settings.duration,\n              start = ($subMenu)\n                ? function() {}\n                : function() {\n                  if( module.can.click() ) {\n                    module.unbind.intent();\n                  }\n                  module.remove.active();\n                },\n              transition = module.get.transition($subMenu)\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            if( module.is.visible($currentMenu) || module.is.animating($currentMenu) ) {\n              module.verbose('Doing menu hide animation', $currentMenu);\n\n              if(transition == 'none') {\n                start();\n                $currentMenu.transition('hide');\n                callback.call(element);\n              }\n              else if($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu\n                  .transition({\n                    animation  : transition + ' out',\n                    duration   : settings.duration,\n                    debug      : settings.debug,\n                    verbose    : settings.verbose,\n                    queue      : false,\n                    onStart    : start,\n                    onComplete : function() {\n                      callback.call(element);\n                    }\n                  })\n                ;\n              }\n              else {\n                module.error(error.transition);\n              }\n            }\n          }\n        },\n\n        hideAndClear: function() {\n          module.remove.searchTerm();\n          if( module.has.maxSelections() ) {\n            return;\n          }\n          if(module.has.search()) {\n            module.hide(function() {\n              module.remove.filteredItem();\n            });\n          }\n          else {\n            module.hide();\n          }\n        },\n\n        delay: {\n          show: function() {\n            module.verbose('Delaying show event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.show, settings.delay.show);\n          },\n          hide: function() {\n            module.verbose('Delaying hide event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.hide, settings.delay.hide);\n          }\n        },\n\n        escape: {\n          value: function(value) {\n            var\n              multipleValues = $.isArray(value),\n              stringValue    = (typeof value === 'string'),\n              isUnparsable   = (!stringValue && !multipleValues),\n              hasQuotes      = (stringValue && value.search(regExp.quote) !== -1),\n              values         = []\n            ;\n            if(isUnparsable || !hasQuotes) {\n              return value;\n            }\n            module.debug('Encoding quote values for use in select', value);\n            if(multipleValues) {\n              $.each(value, function(index, value){\n                values.push(value.replace(regExp.quote, '&quot;'));\n              });\n              return values;\n            }\n            return value.replace(regExp.quote, '&quot;');\n          },\n          string: function(text) {\n            text =  String(text);\n            return text.replace(regExp.escape, '\\\\$&');\n          }\n        },\n\n        setting: function(name, value) {\n          module.debug('Changing setting', name, value);\n          if( $.isPlainObject(name) ) {\n            $.extend(true, settings, name);\n          }\n          else if(value !== undefined) {\n            if($.isPlainObject(settings[name])) {\n              $.extend(true, settings[name], value);\n            }\n            else {\n              settings[name] = value;\n            }\n          }\n          else {\n            return settings[name];\n          }\n        },\n        internal: function(name, value) {\n          if( $.isPlainObject(name) ) {\n            $.extend(true, module, name);\n          }\n          else if(value !== undefined) {\n            module[name] = value;\n          }\n          else {\n            return module[name];\n          }\n        },\n        debug: function() {\n          if(!settings.silent && settings.debug) {\n            if(settings.performance) {\n              module.performance.log(arguments);\n            }\n            else {\n              module.debug = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.debug.apply(console, arguments);\n            }\n          }\n        },\n        verbose: function() {\n          if(!settings.silent && settings.verbose && settings.debug) {\n            if(settings.performance) {\n              module.performance.log(arguments);\n            }\n            else {\n              module.verbose = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.verbose.apply(console, arguments);\n            }\n          }\n        },\n        error: function() {\n          if(!settings.silent) {\n            module.error = Function.prototype.bind.call(console.error, console, settings.name + ':');\n            module.error.apply(console, arguments);\n          }\n        },\n        performance: {\n          log: function(message) {\n            var\n              currentTime,\n              executionTime,\n              previousTime\n            ;\n            if(settings.performance) {\n              currentTime   = new Date().getTime();\n              previousTime  = time || currentTime;\n              executionTime = currentTime - previousTime;\n              time          = currentTime;\n              performance.push({\n                'Name'           : message[0],\n                'Arguments'      : [].slice.call(message, 1) || '',\n                'Element'        : element,\n                'Execution Time' : executionTime\n              });\n            }\n            clearTimeout(module.performance.timer);\n            module.performance.timer = setTimeout(module.performance.display, 500);\n          },\n          display: function() {\n            var\n              title = settings.name + ':',\n              totalTime = 0\n            ;\n            time = false;\n            clearTimeout(module.performance.timer);\n            $.each(performance, function(index, data) {\n              totalTime += data['Execution Time'];\n            });\n            title += ' ' + totalTime + 'ms';\n            if(moduleSelector) {\n              title += ' \\'' + moduleSelector + '\\'';\n            }\n            if( (console.group !== undefined || console.table !== undefined) && performance.length > 0) {\n              console.groupCollapsed(title);\n              if(console.table) {\n                console.table(performance);\n              }\n              else {\n                $.each(performance, function(index, data) {\n                  console.log(data['Name'] + ': ' + data['Execution Time']+'ms');\n                });\n              }\n              console.groupEnd();\n            }\n            performance = [];\n          }\n        },\n        invoke: function(query, passedArguments, context) {\n          var\n            object = instance,\n            maxDepth,\n            found,\n            response\n          ;\n          passedArguments = passedArguments || queryArguments;\n          context         = element         || context;\n          if(typeof query == 'string' && object !== undefined) {\n            query    = query.split(/[\\. ]/);\n            maxDepth = query.length - 1;\n            $.each(query, function(depth, value) {\n              var camelCaseValue = (depth != maxDepth)\n                ? value + query[depth + 1].charAt(0).toUpperCase() + query[depth + 1].slice(1)\n                : query\n              ;\n              if( $.isPlainObject( object[camelCaseValue] ) && (depth != maxDepth) ) {\n                object = object[camelCaseValue];\n              }\n              else if( object[camelCaseValue] !== undefined ) {\n                found = object[camelCaseValue];\n                return false;\n              }\n              else if( $.isPlainObject( object[value] ) && (depth != maxDepth) ) {\n                object = object[value];\n              }\n              else if( object[value] !== undefined ) {\n                found = object[value];\n                return false;\n              }\n              else {\n                module.error(error.method, query);\n                return false;\n              }\n            });\n          }\n          if ( $.isFunction( found ) ) {\n            response = found.apply(context, passedArguments);\n          }\n          else if(found !== undefined) {\n            response = found;\n          }\n          if($.isArray(returnedValue)) {\n            returnedValue.push(response);\n          }\n          else if(returnedValue !== undefined) {\n            returnedValue = [returnedValue, response];\n          }\n          else if(response !== undefined) {\n            returnedValue = response;\n          }\n          return found;\n        }\n      };\n\n      if(methodInvoked) {\n        if(instance === undefined) {\n          module.initialize();\n        }\n        module.invoke(query);\n      }\n      else {\n        if(instance !== undefined) {\n          instance.invoke('destroy');\n        }\n        module.initialize();\n      }\n    })\n  ;\n  return (returnedValue !== undefined)\n    ? returnedValue\n    : $allModules\n  ;\n};\n\n$.fn.dropdown.settings = {\n\n  silent                 : false,\n  debug                  : false,\n  verbose                : false,\n  performance            : true,\n\n  on                     : 'click',    // what event should show menu action on item selection\n  action                 : 'activate', // action on item selection (nothing, activate, select, combo, hide, function(){})\n\n  values                 : false,      // specify values to use for dropdown\n\n  apiSettings            : false,\n  selectOnKeydown        : true,       // Whether selection should occur automatically when keyboard shortcuts used\n  minCharacters          : 0,          // Minimum characters required to trigger API call\n\n  filterRemoteData       : false,      // Whether API results should be filtered after being returned for query term\n  saveRemoteData         : true,       // Whether remote name/value pairs should be stored in sessionStorage to allow remote data to be restored on page refresh\n\n  throttle               : 200,        // How long to wait after last user input to search remotely\n\n  context                : window,     // Context to use when determining if on screen\n  direction              : 'auto',     // Whether dropdown should always open in one direction\n  keepOnScreen           : true,       // Whether dropdown should check whether it is on screen before showing\n\n  match                  : 'both',     // what to match against with search selection (both, text, or label)\n  fullTextSearch         : false,      // search anywhere in value (set to 'exact' to require exact matches)\n\n  placeholder            : 'auto',     // whether to convert blank <select> values to placeholder text\n  preserveHTML           : true,       // preserve html when selecting value\n  sortSelect             : false,      // sort selection on init\n\n  forceSelection         : true,       // force a choice on blur with search selection\n\n  allowAdditions         : false,      // whether multiple select should allow user added values\n  ignoreCase             : false,       // whether to consider values not matching in case to be the same\n  hideAdditions          : true,       // whether or not to hide special message prompting a user they can enter a value\n\n  maxSelections          : false,      // When set to a number limits the number of selections to this count\n  useLabels              : true,       // whether multiple select should filter currently active selections from choices\n  delimiter              : ',',        // when multiselect uses normal <input> the values will be delimited with this character\n\n  showOnFocus            : true,       // show menu on focus\n  allowReselection       : false,      // whether current value should trigger callbacks when reselected\n  allowTab               : true,       // add tabindex to element\n  allowCategorySelection : false,      // allow elements with sub-menus to be selected\n\n  fireOnInit             : false,      // Whether callbacks should fire when initializing dropdown values\n\n  transition             : 'auto',     // auto transition will slide down or up based on direction\n  duration               : 200,        // duration of transition\n\n  glyphWidth             : 1.037,      // widest glyph width in em (W is 1.037 em) used to calculate multiselect input width\n\n  // label settings on multi-select\n  label: {\n    transition : 'scale',\n    duration   : 200,\n    variation  : false\n  },\n\n  // delay before event\n  delay : {\n    hide   : 300,\n    show   : 200,\n    search : 20,\n    touch  : 50\n  },\n\n  /* Callbacks */\n  onChange      : function(value, text, $selected){},\n  onAdd         : function(value, text, $selected){},\n  onRemove      : function(value, text, $selected){},\n\n  onLabelSelect : function($selectedLabels){},\n  onLabelCreate : function(value, text) { return $(this); },\n  onLabelRemove : function(value) { return true; },\n  onNoResults   : function(searchTerm) { return true; },\n  onShow        : function(){},\n  onHide        : function(){},\n\n  /* Component */\n  name           : 'Dropdown',\n  namespace      : 'dropdown',\n\n  message: {\n    addResult     : 'Add <b>{term}</b>',\n    count         : '{count} selected',\n    maxSelections : 'Max {maxCount} selections',\n    noResults     : 'No results found.',\n    serverError   : 'There was an error contacting the server'\n  },\n\n  error : {\n    action          : 'You called a dropdown action that was not defined',\n    alreadySetup    : 'Once a select has been initialized behaviors must be called on the created ui dropdown',\n    labels          : 'Allowing user additions currently requires the use of labels.',\n    missingMultiple : '<select> requires multiple property to be set to correctly preserve multiple values',\n    method          : 'The method you called is not defined.',\n    noAPI           : 'The API module is required to load resources remotely',\n    noStorage       : 'Saving remote data requires session storage',\n    noTransition    : 'This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>'\n  },\n\n  regExp : {\n    escape   : /[-[\\]{}()*+?.,\\\\^$|#\\s]/g,\n    quote    : /\"/g\n  },\n\n  metadata : {\n    defaultText     : 'defaultText',\n    defaultValue    : 'defaultValue',\n    placeholderText : 'placeholder',\n    text            : 'text',\n    value           : 'value'\n  },\n\n  // property names for remote query\n  fields: {\n    remoteValues : 'results',  // grouping for api results\n    values       : 'values',   // grouping for all dropdown values\n    disabled     : 'disabled', // whether value should be disabled\n    name         : 'name',     // displayed dropdown text\n    value        : 'value',    // actual dropdown value\n    text         : 'text'      // displayed text when selected\n  },\n\n  keys : {\n    backspace  : 8,\n    delimiter  : 188, // comma\n    deleteKey  : 46,\n    enter      : 13,\n    escape     : 27,\n    pageUp     : 33,\n    pageDown   : 34,\n    leftArrow  : 37,\n    upArrow    : 38,\n    rightArrow : 39,\n    downArrow  : 40\n  },\n\n  selector : {\n    addition     : '.addition',\n    dropdown     : '.ui.dropdown',\n    hidden       : '.hidden',\n    icon         : '> .dropdown.icon',\n    input        : '> input[type=\"hidden\"], > select',\n    item         : '.item',\n    label        : '> .label',\n    remove       : '> .label > .delete.icon',\n    siblingLabel : '.label',\n    menu         : '.menu',\n    message      : '.message',\n    menuIcon     : '.dropdown.icon',\n    search       : 'input.search, .menu > .search > input, .menu input.search',\n    sizer        : '> input.sizer',\n    text         : '> .text:not(.icon)',\n    unselectable : '.disabled, .filtered'\n  },\n\n  className : {\n    active      : 'active',\n    addition    : 'addition',\n    animating   : 'animating',\n    disabled    : 'disabled',\n    empty       : 'empty',\n    dropdown    : 'ui dropdown',\n    filtered    : 'filtered',\n    hidden      : 'hidden transition',\n    item        : 'item',\n    label       : 'ui label',\n    loading     : 'loading',\n    menu        : 'menu',\n    message     : 'message',\n    multiple    : 'multiple',\n    placeholder : 'default',\n    sizer       : 'sizer',\n    search      : 'search',\n    selected    : 'selected',\n    selection   : 'selection',\n    upward      : 'upward',\n    leftward    : 'left',\n    visible     : 'visible'\n  }\n\n};\n\n/* Templates */\n$.fn.dropdown.settings.templates = {\n\n  // generates dropdown from select values\n  dropdown: function(select) {\n    var\n      placeholder = select.placeholder || false,\n      values      = select.values || {},\n      html        = ''\n    ;\n    html +=  '<i class=\"dropdown icon\"></i>';\n    if(select.placeholder) {\n      html += '<div class=\"default text\">' + placeholder + '</div>';\n    }\n    else {\n      html += '<div class=\"text\"></div>';\n    }\n    html += '<div class=\"menu\">';\n    $.each(select.values, function(index, option) {\n      html += (option.disabled)\n        ? '<div class=\"disabled item\" data-value=\"' + option.value + '\">' + option.name + '</div>'\n        : '<div class=\"item\" data-value=\"' + option.value + '\">' + option.name + '</div>'\n      ;\n    });\n    html += '</div>';\n    return html;\n  },\n\n  // generates just menu from select\n  menu: function(response, fields) {\n    var\n      values = response[fields.values] || {},\n      html   = ''\n    ;\n    $.each(values, function(index, option) {\n      var\n        maybeText = (option[fields.text])\n          ? 'data-text=\"' + option[fields.text] + '\"'\n          : '',\n        maybeDisabled = (option[fields.disabled])\n          ? 'disabled '\n          : ''\n      ;\n      html += '<div class=\"'+ maybeDisabled +'item\" data-value=\"' + option[fields.value] + '\"' + maybeText + '>';\n      html +=   option[fields.name];\n      html += '</div>';\n    });\n    return html;\n  },\n\n  // generates label for multiselect\n  label: function(value, text) {\n    return text + '<i class=\"delete icon\"></i>';\n  },\n\n\n  // generates messages like \"No results\"\n  message: function(message) {\n    return message;\n  },\n\n  // generates user addition to selection menu\n  addition: function(choice) {\n    return choice;\n  }\n\n};\n\n})( jQuery, window, document );\n"]},"sourceType":"script","hash":"fa0477f5444ceed6c1bef65bc3e2cae4e7f1cab6"}
