{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$4","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$5","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$6","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$7","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$9","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin/semantic/src/definitions/behaviors/api.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"semantic/src/definitions/behaviors/api.js","filename":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin/semantic/src/definitions/behaviors/api.js","passPerPreset":false,"envName":"development","cwd":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin","root":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin","generatorOpts":{"filename":"/Users/tristan/Documents/Uni/2018/Semester 2/COS 301/Group Project/TicketSalad/ticketsalad/Admin_Application/ticketadmin/semantic/src/definitions/behaviors/api.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"semantic/src/definitions/behaviors/api.js"}},"code":"/*!\n * # Semantic UI - API\n * http://github.com/semantic-org/semantic-ui/\n *\n *\n * Released under the MIT license\n * http://opensource.org/licenses/MIT\n *\n */\n;\n\n(function ($, window, document, undefined) {\n  'use strict';\n\n  var window = typeof window != 'undefined' && window.Math == Math ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\n\n  $.api = $.fn.api = function (parameters) {\n    var // use window context if none specified\n    $allModules = $.isFunction(this) ? $(window) : $(this),\n        moduleSelector = $allModules.selector || '',\n        time = new Date().getTime(),\n        performance = [],\n        query = arguments[0],\n        methodInvoked = typeof query == 'string',\n        queryArguments = [].slice.call(arguments, 1),\n        returnedValue;\n    $allModules.each(function () {\n      var settings = $.isPlainObject(parameters) ? $.extend(true, {}, $.fn.api.settings, parameters) : $.extend({}, $.fn.api.settings),\n          // internal aliases\n      namespace = settings.namespace,\n          metadata = settings.metadata,\n          selector = settings.selector,\n          error = settings.error,\n          className = settings.className,\n          // define namespaces for modules\n      eventNamespace = '.' + namespace,\n          moduleNamespace = 'module-' + namespace,\n          // element that creates request\n      $module = $(this),\n          $form = $module.closest(selector.form),\n          // context used for state\n      $context = settings.stateContext ? $(settings.stateContext) : $module,\n          // request details\n      ajaxSettings,\n          requestSettings,\n          url,\n          data,\n          requestStartTime,\n          // standard module\n      element = this,\n          context = $context[0],\n          instance = $module.data(moduleNamespace),\n          module;\n      module = {\n        initialize: function () {\n          if (!methodInvoked) {\n            module.bind.events();\n          }\n\n          module.instantiate();\n        },\n        instantiate: function () {\n          module.verbose('Storing instance of module', module);\n          instance = module;\n          $module.data(moduleNamespace, instance);\n        },\n        destroy: function () {\n          module.verbose('Destroying previous module for', element);\n          $module.removeData(moduleNamespace).off(eventNamespace);\n        },\n        bind: {\n          events: function () {\n            var triggerEvent = module.get.event();\n\n            if (triggerEvent) {\n              module.verbose('Attaching API events to element', triggerEvent);\n              $module.on(triggerEvent + eventNamespace, module.event.trigger);\n            } else if (settings.on == 'now') {\n              module.debug('Querying API endpoint immediately');\n              module.query();\n            }\n          }\n        },\n        decode: {\n          json: function (response) {\n            if (response !== undefined && typeof response == 'string') {\n              try {\n                response = JSON.parse(response);\n              } catch (e) {// isnt json string\n              }\n            }\n\n            return response;\n          }\n        },\n        read: {\n          cachedResponse: function (url) {\n            var response;\n\n            if (window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n\n            response = sessionStorage.getItem(url);\n            module.debug('Using cached response', url, response);\n            response = module.decode.json(response);\n            return response;\n          }\n        },\n        write: {\n          cachedResponse: function (url, response) {\n            if (response && response === '') {\n              module.debug('Response empty, not caching', response);\n              return;\n            }\n\n            if (window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n\n            if ($.isPlainObject(response)) {\n              response = JSON.stringify(response);\n            }\n\n            sessionStorage.setItem(url, response);\n            module.verbose('Storing cached response for url', url, response);\n          }\n        },\n        query: function () {\n          if (module.is.disabled()) {\n            module.debug('Element is disabled API request aborted');\n            return;\n          }\n\n          if (module.is.loading()) {\n            if (settings.interruptRequests) {\n              module.debug('Interrupting previous request');\n              module.abort();\n            } else {\n              module.debug('Cancelling request, previous request is still pending');\n              return;\n            }\n          } // pass element metadata to url (value, text)\n\n\n          if (settings.defaultData) {\n            $.extend(true, settings.urlData, module.get.defaultData());\n          } // Add form content\n\n\n          if (settings.serializeForm) {\n            settings.data = module.add.formData(settings.data);\n          } // call beforesend and get any settings changes\n\n\n          requestSettings = module.get.settings(); // check if before send cancelled request\n\n          if (requestSettings === false) {\n            module.cancelled = true;\n            module.error(error.beforeSend);\n            return;\n          } else {\n            module.cancelled = false;\n          } // get url\n\n\n          url = module.get.templatedURL();\n\n          if (!url && !module.is.mocked()) {\n            module.error(error.missingURL);\n            return;\n          } // replace variables\n\n\n          url = module.add.urlData(url); // missing url parameters\n\n          if (!url && !module.is.mocked()) {\n            return;\n          }\n\n          requestSettings.url = settings.base + url; // look for jQuery ajax parameters in settings\n\n          ajaxSettings = $.extend(true, {}, settings, {\n            type: settings.method || settings.type,\n            data: data,\n            url: settings.base + url,\n            beforeSend: settings.beforeXHR,\n            success: function () {},\n            failure: function () {},\n            complete: function () {}\n          });\n          module.debug('Querying URL', ajaxSettings.url);\n          module.verbose('Using AJAX settings', ajaxSettings);\n\n          if (settings.cache === 'local' && module.read.cachedResponse(url)) {\n            module.debug('Response returned from local cache');\n            module.request = module.create.request();\n            module.request.resolveWith(context, [module.read.cachedResponse(url)]);\n            return;\n          }\n\n          if (!settings.throttle) {\n            module.debug('Sending request', data, ajaxSettings.method);\n            module.send.request();\n          } else {\n            if (!settings.throttleFirstRequest && !module.timer) {\n              module.debug('Sending request', data, ajaxSettings.method);\n              module.send.request();\n              module.timer = setTimeout(function () {}, settings.throttle);\n            } else {\n              module.debug('Throttling request', settings.throttle);\n              clearTimeout(module.timer);\n              module.timer = setTimeout(function () {\n                if (module.timer) {\n                  delete module.timer;\n                }\n\n                module.debug('Sending throttled request', data, ajaxSettings.method);\n                module.send.request();\n              }, settings.throttle);\n            }\n          }\n        },\n        should: {\n          removeError: function () {\n            return settings.hideError === true || settings.hideError === 'auto' && !module.is.form();\n          }\n        },\n        is: {\n          disabled: function () {\n            return $module.filter(selector.disabled).length > 0;\n          },\n          expectingJSON: function () {\n            return settings.dataType === 'json' || settings.dataType === 'jsonp';\n          },\n          form: function () {\n            return $module.is('form') || $context.is('form');\n          },\n          mocked: function () {\n            return settings.mockResponse || settings.mockResponseAsync || settings.response || settings.responseAsync;\n          },\n          input: function () {\n            return $module.is('input');\n          },\n          loading: function () {\n            return module.request ? module.request.state() == 'pending' : false;\n          },\n          abortedRequest: function (xhr) {\n            if (xhr && xhr.readyState !== undefined && xhr.readyState === 0) {\n              module.verbose('XHR request determined to be aborted');\n              return true;\n            } else {\n              module.verbose('XHR request was not aborted');\n              return false;\n            }\n          },\n          validResponse: function (response) {\n            if (!module.is.expectingJSON() || !$.isFunction(settings.successTest)) {\n              module.verbose('Response is not JSON, skipping validation', settings.successTest, response);\n              return true;\n            }\n\n            module.debug('Checking JSON returned success', settings.successTest, response);\n\n            if (settings.successTest(response)) {\n              module.debug('Response passed success test', response);\n              return true;\n            } else {\n              module.debug('Response failed success test', response);\n              return false;\n            }\n          }\n        },\n        was: {\n          cancelled: function () {\n            return module.cancelled || false;\n          },\n          succesful: function () {\n            return module.request && module.request.state() == 'resolved';\n          },\n          failure: function () {\n            return module.request && module.request.state() == 'rejected';\n          },\n          complete: function () {\n            return module.request && (module.request.state() == 'resolved' || module.request.state() == 'rejected');\n          }\n        },\n        add: {\n          urlData: function (url, urlData) {\n            var requiredVariables, optionalVariables;\n\n            if (url) {\n              requiredVariables = url.match(settings.regExp.required);\n              optionalVariables = url.match(settings.regExp.optional);\n              urlData = urlData || settings.urlData;\n\n              if (requiredVariables) {\n                module.debug('Looking for required URL variables', requiredVariables);\n                $.each(requiredVariables, function (index, templatedString) {\n                  var // allow legacy {$var} style\n                  variable = templatedString.indexOf('$') !== -1 ? templatedString.substr(2, templatedString.length - 3) : templatedString.substr(1, templatedString.length - 2),\n                      value = $.isPlainObject(urlData) && urlData[variable] !== undefined ? urlData[variable] : $module.data(variable) !== undefined ? $module.data(variable) : $context.data(variable) !== undefined ? $context.data(variable) : urlData[variable]; // remove value\n\n                  if (value === undefined) {\n                    module.error(error.requiredParameter, variable, url);\n                    url = false;\n                    return false;\n                  } else {\n                    module.verbose('Found required variable', variable, value);\n                    value = settings.encodeParameters ? module.get.urlEncodedValue(value) : value;\n                    url = url.replace(templatedString, value);\n                  }\n                });\n              }\n\n              if (optionalVariables) {\n                module.debug('Looking for optional URL variables', requiredVariables);\n                $.each(optionalVariables, function (index, templatedString) {\n                  var // allow legacy {/$var} style\n                  variable = templatedString.indexOf('$') !== -1 ? templatedString.substr(3, templatedString.length - 4) : templatedString.substr(2, templatedString.length - 3),\n                      value = $.isPlainObject(urlData) && urlData[variable] !== undefined ? urlData[variable] : $module.data(variable) !== undefined ? $module.data(variable) : $context.data(variable) !== undefined ? $context.data(variable) : urlData[variable]; // optional replacement\n\n                  if (value !== undefined) {\n                    module.verbose('Optional variable Found', variable, value);\n                    url = url.replace(templatedString, value);\n                  } else {\n                    module.verbose('Optional variable not found', variable); // remove preceding slash if set\n\n                    if (url.indexOf('/' + templatedString) !== -1) {\n                      url = url.replace('/' + templatedString, '');\n                    } else {\n                      url = url.replace(templatedString, '');\n                    }\n                  }\n                });\n              }\n            }\n\n            return url;\n          },\n          formData: function (data) {\n            var canSerialize = $.fn.serializeObject !== undefined,\n                formData = canSerialize ? $form.serializeObject() : $form.serialize(),\n                hasOtherData;\n            data = data || settings.data;\n            hasOtherData = $.isPlainObject(data);\n\n            if (hasOtherData) {\n              if (canSerialize) {\n                module.debug('Extending existing data with form data', data, formData);\n                data = $.extend(true, {}, data, formData);\n              } else {\n                module.error(error.missingSerialize);\n                module.debug('Cant extend data. Replacing data with form data', data, formData);\n                data = formData;\n              }\n            } else {\n              module.debug('Adding form data', formData);\n              data = formData;\n            }\n\n            return data;\n          }\n        },\n        send: {\n          request: function () {\n            module.set.loading();\n            module.request = module.create.request();\n\n            if (module.is.mocked()) {\n              module.mockedXHR = module.create.mockedXHR();\n            } else {\n              module.xhr = module.create.xhr();\n            }\n\n            settings.onRequest.call(context, module.request, module.xhr);\n          }\n        },\n        event: {\n          trigger: function (event) {\n            module.query();\n\n            if (event.type == 'submit' || event.type == 'click') {\n              event.preventDefault();\n            }\n          },\n          xhr: {\n            always: function () {// nothing special\n            },\n            done: function (response, textStatus, xhr) {\n              var context = this,\n                  elapsedTime = new Date().getTime() - requestStartTime,\n                  timeLeft = settings.loadingDuration - elapsedTime,\n                  translatedResponse = $.isFunction(settings.onResponse) ? module.is.expectingJSON() ? settings.onResponse.call(context, $.extend(true, {}, response)) : settings.onResponse.call(context, response) : false;\n              timeLeft = timeLeft > 0 ? timeLeft : 0;\n\n              if (translatedResponse) {\n                module.debug('Modified API response in onResponse callback', settings.onResponse, translatedResponse, response);\n                response = translatedResponse;\n              }\n\n              if (timeLeft > 0) {\n                module.debug('Response completed early delaying state change by', timeLeft);\n              }\n\n              setTimeout(function () {\n                if (module.is.validResponse(response)) {\n                  module.request.resolveWith(context, [response, xhr]);\n                } else {\n                  module.request.rejectWith(context, [xhr, 'invalid']);\n                }\n              }, timeLeft);\n            },\n            fail: function (xhr, status, httpMessage) {\n              var context = this,\n                  elapsedTime = new Date().getTime() - requestStartTime,\n                  timeLeft = settings.loadingDuration - elapsedTime;\n              timeLeft = timeLeft > 0 ? timeLeft : 0;\n\n              if (timeLeft > 0) {\n                module.debug('Response completed early delaying state change by', timeLeft);\n              }\n\n              setTimeout(function () {\n                if (module.is.abortedRequest(xhr)) {\n                  module.request.rejectWith(context, [xhr, 'aborted', httpMessage]);\n                } else {\n                  module.request.rejectWith(context, [xhr, 'error', status, httpMessage]);\n                }\n              }, timeLeft);\n            }\n          },\n          request: {\n            done: function (response, xhr) {\n              module.debug('Successful API Response', response);\n\n              if (settings.cache === 'local' && url) {\n                module.write.cachedResponse(url, response);\n                module.debug('Saving server response locally', module.cache);\n              }\n\n              settings.onSuccess.call(context, response, $module, xhr);\n            },\n            complete: function (firstParameter, secondParameter) {\n              var xhr, response; // have to guess callback parameters based on request success\n\n              if (module.was.succesful()) {\n                response = firstParameter;\n                xhr = secondParameter;\n              } else {\n                xhr = firstParameter;\n                response = module.get.responseFromXHR(xhr);\n              }\n\n              module.remove.loading();\n              settings.onComplete.call(context, response, $module, xhr);\n            },\n            fail: function (xhr, status, httpMessage) {\n              var // pull response from xhr if available\n              response = module.get.responseFromXHR(xhr),\n                  errorMessage = module.get.errorFromRequest(response, status, httpMessage);\n\n              if (status == 'aborted') {\n                module.debug('XHR Aborted (Most likely caused by page navigation or CORS Policy)', status, httpMessage);\n                settings.onAbort.call(context, status, $module, xhr);\n                return true;\n              } else if (status == 'invalid') {\n                module.debug('JSON did not pass success test. A server-side error has most likely occurred', response);\n              } else if (status == 'error') {\n                if (xhr !== undefined) {\n                  module.debug('XHR produced a server error', status, httpMessage); // make sure we have an error to display to console\n\n                  if (xhr.status != 200 && httpMessage !== undefined && httpMessage !== '') {\n                    module.error(error.statusMessage + httpMessage, ajaxSettings.url);\n                  }\n\n                  settings.onError.call(context, errorMessage, $module, xhr);\n                }\n              }\n\n              if (settings.errorDuration && status !== 'aborted') {\n                module.debug('Adding error state');\n                module.set.error();\n\n                if (module.should.removeError()) {\n                  setTimeout(module.remove.error, settings.errorDuration);\n                }\n              }\n\n              module.debug('API Request failed', errorMessage, xhr);\n              settings.onFailure.call(context, response, $module, xhr);\n            }\n          }\n        },\n        create: {\n          request: function () {\n            // api request promise\n            return $.Deferred().always(module.event.request.complete).done(module.event.request.done).fail(module.event.request.fail);\n          },\n          mockedXHR: function () {\n            var // xhr does not simulate these properties of xhr but must return them\n            textStatus = false,\n                status = false,\n                httpMessage = false,\n                responder = settings.mockResponse || settings.response,\n                asyncResponder = settings.mockResponseAsync || settings.responseAsync,\n                asyncCallback,\n                response,\n                mockedXHR;\n            mockedXHR = $.Deferred().always(module.event.xhr.complete).done(module.event.xhr.done).fail(module.event.xhr.fail);\n\n            if (responder) {\n              if ($.isFunction(responder)) {\n                module.debug('Using specified synchronous callback', responder);\n                response = responder.call(context, requestSettings);\n              } else {\n                module.debug('Using settings specified response', responder);\n                response = responder;\n              } // simulating response\n\n\n              mockedXHR.resolveWith(context, [response, textStatus, {\n                responseText: response\n              }]);\n            } else if ($.isFunction(asyncResponder)) {\n              asyncCallback = function (response) {\n                module.debug('Async callback returned response', response);\n\n                if (response) {\n                  mockedXHR.resolveWith(context, [response, textStatus, {\n                    responseText: response\n                  }]);\n                } else {\n                  mockedXHR.rejectWith(context, [{\n                    responseText: response\n                  }, status, httpMessage]);\n                }\n              };\n\n              module.debug('Using specified async response callback', asyncResponder);\n              asyncResponder.call(context, requestSettings, asyncCallback);\n            }\n\n            return mockedXHR;\n          },\n          xhr: function () {\n            var xhr; // ajax request promise\n\n            xhr = $.ajax(ajaxSettings).always(module.event.xhr.always).done(module.event.xhr.done).fail(module.event.xhr.fail);\n            module.verbose('Created server request', xhr, ajaxSettings);\n            return xhr;\n          }\n        },\n        set: {\n          error: function () {\n            module.verbose('Adding error state to element', $context);\n            $context.addClass(className.error);\n          },\n          loading: function () {\n            module.verbose('Adding loading state to element', $context);\n            $context.addClass(className.loading);\n            requestStartTime = new Date().getTime();\n          }\n        },\n        remove: {\n          error: function () {\n            module.verbose('Removing error state from element', $context);\n            $context.removeClass(className.error);\n          },\n          loading: function () {\n            module.verbose('Removing loading state from element', $context);\n            $context.removeClass(className.loading);\n          }\n        },\n        get: {\n          responseFromXHR: function (xhr) {\n            return $.isPlainObject(xhr) ? module.is.expectingJSON() ? module.decode.json(xhr.responseText) : xhr.responseText : false;\n          },\n          errorFromRequest: function (response, status, httpMessage) {\n            return $.isPlainObject(response) && response.error !== undefined ? response.error // use json error message\n            : settings.error[status] !== undefined ? // use server error message\n            settings.error[status] : httpMessage;\n          },\n          request: function () {\n            return module.request || false;\n          },\n          xhr: function () {\n            return module.xhr || false;\n          },\n          settings: function () {\n            var runSettings;\n            runSettings = settings.beforeSend.call(context, settings);\n\n            if (runSettings) {\n              if (runSettings.success !== undefined) {\n                module.debug('Legacy success callback detected', runSettings);\n                module.error(error.legacyParameters, runSettings.success);\n                runSettings.onSuccess = runSettings.success;\n              }\n\n              if (runSettings.failure !== undefined) {\n                module.debug('Legacy failure callback detected', runSettings);\n                module.error(error.legacyParameters, runSettings.failure);\n                runSettings.onFailure = runSettings.failure;\n              }\n\n              if (runSettings.complete !== undefined) {\n                module.debug('Legacy complete callback detected', runSettings);\n                module.error(error.legacyParameters, runSettings.complete);\n                runSettings.onComplete = runSettings.complete;\n              }\n            }\n\n            if (runSettings === undefined) {\n              module.error(error.noReturnedValue);\n            }\n\n            if (runSettings === false) {\n              return runSettings;\n            }\n\n            return runSettings !== undefined ? $.extend(true, {}, runSettings) : $.extend(true, {}, settings);\n          },\n          urlEncodedValue: function (value) {\n            var decodedValue = window.decodeURIComponent(value),\n                encodedValue = window.encodeURIComponent(value),\n                alreadyEncoded = decodedValue !== value;\n\n            if (alreadyEncoded) {\n              module.debug('URL value is already encoded, avoiding double encoding', value);\n              return value;\n            }\n\n            module.verbose('Encoding value using encodeURIComponent', value, encodedValue);\n            return encodedValue;\n          },\n          defaultData: function () {\n            var data = {};\n\n            if (!$.isWindow(element)) {\n              if (module.is.input()) {\n                data.value = $module.val();\n              } else if (module.is.form()) {} else {\n                data.text = $module.text();\n              }\n            }\n\n            return data;\n          },\n          event: function () {\n            if ($.isWindow(element) || settings.on == 'now') {\n              module.debug('API called without element, no events attached');\n              return false;\n            } else if (settings.on == 'auto') {\n              if ($module.is('input')) {\n                return element.oninput !== undefined ? 'input' : element.onpropertychange !== undefined ? 'propertychange' : 'keyup';\n              } else if ($module.is('form')) {\n                return 'submit';\n              } else {\n                return 'click';\n              }\n            } else {\n              return settings.on;\n            }\n          },\n          templatedURL: function (action) {\n            action = action || $module.data(metadata.action) || settings.action || false;\n            url = $module.data(metadata.url) || settings.url || false;\n\n            if (url) {\n              module.debug('Using specified url', url);\n              return url;\n            }\n\n            if (action) {\n              module.debug('Looking up url for action', action, settings.api);\n\n              if (settings.api[action] === undefined && !module.is.mocked()) {\n                module.error(error.missingAction, settings.action, settings.api);\n                return;\n              }\n\n              url = settings.api[action];\n            } else if (module.is.form()) {\n              url = $module.attr('action') || $context.attr('action') || false;\n              module.debug('No url or action specified, defaulting to form action', url);\n            }\n\n            return url;\n          }\n        },\n        abort: function () {\n          var xhr = module.get.xhr();\n\n          if (xhr && xhr.state() !== 'resolved') {\n            module.debug('Cancelling API request');\n            xhr.abort();\n          }\n        },\n        // reset state\n        reset: function () {\n          module.remove.error();\n          module.remove.loading();\n        },\n        setting: function (name, value) {\n          module.debug('Changing setting', name, value);\n\n          if ($.isPlainObject(name)) {\n            $.extend(true, settings, name);\n          } else if (value !== undefined) {\n            if ($.isPlainObject(settings[name])) {\n              $.extend(true, settings[name], value);\n            } else {\n              settings[name] = value;\n            }\n          } else {\n            return settings[name];\n          }\n        },\n        internal: function (name, value) {\n          if ($.isPlainObject(name)) {\n            $.extend(true, module, name);\n          } else if (value !== undefined) {\n            module[name] = value;\n          } else {\n            return module[name];\n          }\n        },\n        debug: function () {\n          if (!settings.silent && settings.debug) {\n            if (settings.performance) {\n              module.performance.log(arguments);\n            } else {\n              module.debug = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.debug.apply(console, arguments);\n            }\n          }\n        },\n        verbose: function () {\n          if (!settings.silent && settings.verbose && settings.debug) {\n            if (settings.performance) {\n              module.performance.log(arguments);\n            } else {\n              module.verbose = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.verbose.apply(console, arguments);\n            }\n          }\n        },\n        error: function () {\n          if (!settings.silent) {\n            module.error = Function.prototype.bind.call(console.error, console, settings.name + ':');\n            module.error.apply(console, arguments);\n          }\n        },\n        performance: {\n          log: function (message) {\n            var currentTime, executionTime, previousTime;\n\n            if (settings.performance) {\n              currentTime = new Date().getTime();\n              previousTime = time || currentTime;\n              executionTime = currentTime - previousTime;\n              time = currentTime;\n              performance.push({\n                'Name': message[0],\n                'Arguments': [].slice.call(message, 1) || '',\n                //'Element'        : element,\n                'Execution Time': executionTime\n              });\n            }\n\n            clearTimeout(module.performance.timer);\n            module.performance.timer = setTimeout(module.performance.display, 500);\n          },\n          display: function () {\n            var title = settings.name + ':',\n                totalTime = 0;\n            time = false;\n            clearTimeout(module.performance.timer);\n            $.each(performance, function (index, data) {\n              totalTime += data['Execution Time'];\n            });\n            title += ' ' + totalTime + 'ms';\n\n            if (moduleSelector) {\n              title += ' \\'' + moduleSelector + '\\'';\n            }\n\n            if ((console.group !== undefined || console.table !== undefined) && performance.length > 0) {\n              console.groupCollapsed(title);\n\n              if (console.table) {\n                console.table(performance);\n              } else {\n                $.each(performance, function (index, data) {\n                  console.log(data['Name'] + ': ' + data['Execution Time'] + 'ms');\n                });\n              }\n\n              console.groupEnd();\n            }\n\n            performance = [];\n          }\n        },\n        invoke: function (query, passedArguments, context) {\n          var object = instance,\n              maxDepth,\n              found,\n              response;\n          passedArguments = passedArguments || queryArguments;\n          context = element || context;\n\n          if (typeof query == 'string' && object !== undefined) {\n            query = query.split(/[\\. ]/);\n            maxDepth = query.length - 1;\n            $.each(query, function (depth, value) {\n              var camelCaseValue = depth != maxDepth ? value + query[depth + 1].charAt(0).toUpperCase() + query[depth + 1].slice(1) : query;\n\n              if ($.isPlainObject(object[camelCaseValue]) && depth != maxDepth) {\n                object = object[camelCaseValue];\n              } else if (object[camelCaseValue] !== undefined) {\n                found = object[camelCaseValue];\n                return false;\n              } else if ($.isPlainObject(object[value]) && depth != maxDepth) {\n                object = object[value];\n              } else if (object[value] !== undefined) {\n                found = object[value];\n                return false;\n              } else {\n                module.error(error.method, query);\n                return false;\n              }\n            });\n          }\n\n          if ($.isFunction(found)) {\n            response = found.apply(context, passedArguments);\n          } else if (found !== undefined) {\n            response = found;\n          }\n\n          if ($.isArray(returnedValue)) {\n            returnedValue.push(response);\n          } else if (returnedValue !== undefined) {\n            returnedValue = [returnedValue, response];\n          } else if (response !== undefined) {\n            returnedValue = response;\n          }\n\n          return found;\n        }\n      };\n\n      if (methodInvoked) {\n        if (instance === undefined) {\n          module.initialize();\n        }\n\n        module.invoke(query);\n      } else {\n        if (instance !== undefined) {\n          instance.invoke('destroy');\n        }\n\n        module.initialize();\n      }\n    });\n    return returnedValue !== undefined ? returnedValue : this;\n  };\n\n  $.api.settings = {\n    name: 'API',\n    namespace: 'api',\n    debug: false,\n    verbose: false,\n    performance: true,\n    // object containing all templates endpoints\n    api: {},\n    // whether to cache responses\n    cache: true,\n    // whether new requests should abort previous requests\n    interruptRequests: true,\n    // event binding\n    on: 'auto',\n    // context for applying state classes\n    stateContext: false,\n    // duration for loading state\n    loadingDuration: 0,\n    // whether to hide errors after a period of time\n    hideError: 'auto',\n    // duration for error state\n    errorDuration: 2000,\n    // whether parameters should be encoded with encodeURIComponent\n    encodeParameters: true,\n    // API action to use\n    action: false,\n    // templated URL to use\n    url: false,\n    // base URL to apply to all endpoints\n    base: '',\n    // data that will\n    urlData: {},\n    // whether to add default data to url data\n    defaultData: true,\n    // whether to serialize closest form\n    serializeForm: false,\n    // how long to wait before request should occur\n    throttle: 0,\n    // whether to throttle first request or only repeated\n    throttleFirstRequest: true,\n    // standard ajax settings\n    method: 'get',\n    data: {},\n    dataType: 'json',\n    // mock response\n    mockResponse: false,\n    mockResponseAsync: false,\n    // aliases for mock\n    response: false,\n    responseAsync: false,\n    // callbacks before request\n    beforeSend: function (settings) {\n      return settings;\n    },\n    beforeXHR: function (xhr) {},\n    onRequest: function (promise, xhr) {},\n    // after request\n    onResponse: false,\n    // function(response) { },\n    // response was successful, if JSON passed validation\n    onSuccess: function (response, $module) {},\n    // request finished without aborting\n    onComplete: function (response, $module) {},\n    // failed JSON success test\n    onFailure: function (response, $module) {},\n    // server error\n    onError: function (errorMessage, $module) {},\n    // request aborted\n    onAbort: function (errorMessage, $module) {},\n    successTest: false,\n    // errors\n    error: {\n      beforeSend: 'The before send function has aborted the request',\n      error: 'There was an error with your request',\n      exitConditions: 'API Request Aborted. Exit conditions met',\n      JSONParse: 'JSON could not be parsed during error handling',\n      legacyParameters: 'You are using legacy API success callback names',\n      method: 'The method you called is not defined',\n      missingAction: 'API action used but no url was defined',\n      missingSerialize: 'jquery-serialize-object is required to add form data to an existing data object',\n      missingURL: 'No URL specified for api event',\n      noReturnedValue: 'The beforeSend callback must return a settings object, beforeSend ignored.',\n      noStorage: 'Caching responses locally requires session storage',\n      parseError: 'There was an error parsing your request',\n      requiredParameter: 'Missing a required URL parameter: ',\n      statusMessage: 'Server gave an error: ',\n      timeout: 'Your request timed out'\n    },\n    regExp: {\n      required: /\\{\\$*[A-z0-9]+\\}/g,\n      optional: /\\{\\/\\$*[A-z0-9]+\\}/g\n    },\n    className: {\n      loading: 'loading',\n      error: 'error'\n    },\n    selector: {\n      disabled: '.disabled',\n      form: 'form'\n    },\n    metadata: {\n      action: 'action',\n      url: 'url'\n    }\n  };\n})(jQuery, window, document);","map":{"version":3,"sources":["semantic/src/definitions/behaviors/api.js"],"names":["$","window","document","undefined","Math","self","Function","api","fn","parameters","$allModules","isFunction","moduleSelector","selector","time","Date","getTime","performance","query","arguments","methodInvoked","queryArguments","slice","call","returnedValue","each","settings","isPlainObject","extend","namespace","metadata","error","className","eventNamespace","moduleNamespace","$module","$form","closest","form","$context","stateContext","ajaxSettings","requestSettings","url","data","requestStartTime","element","context","instance","module","initialize","bind","events","instantiate","verbose","destroy","removeData","off","triggerEvent","get","event","on","trigger","debug","decode","json","response","JSON","parse","e","read","cachedResponse","Storage","noStorage","sessionStorage","getItem","write","stringify","setItem","is","disabled","loading","interruptRequests","abort","defaultData","urlData","serializeForm","add","formData","cancelled","beforeSend","templatedURL","mocked","missingURL","base","type","method","beforeXHR","success","failure","complete","cache","request","create","resolveWith","throttle","send","throttleFirstRequest","timer","setTimeout","clearTimeout","should","removeError","hideError","filter","length","expectingJSON","dataType","mockResponse","mockResponseAsync","responseAsync","input","state","abortedRequest","xhr","readyState","validResponse","successTest","was","succesful","requiredVariables","optionalVariables","match","regExp","required","optional","index","templatedString","variable","indexOf","substr","value","requiredParameter","encodeParameters","urlEncodedValue","replace","canSerialize","serializeObject","serialize","hasOtherData","missingSerialize","set","mockedXHR","onRequest","preventDefault","always","done","textStatus","elapsedTime","timeLeft","loadingDuration","translatedResponse","onResponse","rejectWith","fail","status","httpMessage","onSuccess","firstParameter","secondParameter","responseFromXHR","remove","onComplete","errorMessage","errorFromRequest","onAbort","statusMessage","onError","errorDuration","onFailure","Deferred","responder","asyncResponder","asyncCallback","responseText","ajax","addClass","removeClass","runSettings","legacyParameters","noReturnedValue","decodedValue","decodeURIComponent","encodedValue","encodeURIComponent","alreadyEncoded","isWindow","val","text","oninput","onpropertychange","action","missingAction","attr","reset","setting","name","internal","silent","log","prototype","console","info","apply","message","currentTime","executionTime","previousTime","push","display","title","totalTime","group","table","groupCollapsed","groupEnd","invoke","passedArguments","object","maxDepth","found","split","depth","camelCaseValue","charAt","toUpperCase","isArray","promise","exitConditions","JSONParse","parseError","timeout","jQuery"],"mappings":"AAAA;;;;;;;;;AAUA;;AAAC,CAAC,UAAUA,CAAV,EAAaC,MAAb,EAAqBC,QAArB,EAA+BC,SAA/B,EAA0C;AAE5C;;AAEA,MACEF,SAAU,OAAOA,MAAP,IAAiB,WAAjB,IAAgCA,OAAOG,IAAP,IAAeA,IAAhD,GACLH,MADK,GAEJ,OAAOI,IAAP,IAAe,WAAf,IAA8BA,KAAKD,IAAL,IAAaA,IAA5C,GACEC,IADF,GAEEC,SAAS,aAAT,GALR;;AAQAN,IAAEO,GAAF,GAAQP,EAAEQ,EAAF,CAAKD,GAAL,GAAW,UAASE,UAAT,EAAqB;AAEtC,QACE;AACAC,kBAAkBV,EAAEW,UAAF,CAAa,IAAb,IACZX,EAAEC,MAAF,CADY,GAEZD,EAAE,IAAF,CAJR;AAAA,QAKEY,iBAAiBF,YAAYG,QAAZ,IAAwB,EAL3C;AAAA,QAMEC,OAAiB,IAAIC,IAAJ,GAAWC,OAAX,EANnB;AAAA,QAOEC,cAAiB,EAPnB;AAAA,QASEC,QAAiBC,UAAU,CAAV,CATnB;AAAA,QAUEC,gBAAkB,OAAOF,KAAP,IAAgB,QAVpC;AAAA,QAWEG,iBAAiB,GAAGC,KAAH,CAASC,IAAT,CAAcJ,SAAd,EAAyB,CAAzB,CAXnB;AAAA,QAaEK,aAbF;AAgBAd,gBACGe,IADH,CACQ,YAAW;AACf,UACEC,WAAsB1B,EAAE2B,aAAF,CAAgBlB,UAAhB,CAAF,GAChBT,EAAE4B,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmB5B,EAAEQ,EAAF,CAAKD,GAAL,CAASmB,QAA5B,EAAsCjB,UAAtC,CADgB,GAEhBT,EAAE4B,MAAF,CAAS,EAAT,EAAa5B,EAAEQ,EAAF,CAAKD,GAAL,CAASmB,QAAtB,CAHN;AAAA,UAKE;AACAG,kBAAkBH,SAASG,SAN7B;AAAA,UAOEC,WAAkBJ,SAASI,QAP7B;AAAA,UAQEjB,WAAkBa,SAASb,QAR7B;AAAA,UASEkB,QAAkBL,SAASK,KAT7B;AAAA,UAUEC,YAAkBN,SAASM,SAV7B;AAAA,UAYE;AACAC,uBAAkB,MAAMJ,SAb1B;AAAA,UAcEK,kBAAkB,YAAYL,SAdhC;AAAA,UAgBE;AACAM,gBAAkBnC,EAAE,IAAF,CAjBpB;AAAA,UAkBEoC,QAAkBD,QAAQE,OAAR,CAAgBxB,SAASyB,IAAzB,CAlBpB;AAAA,UAoBE;AACAC,iBAAmBb,SAASc,YAAV,GACdxC,EAAE0B,SAASc,YAAX,CADc,GAEdL,OAvBN;AAAA,UAyBE;AACAM,kBA1BF;AAAA,UA2BEC,eA3BF;AAAA,UA4BEC,GA5BF;AAAA,UA6BEC,IA7BF;AAAA,UA8BEC,gBA9BF;AAAA,UAgCE;AACAC,gBAAkB,IAjCpB;AAAA,UAkCEC,UAAkBR,SAAS,CAAT,CAlCpB;AAAA,UAmCES,WAAkBb,QAAQS,IAAR,CAAaV,eAAb,CAnCpB;AAAA,UAoCEe,MApCF;AAuCAA,eAAS;AAEPC,oBAAY,YAAW;AACrB,cAAG,CAAC9B,aAAJ,EAAmB;AACjB6B,mBAAOE,IAAP,CAAYC,MAAZ;AACD;;AACDH,iBAAOI,WAAP;AACD,SAPM;AASPA,qBAAa,YAAW;AACtBJ,iBAAOK,OAAP,CAAe,4BAAf,EAA6CL,MAA7C;AACAD,qBAAWC,MAAX;AACAd,kBACGS,IADH,CACQV,eADR,EACyBc,QADzB;AAGD,SAfM;AAiBPO,iBAAS,YAAW;AAClBN,iBAAOK,OAAP,CAAe,gCAAf,EAAiDR,OAAjD;AACAX,kBACGqB,UADH,CACctB,eADd,EAEGuB,GAFH,CAEOxB,cAFP;AAID,SAvBM;AAyBPkB,cAAM;AACJC,kBAAQ,YAAW;AACjB,gBACEM,eAAeT,OAAOU,GAAP,CAAWC,KAAX,EADjB;;AAGA,gBAAIF,YAAJ,EAAmB;AACjBT,qBAAOK,OAAP,CAAe,iCAAf,EAAkDI,YAAlD;AACAvB,sBACG0B,EADH,CACMH,eAAezB,cADrB,EACqCgB,OAAOW,KAAP,CAAaE,OADlD;AAGD,aALD,MAMK,IAAGpC,SAASmC,EAAT,IAAe,KAAlB,EAAyB;AAC5BZ,qBAAOc,KAAP,CAAa,mCAAb;AACAd,qBAAO/B,KAAP;AACD;AACF;AAfG,SAzBC;AA2CP8C,gBAAQ;AACNC,gBAAM,UAASC,QAAT,EAAmB;AACvB,gBAAGA,aAAa/D,SAAb,IAA0B,OAAO+D,QAAP,IAAmB,QAAhD,EAA0D;AACxD,kBAAI;AACHA,2BAAWC,KAAKC,KAAL,CAAWF,QAAX,CAAX;AACA,eAFD,CAGA,OAAMG,CAAN,EAAS,CACP;AACD;AACF;;AACD,mBAAOH,QAAP;AACD;AAXK,SA3CD;AAyDPI,cAAM;AACJC,0BAAgB,UAAS5B,GAAT,EAAc;AAC5B,gBACEuB,QADF;;AAGA,gBAAGjE,OAAOuE,OAAP,KAAmBrE,SAAtB,EAAiC;AAC/B8C,qBAAOlB,KAAP,CAAaA,MAAM0C,SAAnB;AACA;AACD;;AACDP,uBAAWQ,eAAeC,OAAf,CAAuBhC,GAAvB,CAAX;AACAM,mBAAOc,KAAP,CAAa,uBAAb,EAAsCpB,GAAtC,EAA2CuB,QAA3C;AACAA,uBAAWjB,OAAOe,MAAP,CAAcC,IAAd,CAAmBC,QAAnB,CAAX;AACA,mBAAOA,QAAP;AACD;AAbG,SAzDC;AAwEPU,eAAO;AACLL,0BAAgB,UAAS5B,GAAT,EAAcuB,QAAd,EAAwB;AACtC,gBAAGA,YAAYA,aAAa,EAA5B,EAAgC;AAC9BjB,qBAAOc,KAAP,CAAa,6BAAb,EAA4CG,QAA5C;AACA;AACD;;AACD,gBAAGjE,OAAOuE,OAAP,KAAmBrE,SAAtB,EAAiC;AAC/B8C,qBAAOlB,KAAP,CAAaA,MAAM0C,SAAnB;AACA;AACD;;AACD,gBAAIzE,EAAE2B,aAAF,CAAgBuC,QAAhB,CAAJ,EAAgC;AAC9BA,yBAAWC,KAAKU,SAAL,CAAeX,QAAf,CAAX;AACD;;AACDQ,2BAAeI,OAAf,CAAuBnC,GAAvB,EAA4BuB,QAA5B;AACAjB,mBAAOK,OAAP,CAAe,iCAAf,EAAkDX,GAAlD,EAAuDuB,QAAvD;AACD;AAfI,SAxEA;AA0FPhD,eAAO,YAAW;AAEhB,cAAG+B,OAAO8B,EAAP,CAAUC,QAAV,EAAH,EAAyB;AACvB/B,mBAAOc,KAAP,CAAa,yCAAb;AACA;AACD;;AAED,cAAGd,OAAO8B,EAAP,CAAUE,OAAV,EAAH,EAAwB;AACtB,gBAAGvD,SAASwD,iBAAZ,EAA+B;AAC7BjC,qBAAOc,KAAP,CAAa,+BAAb;AACAd,qBAAOkC,KAAP;AACD,aAHD,MAIK;AACHlC,qBAAOc,KAAP,CAAa,uDAAb;AACA;AACD;AACF,WAhBe,CAkBhB;;;AACA,cAAGrC,SAAS0D,WAAZ,EAAyB;AACvBpF,cAAE4B,MAAF,CAAS,IAAT,EAAeF,SAAS2D,OAAxB,EAAiCpC,OAAOU,GAAP,CAAWyB,WAAX,EAAjC;AACD,WArBe,CAuBhB;;;AACA,cAAG1D,SAAS4D,aAAZ,EAA2B;AACzB5D,qBAASkB,IAAT,GAAgBK,OAAOsC,GAAP,CAAWC,QAAX,CAAoB9D,SAASkB,IAA7B,CAAhB;AACD,WA1Be,CA4BhB;;;AACAF,4BAAkBO,OAAOU,GAAP,CAAWjC,QAAX,EAAlB,CA7BgB,CA+BhB;;AACA,cAAGgB,oBAAoB,KAAvB,EAA8B;AAC5BO,mBAAOwC,SAAP,GAAmB,IAAnB;AACAxC,mBAAOlB,KAAP,CAAaA,MAAM2D,UAAnB;AACA;AACD,WAJD,MAKK;AACHzC,mBAAOwC,SAAP,GAAmB,KAAnB;AACD,WAvCe,CAyChB;;;AACA9C,gBAAMM,OAAOU,GAAP,CAAWgC,YAAX,EAAN;;AAEA,cAAG,CAAChD,GAAD,IAAQ,CAACM,OAAO8B,EAAP,CAAUa,MAAV,EAAZ,EAAgC;AAC9B3C,mBAAOlB,KAAP,CAAaA,MAAM8D,UAAnB;AACA;AACD,WA/Ce,CAiDhB;;;AACAlD,gBAAMM,OAAOsC,GAAP,CAAWF,OAAX,CAAoB1C,GAApB,CAAN,CAlDgB,CAmDhB;;AACA,cAAI,CAACA,GAAD,IAAQ,CAACM,OAAO8B,EAAP,CAAUa,MAAV,EAAb,EAAiC;AAC/B;AACD;;AAEDlD,0BAAgBC,GAAhB,GAAsBjB,SAASoE,IAAT,GAAgBnD,GAAtC,CAxDgB,CA0DhB;;AACAF,yBAAezC,EAAE4B,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBF,QAAnB,EAA6B;AAC1CqE,kBAAarE,SAASsE,MAAT,IAAmBtE,SAASqE,IADC;AAE1CnD,kBAAaA,IAF6B;AAG1CD,iBAAajB,SAASoE,IAAT,GAAgBnD,GAHa;AAI1C+C,wBAAahE,SAASuE,SAJoB;AAK1CC,qBAAa,YAAW,CAAE,CALgB;AAM1CC,qBAAa,YAAW,CAAE,CANgB;AAO1CC,sBAAa,YAAW,CAAE;AAPgB,WAA7B,CAAf;AAUAnD,iBAAOc,KAAP,CAAa,cAAb,EAA6BtB,aAAaE,GAA1C;AACAM,iBAAOK,OAAP,CAAe,qBAAf,EAAsCb,YAAtC;;AACA,cAAGf,SAAS2E,KAAT,KAAmB,OAAnB,IAA8BpD,OAAOqB,IAAP,CAAYC,cAAZ,CAA2B5B,GAA3B,CAAjC,EAAkE;AAChEM,mBAAOc,KAAP,CAAa,oCAAb;AACAd,mBAAOqD,OAAP,GAAiBrD,OAAOsD,MAAP,CAAcD,OAAd,EAAjB;AACArD,mBAAOqD,OAAP,CAAeE,WAAf,CAA2BzD,OAA3B,EAAoC,CAAEE,OAAOqB,IAAP,CAAYC,cAAZ,CAA2B5B,GAA3B,CAAF,CAApC;AACA;AACD;;AAED,cAAI,CAACjB,SAAS+E,QAAd,EAAyB;AACvBxD,mBAAOc,KAAP,CAAa,iBAAb,EAAgCnB,IAAhC,EAAsCH,aAAauD,MAAnD;AACA/C,mBAAOyD,IAAP,CAAYJ,OAAZ;AACD,WAHD,MAIK;AACH,gBAAG,CAAC5E,SAASiF,oBAAV,IAAkC,CAAC1D,OAAO2D,KAA7C,EAAoD;AAClD3D,qBAAOc,KAAP,CAAa,iBAAb,EAAgCnB,IAAhC,EAAsCH,aAAauD,MAAnD;AACA/C,qBAAOyD,IAAP,CAAYJ,OAAZ;AACArD,qBAAO2D,KAAP,GAAeC,WAAW,YAAU,CAAE,CAAvB,EAAyBnF,SAAS+E,QAAlC,CAAf;AACD,aAJD,MAKK;AACHxD,qBAAOc,KAAP,CAAa,oBAAb,EAAmCrC,SAAS+E,QAA5C;AACAK,2BAAa7D,OAAO2D,KAApB;AACA3D,qBAAO2D,KAAP,GAAeC,WAAW,YAAW;AACnC,oBAAG5D,OAAO2D,KAAV,EAAiB;AACf,yBAAO3D,OAAO2D,KAAd;AACD;;AACD3D,uBAAOc,KAAP,CAAa,2BAAb,EAA0CnB,IAA1C,EAAgDH,aAAauD,MAA7D;AACA/C,uBAAOyD,IAAP,CAAYJ,OAAZ;AACD,eANc,EAMZ5E,SAAS+E,QANG,CAAf;AAOD;AACF;AAEF,SA/LM;AAiMPM,gBAAQ;AACNC,uBAAa,YAAW;AACtB,mBAAStF,SAASuF,SAAT,KAAuB,IAAvB,IAAgCvF,SAASuF,SAAT,KAAuB,MAAvB,IAAiC,CAAChE,OAAO8B,EAAP,CAAUzC,IAAV,EAA3E;AACD;AAHK,SAjMD;AAuMPyC,YAAI;AACFC,oBAAU,YAAW;AACnB,mBAAQ7C,QAAQ+E,MAAR,CAAerG,SAASmE,QAAxB,EAAkCmC,MAAlC,GAA2C,CAAnD;AACD,WAHC;AAIFC,yBAAe,YAAW;AACxB,mBAAO1F,SAAS2F,QAAT,KAAsB,MAAtB,IAAgC3F,SAAS2F,QAAT,KAAsB,OAA7D;AACD,WANC;AAOF/E,gBAAM,YAAW;AACf,mBAAOH,QAAQ4C,EAAR,CAAW,MAAX,KAAsBxC,SAASwC,EAAT,CAAY,MAAZ,CAA7B;AACD,WATC;AAUFa,kBAAQ,YAAW;AACjB,mBAAQlE,SAAS4F,YAAT,IAAyB5F,SAAS6F,iBAAlC,IAAuD7F,SAASwC,QAAhE,IAA4ExC,SAAS8F,aAA7F;AACD,WAZC;AAaFC,iBAAO,YAAW;AAChB,mBAAOtF,QAAQ4C,EAAR,CAAW,OAAX,CAAP;AACD,WAfC;AAgBFE,mBAAS,YAAW;AAClB,mBAAQhC,OAAOqD,OAAR,GACFrD,OAAOqD,OAAP,CAAeoB,KAAf,MAA0B,SADxB,GAEH,KAFJ;AAID,WArBC;AAsBFC,0BAAgB,UAASC,GAAT,EAAc;AAC5B,gBAAGA,OAAOA,IAAIC,UAAJ,KAAmB1H,SAA1B,IAAuCyH,IAAIC,UAAJ,KAAmB,CAA7D,EAAgE;AAC9D5E,qBAAOK,OAAP,CAAe,sCAAf;AACA,qBAAO,IAAP;AACD,aAHD,MAIK;AACHL,qBAAOK,OAAP,CAAe,6BAAf;AACA,qBAAO,KAAP;AACD;AACF,WA/BC;AAgCFwE,yBAAe,UAAS5D,QAAT,EAAmB;AAChC,gBAAK,CAACjB,OAAO8B,EAAP,CAAUqC,aAAV,EAAF,IAAgC,CAACpH,EAAEW,UAAF,CAAae,SAASqG,WAAtB,CAArC,EAA0E;AACxE9E,qBAAOK,OAAP,CAAe,2CAAf,EAA4D5B,SAASqG,WAArE,EAAkF7D,QAAlF;AACA,qBAAO,IAAP;AACD;;AACDjB,mBAAOc,KAAP,CAAa,gCAAb,EAA+CrC,SAASqG,WAAxD,EAAqE7D,QAArE;;AACA,gBAAIxC,SAASqG,WAAT,CAAqB7D,QAArB,CAAJ,EAAqC;AACnCjB,qBAAOc,KAAP,CAAa,8BAAb,EAA6CG,QAA7C;AACA,qBAAO,IAAP;AACD,aAHD,MAIK;AACHjB,qBAAOc,KAAP,CAAa,8BAAb,EAA6CG,QAA7C;AACA,qBAAO,KAAP;AACD;AACF;AA9CC,SAvMG;AAwPP8D,aAAK;AACHvC,qBAAW,YAAW;AACpB,mBAAQxC,OAAOwC,SAAP,IAAoB,KAA5B;AACD,WAHE;AAIHwC,qBAAW,YAAW;AACpB,mBAAQhF,OAAOqD,OAAP,IAAkBrD,OAAOqD,OAAP,CAAeoB,KAAf,MAA0B,UAApD;AACD,WANE;AAOHvB,mBAAS,YAAW;AAClB,mBAAQlD,OAAOqD,OAAP,IAAkBrD,OAAOqD,OAAP,CAAeoB,KAAf,MAA0B,UAApD;AACD,WATE;AAUHtB,oBAAU,YAAW;AACnB,mBAAQnD,OAAOqD,OAAP,KAAmBrD,OAAOqD,OAAP,CAAeoB,KAAf,MAA0B,UAA1B,IAAwCzE,OAAOqD,OAAP,CAAeoB,KAAf,MAA0B,UAArF,CAAR;AACD;AAZE,SAxPE;AAuQPnC,aAAK;AACHF,mBAAS,UAAS1C,GAAT,EAAc0C,OAAd,EAAuB;AAC9B,gBACE6C,iBADF,EAEEC,iBAFF;;AAIA,gBAAGxF,GAAH,EAAQ;AACNuF,kCAAoBvF,IAAIyF,KAAJ,CAAU1G,SAAS2G,MAAT,CAAgBC,QAA1B,CAApB;AACAH,kCAAoBxF,IAAIyF,KAAJ,CAAU1G,SAAS2G,MAAT,CAAgBE,QAA1B,CAApB;AACAlD,wBAAoBA,WAAW3D,SAAS2D,OAAxC;;AACA,kBAAG6C,iBAAH,EAAsB;AACpBjF,uBAAOc,KAAP,CAAa,oCAAb,EAAmDmE,iBAAnD;AACAlI,kBAAEyB,IAAF,CAAOyG,iBAAP,EAA0B,UAASM,KAAT,EAAgBC,eAAhB,EAAiC;AACzD,sBACE;AACAC,6BAAYD,gBAAgBE,OAAhB,CAAwB,GAAxB,MAAiC,CAAC,CAAnC,GACPF,gBAAgBG,MAAhB,CAAuB,CAAvB,EAA0BH,gBAAgBtB,MAAhB,GAAyB,CAAnD,CADO,GAEPsB,gBAAgBG,MAAhB,CAAuB,CAAvB,EAA0BH,gBAAgBtB,MAAhB,GAAyB,CAAnD,CAJN;AAAA,sBAKE0B,QAAW7I,EAAE2B,aAAF,CAAgB0D,OAAhB,KAA4BA,QAAQqD,QAAR,MAAsBvI,SAAnD,GACNkF,QAAQqD,QAAR,CADM,GAELvG,QAAQS,IAAR,CAAa8F,QAAb,MAA2BvI,SAA5B,GACEgC,QAAQS,IAAR,CAAa8F,QAAb,CADF,GAEGnG,SAASK,IAAT,CAAc8F,QAAd,MAA4BvI,SAA7B,GACEoC,SAASK,IAAT,CAAc8F,QAAd,CADF,GAEErD,QAAQqD,QAAR,CAXV,CADyD,CAczD;;AACA,sBAAGG,UAAU1I,SAAb,EAAwB;AACtB8C,2BAAOlB,KAAP,CAAaA,MAAM+G,iBAAnB,EAAsCJ,QAAtC,EAAgD/F,GAAhD;AACAA,0BAAM,KAAN;AACA,2BAAO,KAAP;AACD,mBAJD,MAKK;AACHM,2BAAOK,OAAP,CAAe,yBAAf,EAA0CoF,QAA1C,EAAoDG,KAApD;AACAA,4BAASnH,SAASqH,gBAAV,GACJ9F,OAAOU,GAAP,CAAWqF,eAAX,CAA2BH,KAA3B,CADI,GAEJA,KAFJ;AAIAlG,0BAAMA,IAAIsG,OAAJ,CAAYR,eAAZ,EAA6BI,KAA7B,CAAN;AACD;AACF,iBA5BD;AA6BD;;AACD,kBAAGV,iBAAH,EAAsB;AACpBlF,uBAAOc,KAAP,CAAa,oCAAb,EAAmDmE,iBAAnD;AACAlI,kBAAEyB,IAAF,CAAO0G,iBAAP,EAA0B,UAASK,KAAT,EAAgBC,eAAhB,EAAiC;AACzD,sBACE;AACAC,6BAAYD,gBAAgBE,OAAhB,CAAwB,GAAxB,MAAiC,CAAC,CAAnC,GACPF,gBAAgBG,MAAhB,CAAuB,CAAvB,EAA0BH,gBAAgBtB,MAAhB,GAAyB,CAAnD,CADO,GAEPsB,gBAAgBG,MAAhB,CAAuB,CAAvB,EAA0BH,gBAAgBtB,MAAhB,GAAyB,CAAnD,CAJN;AAAA,sBAKE0B,QAAW7I,EAAE2B,aAAF,CAAgB0D,OAAhB,KAA4BA,QAAQqD,QAAR,MAAsBvI,SAAnD,GACNkF,QAAQqD,QAAR,CADM,GAELvG,QAAQS,IAAR,CAAa8F,QAAb,MAA2BvI,SAA5B,GACEgC,QAAQS,IAAR,CAAa8F,QAAb,CADF,GAEGnG,SAASK,IAAT,CAAc8F,QAAd,MAA4BvI,SAA7B,GACEoC,SAASK,IAAT,CAAc8F,QAAd,CADF,GAEErD,QAAQqD,QAAR,CAXV,CADyD,CAczD;;AACA,sBAAGG,UAAU1I,SAAb,EAAwB;AACtB8C,2BAAOK,OAAP,CAAe,yBAAf,EAA0CoF,QAA1C,EAAoDG,KAApD;AACAlG,0BAAMA,IAAIsG,OAAJ,CAAYR,eAAZ,EAA6BI,KAA7B,CAAN;AACD,mBAHD,MAIK;AACH5F,2BAAOK,OAAP,CAAe,6BAAf,EAA8CoF,QAA9C,EADG,CAEH;;AACA,wBAAG/F,IAAIgG,OAAJ,CAAY,MAAMF,eAAlB,MAAuC,CAAC,CAA3C,EAA8C;AAC5C9F,4BAAMA,IAAIsG,OAAJ,CAAY,MAAMR,eAAlB,EAAmC,EAAnC,CAAN;AACD,qBAFD,MAGK;AACH9F,4BAAMA,IAAIsG,OAAJ,CAAYR,eAAZ,EAA6B,EAA7B,CAAN;AACD;AACF;AACF,iBA7BD;AA8BD;AACF;;AACD,mBAAO9F,GAAP;AACD,WA7EE;AA8EH6C,oBAAU,UAAS5C,IAAT,EAAe;AACvB,gBACEsG,eAAgBlJ,EAAEQ,EAAF,CAAK2I,eAAL,KAAyBhJ,SAD3C;AAAA,gBAEEqF,WAAgB0D,YAAD,GACX9G,MAAM+G,eAAN,EADW,GAEX/G,MAAMgH,SAAN,EAJN;AAAA,gBAKEC,YALF;AAOAzG,mBAAeA,QAAQlB,SAASkB,IAAhC;AACAyG,2BAAerJ,EAAE2B,aAAF,CAAgBiB,IAAhB,CAAf;;AAEA,gBAAGyG,YAAH,EAAiB;AACf,kBAAGH,YAAH,EAAiB;AACfjG,uBAAOc,KAAP,CAAa,wCAAb,EAAuDnB,IAAvD,EAA6D4C,QAA7D;AACA5C,uBAAO5C,EAAE4B,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBgB,IAAnB,EAAyB4C,QAAzB,CAAP;AACD,eAHD,MAIK;AACHvC,uBAAOlB,KAAP,CAAaA,MAAMuH,gBAAnB;AACArG,uBAAOc,KAAP,CAAa,iDAAb,EAAgEnB,IAAhE,EAAsE4C,QAAtE;AACA5C,uBAAO4C,QAAP;AACD;AACF,aAVD,MAWK;AACHvC,qBAAOc,KAAP,CAAa,kBAAb,EAAiCyB,QAAjC;AACA5C,qBAAO4C,QAAP;AACD;;AACD,mBAAO5C,IAAP;AACD;AAzGE,SAvQE;AAmXP8D,cAAM;AACJJ,mBAAS,YAAW;AAClBrD,mBAAOsG,GAAP,CAAWtE,OAAX;AACAhC,mBAAOqD,OAAP,GAAiBrD,OAAOsD,MAAP,CAAcD,OAAd,EAAjB;;AACA,gBAAIrD,OAAO8B,EAAP,CAAUa,MAAV,EAAJ,EAAyB;AACvB3C,qBAAOuG,SAAP,GAAmBvG,OAAOsD,MAAP,CAAciD,SAAd,EAAnB;AACD,aAFD,MAGK;AACHvG,qBAAO2E,GAAP,GAAa3E,OAAOsD,MAAP,CAAcqB,GAAd,EAAb;AACD;;AACDlG,qBAAS+H,SAAT,CAAmBlI,IAAnB,CAAwBwB,OAAxB,EAAiCE,OAAOqD,OAAxC,EAAiDrD,OAAO2E,GAAxD;AACD;AAXG,SAnXC;AAiYPhE,eAAO;AACLE,mBAAS,UAASF,KAAT,EAAgB;AACvBX,mBAAO/B,KAAP;;AACA,gBAAG0C,MAAMmC,IAAN,IAAc,QAAd,IAA0BnC,MAAMmC,IAAN,IAAc,OAA3C,EAAoD;AAClDnC,oBAAM8F,cAAN;AACD;AACF,WANI;AAOL9B,eAAK;AACH+B,oBAAQ,YAAW,CACjB;AACD,aAHE;AAIHC,kBAAM,UAAS1F,QAAT,EAAmB2F,UAAnB,EAA+BjC,GAA/B,EAAoC;AACxC,kBACE7E,UAAqB,IADvB;AAAA,kBAEE+G,cAAsB,IAAI/I,IAAJ,GAAWC,OAAX,KAAuB6B,gBAF/C;AAAA,kBAGEkH,WAAsBrI,SAASsI,eAAT,GAA2BF,WAHnD;AAAA,kBAIEG,qBAAuBjK,EAAEW,UAAF,CAAae,SAASwI,UAAtB,CAAF,GACjBjH,OAAO8B,EAAP,CAAUqC,aAAV,KACE1F,SAASwI,UAAT,CAAoB3I,IAApB,CAAyBwB,OAAzB,EAAkC/C,EAAE4B,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBsC,QAAnB,CAAlC,CADF,GAEExC,SAASwI,UAAT,CAAoB3I,IAApB,CAAyBwB,OAAzB,EAAkCmB,QAAlC,CAHe,GAIjB,KARN;AAUA6F,yBAAYA,WAAW,CAAZ,GACPA,QADO,GAEP,CAFJ;;AAIA,kBAAGE,kBAAH,EAAuB;AACrBhH,uBAAOc,KAAP,CAAa,8CAAb,EAA6DrC,SAASwI,UAAtE,EAAkFD,kBAAlF,EAAsG/F,QAAtG;AACAA,2BAAW+F,kBAAX;AACD;;AACD,kBAAGF,WAAW,CAAd,EAAiB;AACf9G,uBAAOc,KAAP,CAAa,mDAAb,EAAkEgG,QAAlE;AACD;;AACDlD,yBAAW,YAAW;AACpB,oBAAI5D,OAAO8B,EAAP,CAAU+C,aAAV,CAAwB5D,QAAxB,CAAJ,EAAwC;AACtCjB,yBAAOqD,OAAP,CAAeE,WAAf,CAA2BzD,OAA3B,EAAoC,CAACmB,QAAD,EAAW0D,GAAX,CAApC;AACD,iBAFD,MAGK;AACH3E,yBAAOqD,OAAP,CAAe6D,UAAf,CAA0BpH,OAA1B,EAAmC,CAAC6E,GAAD,EAAM,SAAN,CAAnC;AACD;AACF,eAPD,EAOGmC,QAPH;AAQD,aAlCE;AAmCHK,kBAAM,UAASxC,GAAT,EAAcyC,MAAd,EAAsBC,WAAtB,EAAmC;AACvC,kBACEvH,UAAc,IADhB;AAAA,kBAEE+G,cAAe,IAAI/I,IAAJ,GAAWC,OAAX,KAAuB6B,gBAFxC;AAAA,kBAGEkH,WAAerI,SAASsI,eAAT,GAA2BF,WAH5C;AAKAC,yBAAYA,WAAW,CAAZ,GACPA,QADO,GAEP,CAFJ;;AAIA,kBAAGA,WAAW,CAAd,EAAiB;AACf9G,uBAAOc,KAAP,CAAa,mDAAb,EAAkEgG,QAAlE;AACD;;AACDlD,yBAAW,YAAW;AACpB,oBAAI5D,OAAO8B,EAAP,CAAU4C,cAAV,CAAyBC,GAAzB,CAAJ,EAAoC;AAClC3E,yBAAOqD,OAAP,CAAe6D,UAAf,CAA0BpH,OAA1B,EAAmC,CAAC6E,GAAD,EAAM,SAAN,EAAiB0C,WAAjB,CAAnC;AACD,iBAFD,MAGK;AACHrH,yBAAOqD,OAAP,CAAe6D,UAAf,CAA0BpH,OAA1B,EAAmC,CAAC6E,GAAD,EAAM,OAAN,EAAeyC,MAAf,EAAuBC,WAAvB,CAAnC;AACD;AACF,eAPD,EAOGP,QAPH;AAQD;AAxDE,WAPA;AAiELzD,mBAAS;AACPsD,kBAAM,UAAS1F,QAAT,EAAmB0D,GAAnB,EAAwB;AAC5B3E,qBAAOc,KAAP,CAAa,yBAAb,EAAwCG,QAAxC;;AACA,kBAAGxC,SAAS2E,KAAT,KAAmB,OAAnB,IAA8B1D,GAAjC,EAAsC;AACpCM,uBAAO2B,KAAP,CAAaL,cAAb,CAA4B5B,GAA5B,EAAiCuB,QAAjC;AACAjB,uBAAOc,KAAP,CAAa,gCAAb,EAA+Cd,OAAOoD,KAAtD;AACD;;AACD3E,uBAAS6I,SAAT,CAAmBhJ,IAAnB,CAAwBwB,OAAxB,EAAiCmB,QAAjC,EAA2C/B,OAA3C,EAAoDyF,GAApD;AACD,aARM;AASPxB,sBAAU,UAASoE,cAAT,EAAyBC,eAAzB,EAA0C;AAClD,kBACE7C,GADF,EAEE1D,QAFF,CADkD,CAKlD;;AACA,kBAAIjB,OAAO+E,GAAP,CAAWC,SAAX,EAAJ,EAA6B;AAC3B/D,2BAAWsG,cAAX;AACA5C,sBAAW6C,eAAX;AACD,eAHD,MAIK;AACH7C,sBAAW4C,cAAX;AACAtG,2BAAWjB,OAAOU,GAAP,CAAW+G,eAAX,CAA2B9C,GAA3B,CAAX;AACD;;AACD3E,qBAAO0H,MAAP,CAAc1F,OAAd;AACAvD,uBAASkJ,UAAT,CAAoBrJ,IAApB,CAAyBwB,OAAzB,EAAkCmB,QAAlC,EAA4C/B,OAA5C,EAAqDyF,GAArD;AACD,aAzBM;AA0BPwC,kBAAM,UAASxC,GAAT,EAAcyC,MAAd,EAAsBC,WAAtB,EAAmC;AACvC,kBACE;AACApG,yBAAejB,OAAOU,GAAP,CAAW+G,eAAX,CAA2B9C,GAA3B,CAFjB;AAAA,kBAGEiD,eAAe5H,OAAOU,GAAP,CAAWmH,gBAAX,CAA4B5G,QAA5B,EAAsCmG,MAAtC,EAA8CC,WAA9C,CAHjB;;AAKA,kBAAGD,UAAU,SAAb,EAAwB;AACtBpH,uBAAOc,KAAP,CAAa,oEAAb,EAAmFsG,MAAnF,EAA2FC,WAA3F;AACA5I,yBAASqJ,OAAT,CAAiBxJ,IAAjB,CAAsBwB,OAAtB,EAA+BsH,MAA/B,EAAuClI,OAAvC,EAAgDyF,GAAhD;AACA,uBAAO,IAAP;AACD,eAJD,MAKK,IAAGyC,UAAU,SAAb,EAAwB;AAC3BpH,uBAAOc,KAAP,CAAa,8EAAb,EAA6FG,QAA7F;AACD,eAFI,MAGA,IAAGmG,UAAU,OAAb,EAAsB;AACzB,oBAAGzC,QAAQzH,SAAX,EAAsB;AACpB8C,yBAAOc,KAAP,CAAa,6BAAb,EAA4CsG,MAA5C,EAAoDC,WAApD,EADoB,CAEpB;;AACA,sBAAI1C,IAAIyC,MAAJ,IAAc,GAAd,IAAqBC,gBAAgBnK,SAArC,IAAkDmK,gBAAgB,EAAtE,EAA0E;AACxErH,2BAAOlB,KAAP,CAAaA,MAAMiJ,aAAN,GAAsBV,WAAnC,EAAgD7H,aAAaE,GAA7D;AACD;;AACDjB,2BAASuJ,OAAT,CAAiB1J,IAAjB,CAAsBwB,OAAtB,EAA+B8H,YAA/B,EAA6C1I,OAA7C,EAAsDyF,GAAtD;AACD;AACF;;AAED,kBAAGlG,SAASwJ,aAAT,IAA0Bb,WAAW,SAAxC,EAAmD;AACjDpH,uBAAOc,KAAP,CAAa,oBAAb;AACAd,uBAAOsG,GAAP,CAAWxH,KAAX;;AACA,oBAAIkB,OAAO8D,MAAP,CAAcC,WAAd,EAAJ,EAAkC;AAChCH,6BAAW5D,OAAO0H,MAAP,CAAc5I,KAAzB,EAAgCL,SAASwJ,aAAzC;AACD;AACF;;AACDjI,qBAAOc,KAAP,CAAa,oBAAb,EAAmC8G,YAAnC,EAAiDjD,GAAjD;AACAlG,uBAASyJ,SAAT,CAAmB5J,IAAnB,CAAwBwB,OAAxB,EAAiCmB,QAAjC,EAA2C/B,OAA3C,EAAoDyF,GAApD;AACD;AA5DM;AAjEJ,SAjYA;AAkgBPrB,gBAAQ;AAEND,mBAAS,YAAW;AAClB;AACA,mBAAOtG,EAAEoL,QAAF,GACJzB,MADI,CACG1G,OAAOW,KAAP,CAAa0C,OAAb,CAAqBF,QADxB,EAEJwD,IAFI,CAEC3G,OAAOW,KAAP,CAAa0C,OAAb,CAAqBsD,IAFtB,EAGJQ,IAHI,CAGCnH,OAAOW,KAAP,CAAa0C,OAAb,CAAqB8D,IAHtB,CAAP;AAKD,WATK;AAWNZ,qBAAW,YAAY;AACrB,gBACE;AACAK,yBAAiB,KAFnB;AAAA,gBAGEQ,SAAiB,KAHnB;AAAA,gBAIEC,cAAiB,KAJnB;AAAA,gBAKEe,YAAiB3J,SAAS4F,YAAT,IAA8B5F,SAASwC,QAL1D;AAAA,gBAMEoH,iBAAiB5J,SAAS6F,iBAAT,IAA8B7F,SAAS8F,aAN1D;AAAA,gBAOE+D,aAPF;AAAA,gBAQErH,QARF;AAAA,gBASEsF,SATF;AAYAA,wBAAYxJ,EAAEoL,QAAF,GACTzB,MADS,CACF1G,OAAOW,KAAP,CAAagE,GAAb,CAAiBxB,QADf,EAETwD,IAFS,CAEJ3G,OAAOW,KAAP,CAAagE,GAAb,CAAiBgC,IAFb,EAGTQ,IAHS,CAGJnH,OAAOW,KAAP,CAAagE,GAAb,CAAiBwC,IAHb,CAAZ;;AAMA,gBAAGiB,SAAH,EAAc;AACZ,kBAAIrL,EAAEW,UAAF,CAAa0K,SAAb,CAAJ,EAA8B;AAC5BpI,uBAAOc,KAAP,CAAa,sCAAb,EAAqDsH,SAArD;AACAnH,2BAAWmH,UAAU9J,IAAV,CAAewB,OAAf,EAAwBL,eAAxB,CAAX;AACD,eAHD,MAIK;AACHO,uBAAOc,KAAP,CAAa,mCAAb,EAAkDsH,SAAlD;AACAnH,2BAAWmH,SAAX;AACD,eARW,CASZ;;;AACA7B,wBAAUhD,WAAV,CAAsBzD,OAAtB,EAA+B,CAAEmB,QAAF,EAAY2F,UAAZ,EAAwB;AAAE2B,8BAActH;AAAhB,eAAxB,CAA/B;AACD,aAXD,MAYK,IAAIlE,EAAEW,UAAF,CAAa2K,cAAb,CAAJ,EAAmC;AACtCC,8BAAgB,UAASrH,QAAT,EAAmB;AACjCjB,uBAAOc,KAAP,CAAa,kCAAb,EAAiDG,QAAjD;;AAEA,oBAAGA,QAAH,EAAa;AACXsF,4BAAUhD,WAAV,CAAsBzD,OAAtB,EAA+B,CAAEmB,QAAF,EAAY2F,UAAZ,EAAwB;AAAE2B,kCAActH;AAAhB,mBAAxB,CAA/B;AACD,iBAFD,MAGK;AACHsF,4BAAUW,UAAV,CAAqBpH,OAArB,EAA8B,CAAC;AAAEyI,kCAActH;AAAhB,mBAAD,EAA6BmG,MAA7B,EAAqCC,WAArC,CAA9B;AACD;AACF,eATD;;AAUArH,qBAAOc,KAAP,CAAa,yCAAb,EAAwDuH,cAAxD;AACAA,6BAAe/J,IAAf,CAAoBwB,OAApB,EAA6BL,eAA7B,EAA8C6I,aAA9C;AACD;;AACD,mBAAO/B,SAAP;AACD,WAzDK;AA2DN5B,eAAK,YAAW;AACd,gBACEA,GADF,CADc,CAId;;AACAA,kBAAM5H,EAAEyL,IAAF,CAAOhJ,YAAP,EACHkH,MADG,CACI1G,OAAOW,KAAP,CAAagE,GAAb,CAAiB+B,MADrB,EAEHC,IAFG,CAEE3G,OAAOW,KAAP,CAAagE,GAAb,CAAiBgC,IAFnB,EAGHQ,IAHG,CAGEnH,OAAOW,KAAP,CAAagE,GAAb,CAAiBwC,IAHnB,CAAN;AAKAnH,mBAAOK,OAAP,CAAe,wBAAf,EAAyCsE,GAAzC,EAA8CnF,YAA9C;AACA,mBAAOmF,GAAP;AACD;AAvEK,SAlgBD;AA4kBP2B,aAAK;AACHxH,iBAAO,YAAW;AAChBkB,mBAAOK,OAAP,CAAe,+BAAf,EAAgDf,QAAhD;AACAA,qBAASmJ,QAAT,CAAkB1J,UAAUD,KAA5B;AACD,WAJE;AAKHkD,mBAAS,YAAW;AAClBhC,mBAAOK,OAAP,CAAe,iCAAf,EAAkDf,QAAlD;AACAA,qBAASmJ,QAAT,CAAkB1J,UAAUiD,OAA5B;AACApC,+BAAmB,IAAI9B,IAAJ,GAAWC,OAAX,EAAnB;AACD;AATE,SA5kBE;AAwlBP2J,gBAAQ;AACN5I,iBAAO,YAAW;AAChBkB,mBAAOK,OAAP,CAAe,mCAAf,EAAoDf,QAApD;AACAA,qBAASoJ,WAAT,CAAqB3J,UAAUD,KAA/B;AACD,WAJK;AAKNkD,mBAAS,YAAW;AAClBhC,mBAAOK,OAAP,CAAe,qCAAf,EAAsDf,QAAtD;AACAA,qBAASoJ,WAAT,CAAqB3J,UAAUiD,OAA/B;AACD;AARK,SAxlBD;AAmmBPtB,aAAK;AACH+G,2BAAiB,UAAS9C,GAAT,EAAc;AAC7B,mBAAO5H,EAAE2B,aAAF,CAAgBiG,GAAhB,IACF3E,OAAO8B,EAAP,CAAUqC,aAAV,EAAD,GACEnE,OAAOe,MAAP,CAAcC,IAAd,CAAmB2D,IAAI4D,YAAvB,CADF,GAEE5D,IAAI4D,YAHH,GAIH,KAJJ;AAMD,WARE;AASHV,4BAAkB,UAAS5G,QAAT,EAAmBmG,MAAnB,EAA2BC,WAA3B,EAAwC;AACxD,mBAAQtK,EAAE2B,aAAF,CAAgBuC,QAAhB,KAA6BA,SAASnC,KAAT,KAAmB5B,SAAjD,GACH+D,SAASnC,KADN,CACY;AADZ,cAEFL,SAASK,KAAT,CAAesI,MAAf,MAA2BlK,SAA5B,GAAuC;AACrCuB,qBAASK,KAAT,CAAesI,MAAf,CADF,GAEEC,WAJN;AAMD,WAhBE;AAiBHhE,mBAAS,YAAW;AAClB,mBAAOrD,OAAOqD,OAAP,IAAkB,KAAzB;AACD,WAnBE;AAoBHsB,eAAK,YAAW;AACd,mBAAO3E,OAAO2E,GAAP,IAAc,KAArB;AACD,WAtBE;AAuBHlG,oBAAU,YAAW;AACnB,gBACEkK,WADF;AAGAA,0BAAclK,SAASgE,UAAT,CAAoBnE,IAApB,CAAyBwB,OAAzB,EAAkCrB,QAAlC,CAAd;;AACA,gBAAGkK,WAAH,EAAgB;AACd,kBAAGA,YAAY1F,OAAZ,KAAwB/F,SAA3B,EAAsC;AACpC8C,uBAAOc,KAAP,CAAa,kCAAb,EAAiD6H,WAAjD;AACA3I,uBAAOlB,KAAP,CAAaA,MAAM8J,gBAAnB,EAAqCD,YAAY1F,OAAjD;AACA0F,4BAAYrB,SAAZ,GAAwBqB,YAAY1F,OAApC;AACD;;AACD,kBAAG0F,YAAYzF,OAAZ,KAAwBhG,SAA3B,EAAsC;AACpC8C,uBAAOc,KAAP,CAAa,kCAAb,EAAiD6H,WAAjD;AACA3I,uBAAOlB,KAAP,CAAaA,MAAM8J,gBAAnB,EAAqCD,YAAYzF,OAAjD;AACAyF,4BAAYT,SAAZ,GAAwBS,YAAYzF,OAApC;AACD;;AACD,kBAAGyF,YAAYxF,QAAZ,KAAyBjG,SAA5B,EAAuC;AACrC8C,uBAAOc,KAAP,CAAa,mCAAb,EAAkD6H,WAAlD;AACA3I,uBAAOlB,KAAP,CAAaA,MAAM8J,gBAAnB,EAAqCD,YAAYxF,QAAjD;AACAwF,4BAAYhB,UAAZ,GAAyBgB,YAAYxF,QAArC;AACD;AACF;;AACD,gBAAGwF,gBAAgBzL,SAAnB,EAA8B;AAC5B8C,qBAAOlB,KAAP,CAAaA,MAAM+J,eAAnB;AACD;;AACD,gBAAGF,gBAAgB,KAAnB,EAA0B;AACxB,qBAAOA,WAAP;AACD;;AACD,mBAAQA,gBAAgBzL,SAAjB,GACHH,EAAE4B,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBgK,WAAnB,CADG,GAEH5L,EAAE4B,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBF,QAAnB,CAFJ;AAID,WAvDE;AAwDHsH,2BAAiB,UAASH,KAAT,EAAgB;AAC/B,gBACEkD,eAAiB9L,OAAO+L,kBAAP,CAA0BnD,KAA1B,CADnB;AAAA,gBAEEoD,eAAiBhM,OAAOiM,kBAAP,CAA0BrD,KAA1B,CAFnB;AAAA,gBAGEsD,iBAAkBJ,iBAAiBlD,KAHrC;;AAKA,gBAAGsD,cAAH,EAAmB;AACjBlJ,qBAAOc,KAAP,CAAa,wDAAb,EAAuE8E,KAAvE;AACA,qBAAOA,KAAP;AACD;;AACD5F,mBAAOK,OAAP,CAAe,yCAAf,EAA0DuF,KAA1D,EAAiEoD,YAAjE;AACA,mBAAOA,YAAP;AACD,WApEE;AAqEH7G,uBAAa,YAAW;AACtB,gBACExC,OAAO,EADT;;AAGA,gBAAI,CAAC5C,EAAEoM,QAAF,CAAWtJ,OAAX,CAAL,EAA2B;AACzB,kBAAIG,OAAO8B,EAAP,CAAU0C,KAAV,EAAJ,EAAwB;AACtB7E,qBAAKiG,KAAL,GAAa1G,QAAQkK,GAAR,EAAb;AACD,eAFD,MAGK,IAAIpJ,OAAO8B,EAAP,CAAUzC,IAAV,EAAJ,EAAuB,CAE3B,CAFI,MAGA;AACHM,qBAAK0J,IAAL,GAAYnK,QAAQmK,IAAR,EAAZ;AACD;AACF;;AACD,mBAAO1J,IAAP;AACD,WArFE;AAsFHgB,iBAAO,YAAW;AAChB,gBAAI5D,EAAEoM,QAAF,CAAWtJ,OAAX,KAAuBpB,SAASmC,EAAT,IAAe,KAA1C,EAAkD;AAChDZ,qBAAOc,KAAP,CAAa,gDAAb;AACA,qBAAO,KAAP;AACD,aAHD,MAIK,IAAGrC,SAASmC,EAAT,IAAe,MAAlB,EAA0B;AAC7B,kBAAI1B,QAAQ4C,EAAR,CAAW,OAAX,CAAJ,EAA0B;AACxB,uBAAQjC,QAAQyJ,OAAR,KAAoBpM,SAArB,GACH,OADG,GAEF2C,QAAQ0J,gBAAR,KAA6BrM,SAA9B,GACE,gBADF,GAEE,OAJN;AAMD,eAPD,MAQK,IAAIgC,QAAQ4C,EAAR,CAAW,MAAX,CAAJ,EAAyB;AAC5B,uBAAO,QAAP;AACD,eAFI,MAGA;AACH,uBAAO,OAAP;AACD;AACF,aAfI,MAgBA;AACH,qBAAOrD,SAASmC,EAAhB;AACD;AACF,WA9GE;AA+GH8B,wBAAc,UAAS8G,MAAT,EAAiB;AAC7BA,qBAASA,UAAUtK,QAAQS,IAAR,CAAad,SAAS2K,MAAtB,CAAV,IAA2C/K,SAAS+K,MAApD,IAA8D,KAAvE;AACA9J,kBAASR,QAAQS,IAAR,CAAad,SAASa,GAAtB,KAA8BjB,SAASiB,GAAvC,IAA8C,KAAvD;;AACA,gBAAGA,GAAH,EAAQ;AACNM,qBAAOc,KAAP,CAAa,qBAAb,EAAoCpB,GAApC;AACA,qBAAOA,GAAP;AACD;;AACD,gBAAG8J,MAAH,EAAW;AACTxJ,qBAAOc,KAAP,CAAa,2BAAb,EAA0C0I,MAA1C,EAAkD/K,SAASnB,GAA3D;;AACA,kBAAGmB,SAASnB,GAAT,CAAakM,MAAb,MAAyBtM,SAAzB,IAAsC,CAAC8C,OAAO8B,EAAP,CAAUa,MAAV,EAA1C,EAA8D;AAC5D3C,uBAAOlB,KAAP,CAAaA,MAAM2K,aAAnB,EAAkChL,SAAS+K,MAA3C,EAAmD/K,SAASnB,GAA5D;AACA;AACD;;AACDoC,oBAAMjB,SAASnB,GAAT,CAAakM,MAAb,CAAN;AACD,aAPD,MAQK,IAAIxJ,OAAO8B,EAAP,CAAUzC,IAAV,EAAJ,EAAuB;AAC1BK,oBAAMR,QAAQwK,IAAR,CAAa,QAAb,KAA0BpK,SAASoK,IAAT,CAAc,QAAd,CAA1B,IAAqD,KAA3D;AACA1J,qBAAOc,KAAP,CAAa,uDAAb,EAAsEpB,GAAtE;AACD;;AACD,mBAAOA,GAAP;AACD;AAnIE,SAnmBE;AAyuBPwC,eAAO,YAAW;AAChB,cACEyC,MAAM3E,OAAOU,GAAP,CAAWiE,GAAX,EADR;;AAGA,cAAIA,OAAOA,IAAIF,KAAJ,OAAgB,UAA3B,EAAuC;AACrCzE,mBAAOc,KAAP,CAAa,wBAAb;AACA6D,gBAAIzC,KAAJ;AACD;AACF,SAjvBM;AAmvBP;AACAyH,eAAO,YAAW;AAChB3J,iBAAO0H,MAAP,CAAc5I,KAAd;AACAkB,iBAAO0H,MAAP,CAAc1F,OAAd;AACD,SAvvBM;AAyvBP4H,iBAAS,UAASC,IAAT,EAAejE,KAAf,EAAsB;AAC7B5F,iBAAOc,KAAP,CAAa,kBAAb,EAAiC+I,IAAjC,EAAuCjE,KAAvC;;AACA,cAAI7I,EAAE2B,aAAF,CAAgBmL,IAAhB,CAAJ,EAA4B;AAC1B9M,cAAE4B,MAAF,CAAS,IAAT,EAAeF,QAAf,EAAyBoL,IAAzB;AACD,WAFD,MAGK,IAAGjE,UAAU1I,SAAb,EAAwB;AAC3B,gBAAGH,EAAE2B,aAAF,CAAgBD,SAASoL,IAAT,CAAhB,CAAH,EAAoC;AAClC9M,gBAAE4B,MAAF,CAAS,IAAT,EAAeF,SAASoL,IAAT,CAAf,EAA+BjE,KAA/B;AACD,aAFD,MAGK;AACHnH,uBAASoL,IAAT,IAAiBjE,KAAjB;AACD;AACF,WAPI,MAQA;AACH,mBAAOnH,SAASoL,IAAT,CAAP;AACD;AACF,SAzwBM;AA0wBPC,kBAAU,UAASD,IAAT,EAAejE,KAAf,EAAsB;AAC9B,cAAI7I,EAAE2B,aAAF,CAAgBmL,IAAhB,CAAJ,EAA4B;AAC1B9M,cAAE4B,MAAF,CAAS,IAAT,EAAeqB,MAAf,EAAuB6J,IAAvB;AACD,WAFD,MAGK,IAAGjE,UAAU1I,SAAb,EAAwB;AAC3B8C,mBAAO6J,IAAP,IAAejE,KAAf;AACD,WAFI,MAGA;AACH,mBAAO5F,OAAO6J,IAAP,CAAP;AACD;AACF,SApxBM;AAqxBP/I,eAAO,YAAW;AAChB,cAAG,CAACrC,SAASsL,MAAV,IAAoBtL,SAASqC,KAAhC,EAAuC;AACrC,gBAAGrC,SAAST,WAAZ,EAAyB;AACvBgC,qBAAOhC,WAAP,CAAmBgM,GAAnB,CAAuB9L,SAAvB;AACD,aAFD,MAGK;AACH8B,qBAAOc,KAAP,GAAezD,SAAS4M,SAAT,CAAmB/J,IAAnB,CAAwB5B,IAAxB,CAA6B4L,QAAQC,IAArC,EAA2CD,OAA3C,EAAoDzL,SAASoL,IAAT,GAAgB,GAApE,CAAf;AACA7J,qBAAOc,KAAP,CAAasJ,KAAb,CAAmBF,OAAnB,EAA4BhM,SAA5B;AACD;AACF;AACF,SA/xBM;AAgyBPmC,iBAAS,YAAW;AAClB,cAAG,CAAC5B,SAASsL,MAAV,IAAoBtL,SAAS4B,OAA7B,IAAwC5B,SAASqC,KAApD,EAA2D;AACzD,gBAAGrC,SAAST,WAAZ,EAAyB;AACvBgC,qBAAOhC,WAAP,CAAmBgM,GAAnB,CAAuB9L,SAAvB;AACD,aAFD,MAGK;AACH8B,qBAAOK,OAAP,GAAiBhD,SAAS4M,SAAT,CAAmB/J,IAAnB,CAAwB5B,IAAxB,CAA6B4L,QAAQC,IAArC,EAA2CD,OAA3C,EAAoDzL,SAASoL,IAAT,GAAgB,GAApE,CAAjB;AACA7J,qBAAOK,OAAP,CAAe+J,KAAf,CAAqBF,OAArB,EAA8BhM,SAA9B;AACD;AACF;AACF,SA1yBM;AA2yBPY,eAAO,YAAW;AAChB,cAAG,CAACL,SAASsL,MAAb,EAAqB;AACnB/J,mBAAOlB,KAAP,GAAezB,SAAS4M,SAAT,CAAmB/J,IAAnB,CAAwB5B,IAAxB,CAA6B4L,QAAQpL,KAArC,EAA4CoL,OAA5C,EAAqDzL,SAASoL,IAAT,GAAgB,GAArE,CAAf;AACA7J,mBAAOlB,KAAP,CAAasL,KAAb,CAAmBF,OAAnB,EAA4BhM,SAA5B;AACD;AACF,SAhzBM;AAizBPF,qBAAa;AACXgM,eAAK,UAASK,OAAT,EAAkB;AACrB,gBACEC,WADF,EAEEC,aAFF,EAGEC,YAHF;;AAKA,gBAAG/L,SAAST,WAAZ,EAAyB;AACvBsM,4BAAgB,IAAIxM,IAAJ,GAAWC,OAAX,EAAhB;AACAyM,6BAAgB3M,QAAQyM,WAAxB;AACAC,8BAAgBD,cAAcE,YAA9B;AACA3M,qBAAgByM,WAAhB;AACAtM,0BAAYyM,IAAZ,CAAiB;AACf,wBAAmBJ,QAAQ,CAAR,CADJ;AAEf,6BAAmB,GAAGhM,KAAH,CAASC,IAAT,CAAc+L,OAAd,EAAuB,CAAvB,KAA6B,EAFjC;AAGf;AACA,kCAAmBE;AAJJ,eAAjB;AAMD;;AACD1G,yBAAa7D,OAAOhC,WAAP,CAAmB2F,KAAhC;AACA3D,mBAAOhC,WAAP,CAAmB2F,KAAnB,GAA2BC,WAAW5D,OAAOhC,WAAP,CAAmB0M,OAA9B,EAAuC,GAAvC,CAA3B;AACD,WArBU;AAsBXA,mBAAS,YAAW;AAClB,gBACEC,QAAQlM,SAASoL,IAAT,GAAgB,GAD1B;AAAA,gBAEEe,YAAY,CAFd;AAIA/M,mBAAO,KAAP;AACAgG,yBAAa7D,OAAOhC,WAAP,CAAmB2F,KAAhC;AACA5G,cAAEyB,IAAF,CAAOR,WAAP,EAAoB,UAASuH,KAAT,EAAgB5F,IAAhB,EAAsB;AACxCiL,2BAAajL,KAAK,gBAAL,CAAb;AACD,aAFD;AAGAgL,qBAAS,MAAMC,SAAN,GAAkB,IAA3B;;AACA,gBAAGjN,cAAH,EAAmB;AACjBgN,uBAAS,QAAQhN,cAAR,GAAyB,IAAlC;AACD;;AACD,gBAAI,CAACuM,QAAQW,KAAR,KAAkB3N,SAAlB,IAA+BgN,QAAQY,KAAR,KAAkB5N,SAAlD,KAAgEc,YAAYkG,MAAZ,GAAqB,CAAzF,EAA4F;AAC1FgG,sBAAQa,cAAR,CAAuBJ,KAAvB;;AACA,kBAAGT,QAAQY,KAAX,EAAkB;AAChBZ,wBAAQY,KAAR,CAAc9M,WAAd;AACD,eAFD,MAGK;AACHjB,kBAAEyB,IAAF,CAAOR,WAAP,EAAoB,UAASuH,KAAT,EAAgB5F,IAAhB,EAAsB;AACxCuK,0BAAQF,GAAR,CAAYrK,KAAK,MAAL,IAAe,IAAf,GAAsBA,KAAK,gBAAL,CAAtB,GAA6C,IAAzD;AACD,iBAFD;AAGD;;AACDuK,sBAAQc,QAAR;AACD;;AACDhN,0BAAc,EAAd;AACD;AAjDU,SAjzBN;AAo2BPiN,gBAAQ,UAAShN,KAAT,EAAgBiN,eAAhB,EAAiCpL,OAAjC,EAA0C;AAChD,cACEqL,SAASpL,QADX;AAAA,cAEEqL,QAFF;AAAA,cAGEC,KAHF;AAAA,cAIEpK,QAJF;AAMAiK,4BAAkBA,mBAAmB9M,cAArC;AACA0B,oBAAkBD,WAAmBC,OAArC;;AACA,cAAG,OAAO7B,KAAP,IAAgB,QAAhB,IAA4BkN,WAAWjO,SAA1C,EAAqD;AACnDe,oBAAWA,MAAMqN,KAAN,CAAY,OAAZ,CAAX;AACAF,uBAAWnN,MAAMiG,MAAN,GAAe,CAA1B;AACAnH,cAAEyB,IAAF,CAAOP,KAAP,EAAc,UAASsN,KAAT,EAAgB3F,KAAhB,EAAuB;AACnC,kBAAI4F,iBAAkBD,SAASH,QAAV,GACjBxF,QAAQ3H,MAAMsN,QAAQ,CAAd,EAAiBE,MAAjB,CAAwB,CAAxB,EAA2BC,WAA3B,EAAR,GAAmDzN,MAAMsN,QAAQ,CAAd,EAAiBlN,KAAjB,CAAuB,CAAvB,CADlC,GAEjBJ,KAFJ;;AAIA,kBAAIlB,EAAE2B,aAAF,CAAiByM,OAAOK,cAAP,CAAjB,KAA8CD,SAASH,QAA3D,EAAuE;AACrED,yBAASA,OAAOK,cAAP,CAAT;AACD,eAFD,MAGK,IAAIL,OAAOK,cAAP,MAA2BtO,SAA/B,EAA2C;AAC9CmO,wBAAQF,OAAOK,cAAP,CAAR;AACA,uBAAO,KAAP;AACD,eAHI,MAIA,IAAIzO,EAAE2B,aAAF,CAAiByM,OAAOvF,KAAP,CAAjB,KAAqC2F,SAASH,QAAlD,EAA8D;AACjED,yBAASA,OAAOvF,KAAP,CAAT;AACD,eAFI,MAGA,IAAIuF,OAAOvF,KAAP,MAAkB1I,SAAtB,EAAkC;AACrCmO,wBAAQF,OAAOvF,KAAP,CAAR;AACA,uBAAO,KAAP;AACD,eAHI,MAIA;AACH5F,uBAAOlB,KAAP,CAAaA,MAAMiE,MAAnB,EAA2B9E,KAA3B;AACA,uBAAO,KAAP;AACD;AACF,aAvBD;AAwBD;;AACD,cAAKlB,EAAEW,UAAF,CAAc2N,KAAd,CAAL,EAA6B;AAC3BpK,uBAAWoK,MAAMjB,KAAN,CAAYtK,OAAZ,EAAqBoL,eAArB,CAAX;AACD,WAFD,MAGK,IAAGG,UAAUnO,SAAb,EAAwB;AAC3B+D,uBAAWoK,KAAX;AACD;;AACD,cAAGtO,EAAE4O,OAAF,CAAUpN,aAAV,CAAH,EAA6B;AAC3BA,0BAAckM,IAAd,CAAmBxJ,QAAnB;AACD,WAFD,MAGK,IAAG1C,kBAAkBrB,SAArB,EAAgC;AACnCqB,4BAAgB,CAACA,aAAD,EAAgB0C,QAAhB,CAAhB;AACD,WAFI,MAGA,IAAGA,aAAa/D,SAAhB,EAA2B;AAC9BqB,4BAAgB0C,QAAhB;AACD;;AACD,iBAAOoK,KAAP;AACD;AAz5BM,OAAT;;AA45BA,UAAGlN,aAAH,EAAkB;AAChB,YAAG4B,aAAa7C,SAAhB,EAA2B;AACzB8C,iBAAOC,UAAP;AACD;;AACDD,eAAOiL,MAAP,CAAchN,KAAd;AACD,OALD,MAMK;AACH,YAAG8B,aAAa7C,SAAhB,EAA2B;AACzB6C,mBAASkL,MAAT,CAAgB,SAAhB;AACD;;AACDjL,eAAOC,UAAP;AACD;AACF,KAj9BH;AAo9BA,WAAQ1B,kBAAkBrB,SAAnB,GACHqB,aADG,GAEH,IAFJ;AAID,GA1+BD;;AA4+BAxB,IAAEO,GAAF,CAAMmB,QAAN,GAAiB;AAEfoL,UAAoB,KAFL;AAGfjL,eAAoB,KAHL;AAKfkC,WAAoB,KALL;AAMfT,aAAoB,KANL;AAOfrC,iBAAoB,IAPL;AASf;AACAV,SAAoB,EAVL;AAYf;AACA8F,WAAoB,IAbL;AAef;AACAnB,uBAAoB,IAhBL;AAkBf;AACArB,QAAoB,MAnBL;AAqBf;AACArB,kBAAoB,KAtBL;AAwBf;AACAwH,qBAAoB,CAzBL;AA2Bf;AACA/C,eAAoB,MA5BL;AA8Bf;AACAiE,mBAAoB,IA/BL;AAiCf;AACAnC,sBAAoB,IAlCL;AAoCf;AACA0D,YAAoB,KArCL;AAuCf;AACA9J,SAAoB,KAxCL;AA0Cf;AACAmD,UAAoB,EA3CL;AA6Cf;AACAT,aAAoB,EA9CL;AAgDf;AACAD,iBAAuB,IAjDR;AAmDf;AACAE,mBAAuB,KApDR;AAsDf;AACAmB,cAAuB,CAvDR;AAyDf;AACAE,0BAAuB,IA1DR;AA4Df;AACAX,YAAoB,KA7DL;AA8DfpD,UAAoB,EA9DL;AA+DfyE,cAAoB,MA/DL;AAiEf;AACAC,kBAAoB,KAlEL;AAmEfC,uBAAoB,KAnEL;AAqEf;AACArD,cAAoB,KAtEL;AAuEfsD,mBAAoB,KAvEL;AAyEf;AACA9B,gBAAc,UAAShE,QAAT,EAAmB;AAAE,aAAOA,QAAP;AAAkB,KA1EtC;AA2EfuE,eAAc,UAAS2B,GAAT,EAAc,CAAE,CA3Ef;AA4Ef6B,eAAc,UAASoF,OAAT,EAAkBjH,GAAlB,EAAuB,CAAE,CA5ExB;AA8Ef;AACAsC,gBAAc,KA/EC;AA+EM;AAErB;AACAK,eAAc,UAASrG,QAAT,EAAmB/B,OAAnB,EAA4B,CAAE,CAlF7B;AAoFf;AACAyI,gBAAc,UAAS1G,QAAT,EAAmB/B,OAAnB,EAA4B,CAAE,CArF7B;AAuFf;AACAgJ,eAAc,UAASjH,QAAT,EAAmB/B,OAAnB,EAA4B,CAAE,CAxF7B;AA0Ff;AACA8I,aAAc,UAASJ,YAAT,EAAuB1I,OAAvB,EAAgC,CAAE,CA3FjC;AA6Ff;AACA4I,aAAc,UAASF,YAAT,EAAuB1I,OAAvB,EAAgC,CAAE,CA9FjC;AAgGf4F,iBAAc,KAhGC;AAkGf;AACAhG,WAAQ;AACN2D,kBAAoB,kDADd;AAEN3D,aAAoB,sCAFd;AAGN+M,sBAAoB,0CAHd;AAINC,iBAAoB,gDAJd;AAKNlD,wBAAoB,iDALd;AAMN7F,cAAoB,sCANd;AAON0G,qBAAoB,wCAPd;AAQNpD,wBAAoB,iFARd;AASNzD,kBAAoB,gCATd;AAUNiG,uBAAoB,4EAVd;AAWNrH,iBAAoB,oDAXd;AAYNuK,kBAAoB,yCAZd;AAaNlG,yBAAoB,oCAbd;AAcNkC,qBAAoB,wBAdd;AAeNiE,eAAoB;AAfd,KAnGO;AAqHf5G,YAAU;AACRC,gBAAW,mBADH;AAERC,gBAAW;AAFH,KArHK;AA0HfvG,eAAW;AACTiD,eAAU,SADD;AAETlD,aAAU;AAFD,KA1HI;AA+HflB,cAAU;AACRmE,gBAAW,WADH;AAER1C,YAAY;AAFJ,KA/HK;AAoIfR,cAAU;AACR2K,cAAU,QADF;AAER9J,WAAU;AAFF;AApIK,GAAjB;AA4IC,CApoCA,EAooCGuM,MApoCH,EAooCWjP,MApoCX,EAooCmBC,QApoCnB","sourcesContent":["/*!\n * # Semantic UI - API\n * http://github.com/semantic-org/semantic-ui/\n *\n *\n * Released under the MIT license\n * http://opensource.org/licenses/MIT\n *\n */\n\n;(function ($, window, document, undefined) {\n\n'use strict';\n\nvar\n  window = (typeof window != 'undefined' && window.Math == Math)\n    ? window\n    : (typeof self != 'undefined' && self.Math == Math)\n      ? self\n      : Function('return this')()\n;\n\n$.api = $.fn.api = function(parameters) {\n\n  var\n    // use window context if none specified\n    $allModules     = $.isFunction(this)\n        ? $(window)\n        : $(this),\n    moduleSelector = $allModules.selector || '',\n    time           = new Date().getTime(),\n    performance    = [],\n\n    query          = arguments[0],\n    methodInvoked  = (typeof query == 'string'),\n    queryArguments = [].slice.call(arguments, 1),\n\n    returnedValue\n  ;\n\n  $allModules\n    .each(function() {\n      var\n        settings          = ( $.isPlainObject(parameters) )\n          ? $.extend(true, {}, $.fn.api.settings, parameters)\n          : $.extend({}, $.fn.api.settings),\n\n        // internal aliases\n        namespace       = settings.namespace,\n        metadata        = settings.metadata,\n        selector        = settings.selector,\n        error           = settings.error,\n        className       = settings.className,\n\n        // define namespaces for modules\n        eventNamespace  = '.' + namespace,\n        moduleNamespace = 'module-' + namespace,\n\n        // element that creates request\n        $module         = $(this),\n        $form           = $module.closest(selector.form),\n\n        // context used for state\n        $context        = (settings.stateContext)\n          ? $(settings.stateContext)\n          : $module,\n\n        // request details\n        ajaxSettings,\n        requestSettings,\n        url,\n        data,\n        requestStartTime,\n\n        // standard module\n        element         = this,\n        context         = $context[0],\n        instance        = $module.data(moduleNamespace),\n        module\n      ;\n\n      module = {\n\n        initialize: function() {\n          if(!methodInvoked) {\n            module.bind.events();\n          }\n          module.instantiate();\n        },\n\n        instantiate: function() {\n          module.verbose('Storing instance of module', module);\n          instance = module;\n          $module\n            .data(moduleNamespace, instance)\n          ;\n        },\n\n        destroy: function() {\n          module.verbose('Destroying previous module for', element);\n          $module\n            .removeData(moduleNamespace)\n            .off(eventNamespace)\n          ;\n        },\n\n        bind: {\n          events: function() {\n            var\n              triggerEvent = module.get.event()\n            ;\n            if( triggerEvent ) {\n              module.verbose('Attaching API events to element', triggerEvent);\n              $module\n                .on(triggerEvent + eventNamespace, module.event.trigger)\n              ;\n            }\n            else if(settings.on == 'now') {\n              module.debug('Querying API endpoint immediately');\n              module.query();\n            }\n          }\n        },\n\n        decode: {\n          json: function(response) {\n            if(response !== undefined && typeof response == 'string') {\n              try {\n               response = JSON.parse(response);\n              }\n              catch(e) {\n                // isnt json string\n              }\n            }\n            return response;\n          }\n        },\n\n        read: {\n          cachedResponse: function(url) {\n            var\n              response\n            ;\n            if(window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n            response = sessionStorage.getItem(url);\n            module.debug('Using cached response', url, response);\n            response = module.decode.json(response);\n            return response;\n          }\n        },\n        write: {\n          cachedResponse: function(url, response) {\n            if(response && response === '') {\n              module.debug('Response empty, not caching', response);\n              return;\n            }\n            if(window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n            if( $.isPlainObject(response) ) {\n              response = JSON.stringify(response);\n            }\n            sessionStorage.setItem(url, response);\n            module.verbose('Storing cached response for url', url, response);\n          }\n        },\n\n        query: function() {\n\n          if(module.is.disabled()) {\n            module.debug('Element is disabled API request aborted');\n            return;\n          }\n\n          if(module.is.loading()) {\n            if(settings.interruptRequests) {\n              module.debug('Interrupting previous request');\n              module.abort();\n            }\n            else {\n              module.debug('Cancelling request, previous request is still pending');\n              return;\n            }\n          }\n\n          // pass element metadata to url (value, text)\n          if(settings.defaultData) {\n            $.extend(true, settings.urlData, module.get.defaultData());\n          }\n\n          // Add form content\n          if(settings.serializeForm) {\n            settings.data = module.add.formData(settings.data);\n          }\n\n          // call beforesend and get any settings changes\n          requestSettings = module.get.settings();\n\n          // check if before send cancelled request\n          if(requestSettings === false) {\n            module.cancelled = true;\n            module.error(error.beforeSend);\n            return;\n          }\n          else {\n            module.cancelled = false;\n          }\n\n          // get url\n          url = module.get.templatedURL();\n\n          if(!url && !module.is.mocked()) {\n            module.error(error.missingURL);\n            return;\n          }\n\n          // replace variables\n          url = module.add.urlData( url );\n          // missing url parameters\n          if( !url && !module.is.mocked()) {\n            return;\n          }\n\n          requestSettings.url = settings.base + url;\n\n          // look for jQuery ajax parameters in settings\n          ajaxSettings = $.extend(true, {}, settings, {\n            type       : settings.method || settings.type,\n            data       : data,\n            url        : settings.base + url,\n            beforeSend : settings.beforeXHR,\n            success    : function() {},\n            failure    : function() {},\n            complete   : function() {}\n          });\n\n          module.debug('Querying URL', ajaxSettings.url);\n          module.verbose('Using AJAX settings', ajaxSettings);\n          if(settings.cache === 'local' && module.read.cachedResponse(url)) {\n            module.debug('Response returned from local cache');\n            module.request = module.create.request();\n            module.request.resolveWith(context, [ module.read.cachedResponse(url) ]);\n            return;\n          }\n\n          if( !settings.throttle ) {\n            module.debug('Sending request', data, ajaxSettings.method);\n            module.send.request();\n          }\n          else {\n            if(!settings.throttleFirstRequest && !module.timer) {\n              module.debug('Sending request', data, ajaxSettings.method);\n              module.send.request();\n              module.timer = setTimeout(function(){}, settings.throttle);\n            }\n            else {\n              module.debug('Throttling request', settings.throttle);\n              clearTimeout(module.timer);\n              module.timer = setTimeout(function() {\n                if(module.timer) {\n                  delete module.timer;\n                }\n                module.debug('Sending throttled request', data, ajaxSettings.method);\n                module.send.request();\n              }, settings.throttle);\n            }\n          }\n\n        },\n\n        should: {\n          removeError: function() {\n            return ( settings.hideError === true || (settings.hideError === 'auto' && !module.is.form()) );\n          }\n        },\n\n        is: {\n          disabled: function() {\n            return ($module.filter(selector.disabled).length > 0);\n          },\n          expectingJSON: function() {\n            return settings.dataType === 'json' || settings.dataType === 'jsonp';\n          },\n          form: function() {\n            return $module.is('form') || $context.is('form');\n          },\n          mocked: function() {\n            return (settings.mockResponse || settings.mockResponseAsync || settings.response || settings.responseAsync);\n          },\n          input: function() {\n            return $module.is('input');\n          },\n          loading: function() {\n            return (module.request)\n              ? (module.request.state() == 'pending')\n              : false\n            ;\n          },\n          abortedRequest: function(xhr) {\n            if(xhr && xhr.readyState !== undefined && xhr.readyState === 0) {\n              module.verbose('XHR request determined to be aborted');\n              return true;\n            }\n            else {\n              module.verbose('XHR request was not aborted');\n              return false;\n            }\n          },\n          validResponse: function(response) {\n            if( (!module.is.expectingJSON()) || !$.isFunction(settings.successTest) ) {\n              module.verbose('Response is not JSON, skipping validation', settings.successTest, response);\n              return true;\n            }\n            module.debug('Checking JSON returned success', settings.successTest, response);\n            if( settings.successTest(response) ) {\n              module.debug('Response passed success test', response);\n              return true;\n            }\n            else {\n              module.debug('Response failed success test', response);\n              return false;\n            }\n          }\n        },\n\n        was: {\n          cancelled: function() {\n            return (module.cancelled || false);\n          },\n          succesful: function() {\n            return (module.request && module.request.state() == 'resolved');\n          },\n          failure: function() {\n            return (module.request && module.request.state() == 'rejected');\n          },\n          complete: function() {\n            return (module.request && (module.request.state() == 'resolved' || module.request.state() == 'rejected') );\n          }\n        },\n\n        add: {\n          urlData: function(url, urlData) {\n            var\n              requiredVariables,\n              optionalVariables\n            ;\n            if(url) {\n              requiredVariables = url.match(settings.regExp.required);\n              optionalVariables = url.match(settings.regExp.optional);\n              urlData           = urlData || settings.urlData;\n              if(requiredVariables) {\n                module.debug('Looking for required URL variables', requiredVariables);\n                $.each(requiredVariables, function(index, templatedString) {\n                  var\n                    // allow legacy {$var} style\n                    variable = (templatedString.indexOf('$') !== -1)\n                      ? templatedString.substr(2, templatedString.length - 3)\n                      : templatedString.substr(1, templatedString.length - 2),\n                    value   = ($.isPlainObject(urlData) && urlData[variable] !== undefined)\n                      ? urlData[variable]\n                      : ($module.data(variable) !== undefined)\n                        ? $module.data(variable)\n                        : ($context.data(variable) !== undefined)\n                          ? $context.data(variable)\n                          : urlData[variable]\n                  ;\n                  // remove value\n                  if(value === undefined) {\n                    module.error(error.requiredParameter, variable, url);\n                    url = false;\n                    return false;\n                  }\n                  else {\n                    module.verbose('Found required variable', variable, value);\n                    value = (settings.encodeParameters)\n                      ? module.get.urlEncodedValue(value)\n                      : value\n                    ;\n                    url = url.replace(templatedString, value);\n                  }\n                });\n              }\n              if(optionalVariables) {\n                module.debug('Looking for optional URL variables', requiredVariables);\n                $.each(optionalVariables, function(index, templatedString) {\n                  var\n                    // allow legacy {/$var} style\n                    variable = (templatedString.indexOf('$') !== -1)\n                      ? templatedString.substr(3, templatedString.length - 4)\n                      : templatedString.substr(2, templatedString.length - 3),\n                    value   = ($.isPlainObject(urlData) && urlData[variable] !== undefined)\n                      ? urlData[variable]\n                      : ($module.data(variable) !== undefined)\n                        ? $module.data(variable)\n                        : ($context.data(variable) !== undefined)\n                          ? $context.data(variable)\n                          : urlData[variable]\n                  ;\n                  // optional replacement\n                  if(value !== undefined) {\n                    module.verbose('Optional variable Found', variable, value);\n                    url = url.replace(templatedString, value);\n                  }\n                  else {\n                    module.verbose('Optional variable not found', variable);\n                    // remove preceding slash if set\n                    if(url.indexOf('/' + templatedString) !== -1) {\n                      url = url.replace('/' + templatedString, '');\n                    }\n                    else {\n                      url = url.replace(templatedString, '');\n                    }\n                  }\n                });\n              }\n            }\n            return url;\n          },\n          formData: function(data) {\n            var\n              canSerialize = ($.fn.serializeObject !== undefined),\n              formData     = (canSerialize)\n                ? $form.serializeObject()\n                : $form.serialize(),\n              hasOtherData\n            ;\n            data         = data || settings.data;\n            hasOtherData = $.isPlainObject(data);\n\n            if(hasOtherData) {\n              if(canSerialize) {\n                module.debug('Extending existing data with form data', data, formData);\n                data = $.extend(true, {}, data, formData);\n              }\n              else {\n                module.error(error.missingSerialize);\n                module.debug('Cant extend data. Replacing data with form data', data, formData);\n                data = formData;\n              }\n            }\n            else {\n              module.debug('Adding form data', formData);\n              data = formData;\n            }\n            return data;\n          }\n        },\n\n        send: {\n          request: function() {\n            module.set.loading();\n            module.request = module.create.request();\n            if( module.is.mocked() ) {\n              module.mockedXHR = module.create.mockedXHR();\n            }\n            else {\n              module.xhr = module.create.xhr();\n            }\n            settings.onRequest.call(context, module.request, module.xhr);\n          }\n        },\n\n        event: {\n          trigger: function(event) {\n            module.query();\n            if(event.type == 'submit' || event.type == 'click') {\n              event.preventDefault();\n            }\n          },\n          xhr: {\n            always: function() {\n              // nothing special\n            },\n            done: function(response, textStatus, xhr) {\n              var\n                context            = this,\n                elapsedTime        = (new Date().getTime() - requestStartTime),\n                timeLeft           = (settings.loadingDuration - elapsedTime),\n                translatedResponse = ( $.isFunction(settings.onResponse) )\n                  ? module.is.expectingJSON()\n                    ? settings.onResponse.call(context, $.extend(true, {}, response))\n                    : settings.onResponse.call(context, response)\n                  : false\n              ;\n              timeLeft = (timeLeft > 0)\n                ? timeLeft\n                : 0\n              ;\n              if(translatedResponse) {\n                module.debug('Modified API response in onResponse callback', settings.onResponse, translatedResponse, response);\n                response = translatedResponse;\n              }\n              if(timeLeft > 0) {\n                module.debug('Response completed early delaying state change by', timeLeft);\n              }\n              setTimeout(function() {\n                if( module.is.validResponse(response) ) {\n                  module.request.resolveWith(context, [response, xhr]);\n                }\n                else {\n                  module.request.rejectWith(context, [xhr, 'invalid']);\n                }\n              }, timeLeft);\n            },\n            fail: function(xhr, status, httpMessage) {\n              var\n                context     = this,\n                elapsedTime = (new Date().getTime() - requestStartTime),\n                timeLeft    = (settings.loadingDuration - elapsedTime)\n              ;\n              timeLeft = (timeLeft > 0)\n                ? timeLeft\n                : 0\n              ;\n              if(timeLeft > 0) {\n                module.debug('Response completed early delaying state change by', timeLeft);\n              }\n              setTimeout(function() {\n                if( module.is.abortedRequest(xhr) ) {\n                  module.request.rejectWith(context, [xhr, 'aborted', httpMessage]);\n                }\n                else {\n                  module.request.rejectWith(context, [xhr, 'error', status, httpMessage]);\n                }\n              }, timeLeft);\n            }\n          },\n          request: {\n            done: function(response, xhr) {\n              module.debug('Successful API Response', response);\n              if(settings.cache === 'local' && url) {\n                module.write.cachedResponse(url, response);\n                module.debug('Saving server response locally', module.cache);\n              }\n              settings.onSuccess.call(context, response, $module, xhr);\n            },\n            complete: function(firstParameter, secondParameter) {\n              var\n                xhr,\n                response\n              ;\n              // have to guess callback parameters based on request success\n              if( module.was.succesful() ) {\n                response = firstParameter;\n                xhr      = secondParameter;\n              }\n              else {\n                xhr      = firstParameter;\n                response = module.get.responseFromXHR(xhr);\n              }\n              module.remove.loading();\n              settings.onComplete.call(context, response, $module, xhr);\n            },\n            fail: function(xhr, status, httpMessage) {\n              var\n                // pull response from xhr if available\n                response     = module.get.responseFromXHR(xhr),\n                errorMessage = module.get.errorFromRequest(response, status, httpMessage)\n              ;\n              if(status == 'aborted') {\n                module.debug('XHR Aborted (Most likely caused by page navigation or CORS Policy)', status, httpMessage);\n                settings.onAbort.call(context, status, $module, xhr);\n                return true;\n              }\n              else if(status == 'invalid') {\n                module.debug('JSON did not pass success test. A server-side error has most likely occurred', response);\n              }\n              else if(status == 'error') {\n                if(xhr !== undefined) {\n                  module.debug('XHR produced a server error', status, httpMessage);\n                  // make sure we have an error to display to console\n                  if( xhr.status != 200 && httpMessage !== undefined && httpMessage !== '') {\n                    module.error(error.statusMessage + httpMessage, ajaxSettings.url);\n                  }\n                  settings.onError.call(context, errorMessage, $module, xhr);\n                }\n              }\n\n              if(settings.errorDuration && status !== 'aborted') {\n                module.debug('Adding error state');\n                module.set.error();\n                if( module.should.removeError() ) {\n                  setTimeout(module.remove.error, settings.errorDuration);\n                }\n              }\n              module.debug('API Request failed', errorMessage, xhr);\n              settings.onFailure.call(context, response, $module, xhr);\n            }\n          }\n        },\n\n        create: {\n\n          request: function() {\n            // api request promise\n            return $.Deferred()\n              .always(module.event.request.complete)\n              .done(module.event.request.done)\n              .fail(module.event.request.fail)\n            ;\n          },\n\n          mockedXHR: function () {\n            var\n              // xhr does not simulate these properties of xhr but must return them\n              textStatus     = false,\n              status         = false,\n              httpMessage    = false,\n              responder      = settings.mockResponse      || settings.response,\n              asyncResponder = settings.mockResponseAsync || settings.responseAsync,\n              asyncCallback,\n              response,\n              mockedXHR\n            ;\n\n            mockedXHR = $.Deferred()\n              .always(module.event.xhr.complete)\n              .done(module.event.xhr.done)\n              .fail(module.event.xhr.fail)\n            ;\n\n            if(responder) {\n              if( $.isFunction(responder) ) {\n                module.debug('Using specified synchronous callback', responder);\n                response = responder.call(context, requestSettings);\n              }\n              else {\n                module.debug('Using settings specified response', responder);\n                response = responder;\n              }\n              // simulating response\n              mockedXHR.resolveWith(context, [ response, textStatus, { responseText: response }]);\n            }\n            else if( $.isFunction(asyncResponder) ) {\n              asyncCallback = function(response) {\n                module.debug('Async callback returned response', response);\n\n                if(response) {\n                  mockedXHR.resolveWith(context, [ response, textStatus, { responseText: response }]);\n                }\n                else {\n                  mockedXHR.rejectWith(context, [{ responseText: response }, status, httpMessage]);\n                }\n              };\n              module.debug('Using specified async response callback', asyncResponder);\n              asyncResponder.call(context, requestSettings, asyncCallback);\n            }\n            return mockedXHR;\n          },\n\n          xhr: function() {\n            var\n              xhr\n            ;\n            // ajax request promise\n            xhr = $.ajax(ajaxSettings)\n              .always(module.event.xhr.always)\n              .done(module.event.xhr.done)\n              .fail(module.event.xhr.fail)\n            ;\n            module.verbose('Created server request', xhr, ajaxSettings);\n            return xhr;\n          }\n        },\n\n        set: {\n          error: function() {\n            module.verbose('Adding error state to element', $context);\n            $context.addClass(className.error);\n          },\n          loading: function() {\n            module.verbose('Adding loading state to element', $context);\n            $context.addClass(className.loading);\n            requestStartTime = new Date().getTime();\n          }\n        },\n\n        remove: {\n          error: function() {\n            module.verbose('Removing error state from element', $context);\n            $context.removeClass(className.error);\n          },\n          loading: function() {\n            module.verbose('Removing loading state from element', $context);\n            $context.removeClass(className.loading);\n          }\n        },\n\n        get: {\n          responseFromXHR: function(xhr) {\n            return $.isPlainObject(xhr)\n              ? (module.is.expectingJSON())\n                ? module.decode.json(xhr.responseText)\n                : xhr.responseText\n              : false\n            ;\n          },\n          errorFromRequest: function(response, status, httpMessage) {\n            return ($.isPlainObject(response) && response.error !== undefined)\n              ? response.error // use json error message\n              : (settings.error[status] !== undefined) // use server error message\n                ? settings.error[status]\n                : httpMessage\n            ;\n          },\n          request: function() {\n            return module.request || false;\n          },\n          xhr: function() {\n            return module.xhr || false;\n          },\n          settings: function() {\n            var\n              runSettings\n            ;\n            runSettings = settings.beforeSend.call(context, settings);\n            if(runSettings) {\n              if(runSettings.success !== undefined) {\n                module.debug('Legacy success callback detected', runSettings);\n                module.error(error.legacyParameters, runSettings.success);\n                runSettings.onSuccess = runSettings.success;\n              }\n              if(runSettings.failure !== undefined) {\n                module.debug('Legacy failure callback detected', runSettings);\n                module.error(error.legacyParameters, runSettings.failure);\n                runSettings.onFailure = runSettings.failure;\n              }\n              if(runSettings.complete !== undefined) {\n                module.debug('Legacy complete callback detected', runSettings);\n                module.error(error.legacyParameters, runSettings.complete);\n                runSettings.onComplete = runSettings.complete;\n              }\n            }\n            if(runSettings === undefined) {\n              module.error(error.noReturnedValue);\n            }\n            if(runSettings === false) {\n              return runSettings;\n            }\n            return (runSettings !== undefined)\n              ? $.extend(true, {}, runSettings)\n              : $.extend(true, {}, settings)\n            ;\n          },\n          urlEncodedValue: function(value) {\n            var\n              decodedValue   = window.decodeURIComponent(value),\n              encodedValue   = window.encodeURIComponent(value),\n              alreadyEncoded = (decodedValue !== value)\n            ;\n            if(alreadyEncoded) {\n              module.debug('URL value is already encoded, avoiding double encoding', value);\n              return value;\n            }\n            module.verbose('Encoding value using encodeURIComponent', value, encodedValue);\n            return encodedValue;\n          },\n          defaultData: function() {\n            var\n              data = {}\n            ;\n            if( !$.isWindow(element) ) {\n              if( module.is.input() ) {\n                data.value = $module.val();\n              }\n              else if( module.is.form() ) {\n\n              }\n              else {\n                data.text = $module.text();\n              }\n            }\n            return data;\n          },\n          event: function() {\n            if( $.isWindow(element) || settings.on == 'now' ) {\n              module.debug('API called without element, no events attached');\n              return false;\n            }\n            else if(settings.on == 'auto') {\n              if( $module.is('input') ) {\n                return (element.oninput !== undefined)\n                  ? 'input'\n                  : (element.onpropertychange !== undefined)\n                    ? 'propertychange'\n                    : 'keyup'\n                ;\n              }\n              else if( $module.is('form') ) {\n                return 'submit';\n              }\n              else {\n                return 'click';\n              }\n            }\n            else {\n              return settings.on;\n            }\n          },\n          templatedURL: function(action) {\n            action = action || $module.data(metadata.action) || settings.action || false;\n            url    = $module.data(metadata.url) || settings.url || false;\n            if(url) {\n              module.debug('Using specified url', url);\n              return url;\n            }\n            if(action) {\n              module.debug('Looking up url for action', action, settings.api);\n              if(settings.api[action] === undefined && !module.is.mocked()) {\n                module.error(error.missingAction, settings.action, settings.api);\n                return;\n              }\n              url = settings.api[action];\n            }\n            else if( module.is.form() ) {\n              url = $module.attr('action') || $context.attr('action') || false;\n              module.debug('No url or action specified, defaulting to form action', url);\n            }\n            return url;\n          }\n        },\n\n        abort: function() {\n          var\n            xhr = module.get.xhr()\n          ;\n          if( xhr && xhr.state() !== 'resolved') {\n            module.debug('Cancelling API request');\n            xhr.abort();\n          }\n        },\n\n        // reset state\n        reset: function() {\n          module.remove.error();\n          module.remove.loading();\n        },\n\n        setting: function(name, value) {\n          module.debug('Changing setting', name, value);\n          if( $.isPlainObject(name) ) {\n            $.extend(true, settings, name);\n          }\n          else if(value !== undefined) {\n            if($.isPlainObject(settings[name])) {\n              $.extend(true, settings[name], value);\n            }\n            else {\n              settings[name] = value;\n            }\n          }\n          else {\n            return settings[name];\n          }\n        },\n        internal: function(name, value) {\n          if( $.isPlainObject(name) ) {\n            $.extend(true, module, name);\n          }\n          else if(value !== undefined) {\n            module[name] = value;\n          }\n          else {\n            return module[name];\n          }\n        },\n        debug: function() {\n          if(!settings.silent && settings.debug) {\n            if(settings.performance) {\n              module.performance.log(arguments);\n            }\n            else {\n              module.debug = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.debug.apply(console, arguments);\n            }\n          }\n        },\n        verbose: function() {\n          if(!settings.silent && settings.verbose && settings.debug) {\n            if(settings.performance) {\n              module.performance.log(arguments);\n            }\n            else {\n              module.verbose = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.verbose.apply(console, arguments);\n            }\n          }\n        },\n        error: function() {\n          if(!settings.silent) {\n            module.error = Function.prototype.bind.call(console.error, console, settings.name + ':');\n            module.error.apply(console, arguments);\n          }\n        },\n        performance: {\n          log: function(message) {\n            var\n              currentTime,\n              executionTime,\n              previousTime\n            ;\n            if(settings.performance) {\n              currentTime   = new Date().getTime();\n              previousTime  = time || currentTime;\n              executionTime = currentTime - previousTime;\n              time          = currentTime;\n              performance.push({\n                'Name'           : message[0],\n                'Arguments'      : [].slice.call(message, 1) || '',\n                //'Element'        : element,\n                'Execution Time' : executionTime\n              });\n            }\n            clearTimeout(module.performance.timer);\n            module.performance.timer = setTimeout(module.performance.display, 500);\n          },\n          display: function() {\n            var\n              title = settings.name + ':',\n              totalTime = 0\n            ;\n            time = false;\n            clearTimeout(module.performance.timer);\n            $.each(performance, function(index, data) {\n              totalTime += data['Execution Time'];\n            });\n            title += ' ' + totalTime + 'ms';\n            if(moduleSelector) {\n              title += ' \\'' + moduleSelector + '\\'';\n            }\n            if( (console.group !== undefined || console.table !== undefined) && performance.length > 0) {\n              console.groupCollapsed(title);\n              if(console.table) {\n                console.table(performance);\n              }\n              else {\n                $.each(performance, function(index, data) {\n                  console.log(data['Name'] + ': ' + data['Execution Time']+'ms');\n                });\n              }\n              console.groupEnd();\n            }\n            performance = [];\n          }\n        },\n        invoke: function(query, passedArguments, context) {\n          var\n            object = instance,\n            maxDepth,\n            found,\n            response\n          ;\n          passedArguments = passedArguments || queryArguments;\n          context         = element         || context;\n          if(typeof query == 'string' && object !== undefined) {\n            query    = query.split(/[\\. ]/);\n            maxDepth = query.length - 1;\n            $.each(query, function(depth, value) {\n              var camelCaseValue = (depth != maxDepth)\n                ? value + query[depth + 1].charAt(0).toUpperCase() + query[depth + 1].slice(1)\n                : query\n              ;\n              if( $.isPlainObject( object[camelCaseValue] ) && (depth != maxDepth) ) {\n                object = object[camelCaseValue];\n              }\n              else if( object[camelCaseValue] !== undefined ) {\n                found = object[camelCaseValue];\n                return false;\n              }\n              else if( $.isPlainObject( object[value] ) && (depth != maxDepth) ) {\n                object = object[value];\n              }\n              else if( object[value] !== undefined ) {\n                found = object[value];\n                return false;\n              }\n              else {\n                module.error(error.method, query);\n                return false;\n              }\n            });\n          }\n          if ( $.isFunction( found ) ) {\n            response = found.apply(context, passedArguments);\n          }\n          else if(found !== undefined) {\n            response = found;\n          }\n          if($.isArray(returnedValue)) {\n            returnedValue.push(response);\n          }\n          else if(returnedValue !== undefined) {\n            returnedValue = [returnedValue, response];\n          }\n          else if(response !== undefined) {\n            returnedValue = response;\n          }\n          return found;\n        }\n      };\n\n      if(methodInvoked) {\n        if(instance === undefined) {\n          module.initialize();\n        }\n        module.invoke(query);\n      }\n      else {\n        if(instance !== undefined) {\n          instance.invoke('destroy');\n        }\n        module.initialize();\n      }\n    })\n  ;\n\n  return (returnedValue !== undefined)\n    ? returnedValue\n    : this\n  ;\n};\n\n$.api.settings = {\n\n  name              : 'API',\n  namespace         : 'api',\n\n  debug             : false,\n  verbose           : false,\n  performance       : true,\n\n  // object containing all templates endpoints\n  api               : {},\n\n  // whether to cache responses\n  cache             : true,\n\n  // whether new requests should abort previous requests\n  interruptRequests : true,\n\n  // event binding\n  on                : 'auto',\n\n  // context for applying state classes\n  stateContext      : false,\n\n  // duration for loading state\n  loadingDuration   : 0,\n\n  // whether to hide errors after a period of time\n  hideError         : 'auto',\n\n  // duration for error state\n  errorDuration     : 2000,\n\n  // whether parameters should be encoded with encodeURIComponent\n  encodeParameters  : true,\n\n  // API action to use\n  action            : false,\n\n  // templated URL to use\n  url               : false,\n\n  // base URL to apply to all endpoints\n  base              : '',\n\n  // data that will\n  urlData           : {},\n\n  // whether to add default data to url data\n  defaultData          : true,\n\n  // whether to serialize closest form\n  serializeForm        : false,\n\n  // how long to wait before request should occur\n  throttle             : 0,\n\n  // whether to throttle first request or only repeated\n  throttleFirstRequest : true,\n\n  // standard ajax settings\n  method            : 'get',\n  data              : {},\n  dataType          : 'json',\n\n  // mock response\n  mockResponse      : false,\n  mockResponseAsync : false,\n\n  // aliases for mock\n  response          : false,\n  responseAsync     : false,\n\n  // callbacks before request\n  beforeSend  : function(settings) { return settings; },\n  beforeXHR   : function(xhr) {},\n  onRequest   : function(promise, xhr) {},\n\n  // after request\n  onResponse  : false, // function(response) { },\n\n  // response was successful, if JSON passed validation\n  onSuccess   : function(response, $module) {},\n\n  // request finished without aborting\n  onComplete  : function(response, $module) {},\n\n  // failed JSON success test\n  onFailure   : function(response, $module) {},\n\n  // server error\n  onError     : function(errorMessage, $module) {},\n\n  // request aborted\n  onAbort     : function(errorMessage, $module) {},\n\n  successTest : false,\n\n  // errors\n  error : {\n    beforeSend        : 'The before send function has aborted the request',\n    error             : 'There was an error with your request',\n    exitConditions    : 'API Request Aborted. Exit conditions met',\n    JSONParse         : 'JSON could not be parsed during error handling',\n    legacyParameters  : 'You are using legacy API success callback names',\n    method            : 'The method you called is not defined',\n    missingAction     : 'API action used but no url was defined',\n    missingSerialize  : 'jquery-serialize-object is required to add form data to an existing data object',\n    missingURL        : 'No URL specified for api event',\n    noReturnedValue   : 'The beforeSend callback must return a settings object, beforeSend ignored.',\n    noStorage         : 'Caching responses locally requires session storage',\n    parseError        : 'There was an error parsing your request',\n    requiredParameter : 'Missing a required URL parameter: ',\n    statusMessage     : 'Server gave an error: ',\n    timeout           : 'Your request timed out'\n  },\n\n  regExp  : {\n    required : /\\{\\$*[A-z0-9]+\\}/g,\n    optional : /\\{\\/\\$*[A-z0-9]+\\}/g,\n  },\n\n  className: {\n    loading : 'loading',\n    error   : 'error'\n  },\n\n  selector: {\n    disabled : '.disabled',\n    form      : 'form'\n  },\n\n  metadata: {\n    action  : 'action',\n    url     : 'url'\n  }\n};\n\n\n\n})( jQuery, window, document );\n"]},"sourceType":"script","hash":"9f7048902587c6036cc2ba7d92988fa900ceafd8"}
